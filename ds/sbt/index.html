<!DOCTYPE html><html lang="zh" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="OI Wiki 是一个编程竞赛知识整合站点，提供有趣又实用的编程竞赛知识以及其他有帮助的内容，帮助广大编程竞赛爱好者更快更深入地学习编程竞赛"><meta name="author" content="OI Wiki Team"><link href="https://dup4.com/oi-wiki-mirror/ds/sbt/" rel="canonical"><link rel="icon" href="../../favicon.ico"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.2.16"><title>Size Balanced Tree - OI Wiki</title><link rel="stylesheet" href="../../assets/stylesheets/main.1c3799f8.min.css"><link rel="stylesheet" href="../../assets/stylesheets/palette.cc9b2e1e.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../../assets/stylesheets/extra.9add2662.min.css"><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><style id="MJX-SVG-styles">
.mathjax-render-error-message {
  display: inline-block;
  border: 2px solid #000;
  padding: 8px;
  font-weight: bold;
  text-align: left;
}

mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

</style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="deep-purple"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#节点定义" class="md-skip"> 跳转至 </a> </div> <div data-md-component="announce"> </div> <header class="md-header" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="页眉"> <a href="../.." title="OI Wiki" class="md-header__button md-logo" aria-label="OI Wiki" data-md-component="logo"> <img src="../../favicon.ico" alt="logo"> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> OI Wiki </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Size Balanced Tree </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="deep-purple" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden=""> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"></path></svg> </label> <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dracula" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_2"> <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden=""> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"></path></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required=""> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav class="md-search__options" aria-label="查找"> <a href="javascript:void(0)" class="md-search__icon md-icon" aria-label="分享" data-clipboard="" data-clipboard-text="" data-md-component="search-share" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> 正在初始化搜索引擎 </div> <ol class="md-search-result__list"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/Dup4/oi-wiki-mirror" title="前往仓库" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </div> <div class="md-source__repository"> Dup4/oi-wiki-mirror </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <nav class="md-tabs" aria-label="标签" data-md-component="tabs"> <div class="md-tabs__inner md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a href="../.." class="md-tabs__link"> 简介 </a> </li> <li class="md-tabs__item"> <a href="../../contest/" class="md-tabs__link"> 比赛相关 </a> </li> <li class="md-tabs__item"> <a href="../../tools/" class="md-tabs__link"> 工具软件 </a> </li> <li class="md-tabs__item"> <a href="../../lang/" class="md-tabs__link"> 语言基础 </a> </li> <li class="md-tabs__item"> <a href="../../basic/" class="md-tabs__link"> 算法基础 </a> </li> <li class="md-tabs__item"> <a href="../../search/" class="md-tabs__link"> 搜索 </a> </li> <li class="md-tabs__item"> <a href="../../dp/" class="md-tabs__link"> 动态规划 </a> </li> <li class="md-tabs__item"> <a href="../../string/" class="md-tabs__link"> 字符串 </a> </li> <li class="md-tabs__item"> <a href="../../math/" class="md-tabs__link"> 数学 </a> </li> <li class="md-tabs__item"> <a href="../" class="md-tabs__link md-tabs__link--active"> 数据结构 </a> </li> <li class="md-tabs__item"> <a href="../../graph/" class="md-tabs__link"> 图论 </a> </li> <li class="md-tabs__item"> <a href="../../geometry/" class="md-tabs__link"> 计算几何 </a> </li> <li class="md-tabs__item"> <a href="../../misc/" class="md-tabs__link"> 杂项 </a> </li> <li class="md-tabs__item"> <a href="../../topic/rmq/" class="md-tabs__link"> 专题 </a> </li> </ul> </div> </nav> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="导航栏" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../.." title="OI Wiki" class="md-nav__button md-logo" aria-label="OI Wiki" data-md-component="logo"> <img src="../../favicon.ico" alt="logo"> </a> OI Wiki </label> <div class="md-nav__source"> <a href="https://github.com/Dup4/oi-wiki-mirror" title="前往仓库" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </div> <div class="md-source__repository"> Dup4/oi-wiki-mirror </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1"> <label class="md-nav__link" for="__nav_1"> 简介 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="简介" data-md-level="1"> <label class="md-nav__title" for="__nav_1"> <span class="md-nav__icon md-icon"></span> 简介 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../.." class="md-nav__link"> Getting Started </a> </li> <li class="md-nav__item"> <a href="../../intro/about/" class="md-nav__link"> 关于本项目 </a> </li> <li class="md-nav__item"> <a href="../../intro/htc/" class="md-nav__link"> 如何参与 </a> </li> <li class="md-nav__item"> <a href="../../intro/what-oi-wiki-is-not/" class="md-nav__link"> OI Wiki 不是什么 </a> </li> <li class="md-nav__item"> <a href="../../intro/format/" class="md-nav__link"> 格式手册 </a> </li> <li class="md-nav__item"> <a href="../../intro/symbol/" class="md-nav__link"> 数学符号表 </a> </li> <li class="md-nav__item"> <a href="../../intro/faq/" class="md-nav__link"> F.A.Q. </a> </li> <li class="md-nav__item"> <a href="../../intro/mirrors/" class="md-nav__link"> 镜像站列表 </a> </li> <li class="md-nav__item"> <a href="../../intro/thanks/" class="md-nav__link"> 致谢 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2"> <label class="md-nav__link" for="__nav_2"> 比赛相关 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="比赛相关" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> 比赛相关 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../contest/" class="md-nav__link"> 比赛相关简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2"> <label class="md-nav__link" for="__nav_2_2"> 赛事 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="赛事" data-md-level="2"> <label class="md-nav__title" for="__nav_2_2"> <span class="md-nav__icon md-icon"></span> 赛事 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../contest/oi/" class="md-nav__link"> OI 赛事与赛制 </a> </li> <li class="md-nav__item"> <a href="../../contest/icpc/" class="md-nav__link"> ICPC/CCPC 赛事与赛制 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3"> <label class="md-nav__link" for="__nav_2_3"> 题型 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="题型" data-md-level="2"> <label class="md-nav__title" for="__nav_2_3"> <span class="md-nav__icon md-icon"></span> 题型 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../contest/problems/" class="md-nav__link"> 题型概述 </a> </li> <li class="md-nav__item"> <a href="../../contest/interaction/" class="md-nav__link"> 交互题 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../contest/roadmap/" class="md-nav__link"> 学习路线 </a> </li> <li class="md-nav__item"> <a href="../../contest/resources/" class="md-nav__link"> 学习资源 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" type="checkbox" id="__nav_2_6"> <label class="md-nav__link" for="__nav_2_6"> 技巧 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="技巧" data-md-level="2"> <label class="md-nav__title" for="__nav_2_6"> <span class="md-nav__icon md-icon"></span> 技巧 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../contest/io/" class="md-nav__link"> 读入、输出优化 </a> </li> <li class="md-nav__item"> <a href="../../contest/dictionary/" class="md-nav__link"> 分段打表 </a> </li> <li class="md-nav__item"> <a href="../../contest/common-mistakes/" class="md-nav__link"> 常见错误 </a> </li> <li class="md-nav__item"> <a href="../../contest/common-tricks/" class="md-nav__link"> 常见技巧 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../contest/problemsetting/" class="md-nav__link"> 出题 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3"> <label class="md-nav__link" for="__nav_3"> 工具软件 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="工具软件" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> 工具软件 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../tools/" class="md-nav__link"> 工具软件简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2"> <label class="md-nav__link" for="__nav_3_2"> 代码编辑工具 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="代码编辑工具" data-md-level="2"> <label class="md-nav__title" for="__nav_3_2"> <span class="md-nav__icon md-icon"></span> 代码编辑工具 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../tools/editor/vim/" class="md-nav__link"> Vim </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/emacs/" class="md-nav__link"> Emacs </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/vscode/" class="md-nav__link"> VS Code </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/atom/" class="md-nav__link"> Atom </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/eclipse/" class="md-nav__link"> Eclipse </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/npp/" class="md-nav__link"> Notepad++ </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/kate/" class="md-nav__link"> Kate </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/devcpp/" class="md-nav__link"> Dev-C++ </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/clion/" class="md-nav__link"> CLion </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/geany/" class="md-nav__link"> Geany </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/xcode/" class="md-nav__link"> Xcode </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/guide/" class="md-nav__link"> GUIDE </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/sublime/" class="md-nav__link"> Sublime Text </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/cpeditor/" class="md-nav__link"> CP Editor </a> </li> <li class="md-nav__item"> <a href="../../tools/editor/codeblocks/" class="md-nav__link"> Code::Blocks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3"> <label class="md-nav__link" for="__nav_3_3"> 评测工具 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="评测工具" data-md-level="2"> <label class="md-nav__title" for="__nav_3_3"> <span class="md-nav__icon md-icon"></span> 评测工具 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../tools/judger/" class="md-nav__link"> 评测工具简介 </a> </li> <li class="md-nav__item"> <a href="../../tools/judger/arbiter/" class="md-nav__link"> Arbiter </a> </li> <li class="md-nav__item"> <a href="../../tools/judger/cena/" class="md-nav__link"> Cena </a> </li> <li class="md-nav__item"> <a href="../../tools/judger/ccr-plus/" class="md-nav__link"> CCR Plus </a> </li> <li class="md-nav__item"> <a href="../../tools/judger/lemon/" class="md-nav__link"> Lemon </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../tools/cmd/" class="md-nav__link"> 命令行 </a> </li> <li class="md-nav__item"> <a href="../../tools/compiler/" class="md-nav__link"> 编译器 </a> </li> <li class="md-nav__item"> <a href="../../tools/wsl/" class="md-nav__link"> WSL (Windows 10) </a> </li> <li class="md-nav__item"> <a href="../../tools/special-judge/" class="md-nav__link"> Special Judge </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_8" type="checkbox" id="__nav_3_8"> <label class="md-nav__link" for="__nav_3_8"> Testlib <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="Testlib" data-md-level="2"> <label class="md-nav__title" for="__nav_3_8"> <span class="md-nav__icon md-icon"></span> Testlib </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../tools/testlib/" class="md-nav__link"> Testlib 简介 </a> </li> <li class="md-nav__item"> <a href="../../tools/testlib/general/" class="md-nav__link"> 通用 </a> </li> <li class="md-nav__item"> <a href="../../tools/testlib/generator/" class="md-nav__link"> Generator </a> </li> <li class="md-nav__item"> <a href="../../tools/testlib/validator/" class="md-nav__link"> Validator </a> </li> <li class="md-nav__item"> <a href="../../tools/testlib/interactor/" class="md-nav__link"> Interactor </a> </li> <li class="md-nav__item"> <a href="../../tools/testlib/checker/" class="md-nav__link"> Checker </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../tools/polygon/" class="md-nav__link"> Polygon </a> </li> <li class="md-nav__item"> <a href="../../tools/oj-tool/" class="md-nav__link"> OJ 工具 </a> </li> <li class="md-nav__item"> <a href="../../tools/latex/" class="md-nav__link"> LaTeX 入门 </a> </li> <li class="md-nav__item"> <a href="../../tools/git/" class="md-nav__link"> Git </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4"> <label class="md-nav__link" for="__nav_4"> 语言基础 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="语言基础" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> 语言基础 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/" class="md-nav__link"> 语言基础简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2"> <label class="md-nav__link" for="__nav_4_2"> C++ 基础 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="C++ 基础" data-md-level="2"> <label class="md-nav__title" for="__nav_4_2"> <span class="md-nav__icon md-icon"></span> C++ 基础 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/helloworld/" class="md-nav__link"> Hello, World! </a> </li> <li class="md-nav__item"> <a href="../../lang/basic/" class="md-nav__link"> C++ 语法基础 </a> </li> <li class="md-nav__item"> <a href="../../lang/var/" class="md-nav__link"> 变量 </a> </li> <li class="md-nav__item"> <a href="../../lang/op/" class="md-nav__link"> 运算 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_5" type="checkbox" id="__nav_4_2_5"> <label class="md-nav__link" for="__nav_4_2_5"> 流程控制语句 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="流程控制语句" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_5"> <span class="md-nav__icon md-icon"></span> 流程控制语句 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/branch/" class="md-nav__link"> 分支 </a> </li> <li class="md-nav__item"> <a href="../../lang/loop/" class="md-nav__link"> 循环 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2_6" type="checkbox" id="__nav_4_2_6"> <label class="md-nav__link" for="__nav_4_2_6"> 高级数据类型 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="高级数据类型" data-md-level="3"> <label class="md-nav__title" for="__nav_4_2_6"> <span class="md-nav__icon md-icon"></span> 高级数据类型 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/array/" class="md-nav__link"> 数组 </a> </li> <li class="md-nav__item"> <a href="../../lang/struct/" class="md-nav__link"> 结构体 </a> </li> <li class="md-nav__item"> <a href="../../lang/union/" class="md-nav__link"> 联合体 </a> </li> <li class="md-nav__item"> <a href="../../lang/pointer/" class="md-nav__link"> 指针 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../lang/func/" class="md-nav__link"> 函数 </a> </li> <li class="md-nav__item"> <a href="../../lang/file-op/" class="md-nav__link"> 文件操作 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3"> <label class="md-nav__link" for="__nav_4_3"> C++ 标准库 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="C++ 标准库" data-md-level="2"> <label class="md-nav__title" for="__nav_4_3"> <span class="md-nav__icon md-icon"></span> C++ 标准库 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/csl/" class="md-nav__link"> C++ 标准库简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_2" type="checkbox" id="__nav_4_3_2"> <label class="md-nav__link" for="__nav_4_3_2"> STL 容器 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="STL 容器" data-md-level="3"> <label class="md-nav__title" for="__nav_4_3_2"> <span class="md-nav__icon md-icon"></span> STL 容器 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/csl/container/" class="md-nav__link"> STL 容器简介 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/iterator/" class="md-nav__link"> 迭代器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/sequence-container/" class="md-nav__link"> 序列式容器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/associative-container/" class="md-nav__link"> 关联式容器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/unordered-container/" class="md-nav__link"> 无序关联式容器 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/container-adapter/" class="md-nav__link"> 容器适配器 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../lang/csl/algorithm/" class="md-nav__link"> STL 算法 </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/bitset/" class="md-nav__link"> bitset </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/string/" class="md-nav__link"> string </a> </li> <li class="md-nav__item"> <a href="../../lang/csl/pair/" class="md-nav__link"> pair </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4"> <label class="md-nav__link" for="__nav_4_4"> C++ 进阶 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="C++ 进阶" data-md-level="2"> <label class="md-nav__title" for="__nav_4_4"> <span class="md-nav__icon md-icon"></span> C++ 进阶 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/class/" class="md-nav__link"> 类 </a> </li> <li class="md-nav__item"> <a href="../../lang/namespace/" class="md-nav__link"> 命名空间 </a> </li> <li class="md-nav__item"> <a href="../../lang/value-category/" class="md-nav__link"> 值类别 </a> </li> <li class="md-nav__item"> <a href="../../lang/op-overload/" class="md-nav__link"> 重载运算符 </a> </li> <li class="md-nav__item"> <a href="../../lang/reference/" class="md-nav__link"> 引用 </a> </li> <li class="md-nav__item"> <a href="../../lang/const/" class="md-nav__link"> 常量 </a> </li> <li class="md-nav__item"> <a href="../../lang/new/" class="md-nav__link"> 新版 C++ 特性 </a> </li> <li class="md-nav__item"> <a href="../../lang/lambda/" class="md-nav__link"> Lambda 表达式 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4_9" type="checkbox" id="__nav_4_4_9"> <label class="md-nav__link" for="__nav_4_4_9"> pb_ds <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="pb_ds" data-md-level="3"> <label class="md-nav__title" for="__nav_4_4_9"> <span class="md-nav__icon md-icon"></span> pb_ds </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../lang/pb-ds/" class="md-nav__link"> pb_ds 简介 </a> </li> <li class="md-nav__item"> <a href="../../lang/pb-ds/pq/" class="md-nav__link"> 堆 </a> </li> <li class="md-nav__item"> <a href="../../lang/pb-ds/tree/" class="md-nav__link"> 平衡树 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../lang/optimizations/" class="md-nav__link"> 编译优化 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../lang/cpp-other-langs/" class="md-nav__link"> C++ 与其他常用语言的区别 </a> </li> <li class="md-nav__item"> <a href="../../lang/pas-cpp/" class="md-nav__link"> Pascal 转 C++ 急救 </a> </li> <li class="md-nav__item"> <a href="../../lang/python/" class="md-nav__link"> Python 速成 </a> </li> <li class="md-nav__item"> <a href="../../lang/java/" class="md-nav__link"> Java 速成 </a> </li> <li class="md-nav__item"> <a href="../../lang/java-pro/" class="md-nav__link"> Java 进阶 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5"> <label class="md-nav__link" for="__nav_5"> 算法基础 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="算法基础" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> 算法基础 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../basic/" class="md-nav__link"> 算法基础简介 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2"> <label class="md-nav__link" for="__nav_5_2"> 复杂度 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="复杂度" data-md-level="2"> <label class="md-nav__title" for="__nav_5_2"> <span class="md-nav__icon md-icon"></span> 复杂度 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../basic/complexity/" class="md-nav__link"> 复杂度简介 </a> </li> <li class="md-nav__item"> <a href="../../basic/amortized-analysis/" class="md-nav__link"> 均摊复杂度 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../basic/enumerate/" class="md-nav__link"> 枚举 </a> </li> <li class="md-nav__item"> <a href="../../basic/simulate/" class="md-nav__link"> 模拟 </a> </li> <li class="md-nav__item"> <a href="../../basic/divide-and-conquer/" class="md-nav__link"> 递归 &amp; 分治 </a> </li> <li class="md-nav__item"> <a href="../../basic/greedy/" class="md-nav__link"> 贪心 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_7" type="checkbox" id="__nav_5_7"> <label class="md-nav__link" for="__nav_5_7"> 排序 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="排序" data-md-level="2"> <label class="md-nav__title" for="__nav_5_7"> <span class="md-nav__icon md-icon"></span> 排序 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../basic/sort-intro/" class="md-nav__link"> 排序简介 </a> </li> <li class="md-nav__item"> <a href="../../basic/selection-sort/" class="md-nav__link"> 选择排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/bubble-sort/" class="md-nav__link"> 冒泡排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/insertion-sort/" class="md-nav__link"> 插入排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/counting-sort/" class="md-nav__link"> 计数排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/radix-sort/" class="md-nav__link"> 基数排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/quick-sort/" class="md-nav__link"> 快速排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/merge-sort/" class="md-nav__link"> 归并排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/heap-sort/" class="md-nav__link"> 堆排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/bucket-sort/" class="md-nav__link"> 桶排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/shell-sort/" class="md-nav__link"> 希尔排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/tournament-sort/" class="md-nav__link"> 锦标赛排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/tim-sort/" class="md-nav__link"> Tim 排序 </a> </li> <li class="md-nav__item"> <a href="../../basic/stl-sort/" class="md-nav__link"> 排序相关 STL </a> </li> <li class="md-nav__item"> <a href="../../basic/use-of-sort/" class="md-nav__link"> 排序应用 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../basic/prefix-sum/" class="md-nav__link"> 前缀和 &amp; 差分 </a> </li> <li class="md-nav__item"> <a href="../../basic/binary/" class="md-nav__link"> 二分 </a> </li> <li class="md-nav__item"> <a href="../../basic/binary-lifting/" class="md-nav__link"> 倍增 </a> </li> <li class="md-nav__item"> <a href="../../basic/construction/" class="md-nav__link"> 构造 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6"> <label class="md-nav__link" for="__nav_6"> 搜索 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="搜索" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> 搜索 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../search/" class="md-nav__link"> 搜索部分简介 </a> </li> <li class="md-nav__item"> <a href="../../search/dfs/" class="md-nav__link"> DFS（搜索） </a> </li> <li class="md-nav__item"> <a href="../../search/bfs/" class="md-nav__link"> BFS（搜索） </a> </li> <li class="md-nav__item"> <a href="../../search/bidirectional/" class="md-nav__link"> 双向搜索 </a> </li> <li class="md-nav__item"> <a href="../../search/heuristic/" class="md-nav__link"> 启发式搜索 </a> </li> <li class="md-nav__item"> <a href="../../search/astar/" class="md-nav__link"> A* </a> </li> <li class="md-nav__item"> <a href="../../search/iterative/" class="md-nav__link"> 迭代加深搜索 </a> </li> <li class="md-nav__item"> <a href="../../search/idastar/" class="md-nav__link"> IDA* </a> </li> <li class="md-nav__item"> <a href="../../search/backtracking/" class="md-nav__link"> 回溯法 </a> </li> <li class="md-nav__item"> <a href="../../search/dlx/" class="md-nav__link"> Dancing Links </a> </li> <li class="md-nav__item"> <a href="../../search/alpha-beta/" class="md-nav__link"> Alpha-Beta 剪枝 </a> </li> <li class="md-nav__item"> <a href="../../search/opt/" class="md-nav__link"> 优化 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7"> <label class="md-nav__link" for="__nav_7"> 动态规划 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="动态规划" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> 动态规划 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../dp/" class="md-nav__link"> 动态规划部分简介 </a> </li> <li class="md-nav__item"> <a href="../../dp/basic/" class="md-nav__link"> 动态规划基础 </a> </li> <li class="md-nav__item"> <a href="../../dp/memo/" class="md-nav__link"> 记忆化搜索 </a> </li> <li class="md-nav__item"> <a href="../../dp/knapsack/" class="md-nav__link"> 背包 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/interval/" class="md-nav__link"> 区间 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/dag/" class="md-nav__link"> DAG 上的 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/tree/" class="md-nav__link"> 树形 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/state/" class="md-nav__link"> 状压 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/number/" class="md-nav__link"> 数位 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/plug/" class="md-nav__link"> 插头 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/count/" class="md-nav__link"> 计数 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/dynamic/" class="md-nav__link"> 动态 DP </a> </li> <li class="md-nav__item"> <a href="../../dp/probability/" class="md-nav__link"> 概率 DP </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_14" type="checkbox" id="__nav_7_14"> <label class="md-nav__link" for="__nav_7_14"> DP 优化 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="DP 优化" data-md-level="2"> <label class="md-nav__title" for="__nav_7_14"> <span class="md-nav__icon md-icon"></span> DP 优化 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../dp/opt/monotonous-queue-stack/" class="md-nav__link"> 单调队列/单调栈优化 </a> </li> <li class="md-nav__item"> <a href="../../dp/opt/slope/" class="md-nav__link"> 斜率优化 </a> </li> <li class="md-nav__item"> <a href="../../dp/opt/quadrangle/" class="md-nav__link"> 四边形不等式优化 </a> </li> <li class="md-nav__item"> <a href="../../dp/opt/state/" class="md-nav__link"> 状态设计优化 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../dp/misc/" class="md-nav__link"> 其它 DP 方法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8"> <label class="md-nav__link" for="__nav_8"> 字符串 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="字符串" data-md-level="1"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> 字符串 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../string/" class="md-nav__link"> 字符串部分简介 </a> </li> <li class="md-nav__item"> <a href="../../string/basic/" class="md-nav__link"> 字符串基础 </a> </li> <li class="md-nav__item"> <a href="../../string/lib-func/" class="md-nav__link"> 标准库 </a> </li> <li class="md-nav__item"> <a href="../../string/match/" class="md-nav__link"> 字符串匹配 </a> </li> <li class="md-nav__item"> <a href="../../string/hash/" class="md-nav__link"> 字符串哈希 </a> </li> <li class="md-nav__item"> <a href="../../string/trie/" class="md-nav__link"> 字典树 (Trie) </a> </li> <li class="md-nav__item"> <a href="../../string/kmp/" class="md-nav__link"> 前缀函数与 KMP 算法 </a> </li> <li class="md-nav__item"> <a href="../../string/bm/" class="md-nav__link"> Boyer–Moore 算法 </a> </li> <li class="md-nav__item"> <a href="../../string/z-func/" class="md-nav__link"> Z 函数（扩展 KMP） </a> </li> <li class="md-nav__item"> <a href="../../string/automaton/" class="md-nav__link"> 自动机 </a> </li> <li class="md-nav__item"> <a href="../../string/ac-automaton/" class="md-nav__link"> AC 自动机 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_12" type="checkbox" id="__nav_8_12"> <label class="md-nav__link" for="__nav_8_12"> 后缀数组 (SA) <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="后缀数组 (SA)" data-md-level="2"> <label class="md-nav__title" for="__nav_8_12"> <span class="md-nav__icon md-icon"></span> 后缀数组 (SA) </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../string/sa/" class="md-nav__link"> 后缀数组简介 </a> </li> <li class="md-nav__item"> <a href="../../string/sa-optimal-inplace/" class="md-nav__link"> 最优原地后缀排序算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../string/sam/" class="md-nav__link"> 后缀自动机 (SAM) </a> </li> <li class="md-nav__item"> <a href="../../string/suffix-bst/" class="md-nav__link"> 后缀平衡树 </a> </li> <li class="md-nav__item"> <a href="../../string/general-sam/" class="md-nav__link"> 广义后缀自动机 </a> </li> <li class="md-nav__item"> <a href="../../string/suffix-tree/" class="md-nav__link"> 后缀树 </a> </li> <li class="md-nav__item"> <a href="../../string/manacher/" class="md-nav__link"> Manacher </a> </li> <li class="md-nav__item"> <a href="../../string/pam/" class="md-nav__link"> 回文树 </a> </li> <li class="md-nav__item"> <a href="../../string/seq-automaton/" class="md-nav__link"> 序列自动机 </a> </li> <li class="md-nav__item"> <a href="../../string/minimal-string/" class="md-nav__link"> 最小表示法 </a> </li> <li class="md-nav__item"> <a href="../../string/lyndon/" class="md-nav__link"> Lyndon 分解 </a> </li> <li class="md-nav__item"> <a href="../../string/main-lorentz/" class="md-nav__link"> Main–Lorentz 算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9"> <label class="md-nav__link" for="__nav_9"> 数学 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="数学" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> 数学 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/" class="md-nav__link"> 数学部分简介 </a> </li> <li class="md-nav__item"> <a href="../../math/notation/" class="md-nav__link"> 符号 </a> </li> <li class="md-nav__item"> <a href="../../math/base/" class="md-nav__link"> 进位制 </a> </li> <li class="md-nav__item"> <a href="../../math/bit/" class="md-nav__link"> 位运算 </a> </li> <li class="md-nav__item"> <a href="../../math/binary-set/" class="md-nav__link"> 二进制集合操作 </a> </li> <li class="md-nav__item"> <a href="../../math/balanced-ternary/" class="md-nav__link"> 平衡三进制 </a> </li> <li class="md-nav__item"> <a href="../../math/bignum/" class="md-nav__link"> 高精度计算 </a> </li> <li class="md-nav__item"> <a href="../../math/binary-exponentiation/" class="md-nav__link"> 快速幂 </a> </li> <li class="md-nav__item"> <a href="../../math/permutation/" class="md-nav__link"> 置换和排列 </a> </li> <li class="md-nav__item"> <a href="../../math/coordinate/" class="md-nav__link"> 弧度制与坐标系 </a> </li> <li class="md-nav__item"> <a href="../../math/complex/" class="md-nav__link"> 复数 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_12" type="checkbox" id="__nav_9_12"> <label class="md-nav__link" for="__nav_9_12"> 数论 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="数论" data-md-level="2"> <label class="md-nav__title" for="__nav_9_12"> <span class="md-nav__icon md-icon"></span> 数论 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/number-theory/basic/" class="md-nav__link"> 数论基础 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/prime/" class="md-nav__link"> 素数 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/gcd/" class="md-nav__link"> 最大公约数 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/sqrt-decomposition/" class="md-nav__link"> 数论分块 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/euler-totient/" class="md-nav__link"> 欧拉函数 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/sieve/" class="md-nav__link"> 筛法 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/meissel-lehmer/" class="md-nav__link"> Meissel–Lehmer 算法 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/pollard-rho/" class="md-nav__link"> 分解质因数 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/bezouts/" class="md-nav__link"> 裴蜀定理 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/euclidean/" class="md-nav__link"> 类欧几里德算法 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/fermat/" class="md-nav__link"> 欧拉定理 &amp; 费马小定理 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/inverse/" class="md-nav__link"> 乘法逆元 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/linear-equation/" class="md-nav__link"> 线性同余方程 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/crt/" class="md-nav__link"> 中国剩余定理 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/lift-the-exponent/" class="md-nav__link"> 升幂引理 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/factorial/" class="md-nav__link"> 阶乘取模 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/lucas/" class="md-nav__link"> 卢卡斯定理 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/congruence-equation/" class="md-nav__link"> 同余方程 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/quad-residue/" class="md-nav__link"> 二次剩余 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/primitive-root/" class="md-nav__link"> 原根 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/discrete-logarithm/" class="md-nav__link"> 离散对数 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/residue/" class="md-nav__link"> 剩余 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/mobius/" class="md-nav__link"> 莫比乌斯反演 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/du/" class="md-nav__link"> 杜教筛 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/powerful-number/" class="md-nav__link"> Powerful Number 筛 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/min-25/" class="md-nav__link"> Min_25 筛 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/zhou/" class="md-nav__link"> 洲阁筛 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/continued-fraction/" class="md-nav__link"> 连分数 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/stern-brocot/" class="md-nav__link"> Stern–Brocot 树与 Farey 序列 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/quadratic/" class="md-nav__link"> 二次域 </a> </li> <li class="md-nav__item"> <a href="../../math/number-theory/pell-equation/" class="md-nav__link"> Pell 方程 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_13" type="checkbox" id="__nav_9_13"> <label class="md-nav__link" for="__nav_9_13"> 多项式与生成函数 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="多项式与生成函数" data-md-level="2"> <label class="md-nav__title" for="__nav_9_13"> <span class="md-nav__icon md-icon"></span> 多项式与生成函数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/poly/intro/" class="md-nav__link"> 多项式与生成函数简介 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/fundamental/" class="md-nav__link"> 代数基本定理 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/fft/" class="md-nav__link"> 快速傅里叶变换 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/ntt/" class="md-nav__link"> 快速数论变换 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/fwt/" class="md-nav__link"> 快速沃尔什变换 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/czt/" class="md-nav__link"> Chirp Z 变换 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/newton/" class="md-nav__link"> 多项式牛顿迭代 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/multipoint-eval-interpolation/" class="md-nav__link"> 多项式多点求值|快速插值 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/elementary-func/" class="md-nav__link"> 多项式初等函数 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/linear-recurrence/" class="md-nav__link"> 常系数齐次线性递推 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/shift/" class="md-nav__link"> 多项式平移|连续点值平移 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/symbolic-method/" class="md-nav__link"> 符号化方法 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/lagrange-inversion/" class="md-nav__link"> Lagrange 反演 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/comp-rev/" class="md-nav__link"> 形式幂级数复合|复合逆 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/ogf/" class="md-nav__link"> 普通生成函数 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/egf/" class="md-nav__link"> 指数生成函数 </a> </li> <li class="md-nav__item"> <a href="../../math/poly/dgf/" class="md-nav__link"> 狄利克雷生成函数 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_14" type="checkbox" id="__nav_9_14"> <label class="md-nav__link" for="__nav_9_14"> 组合数学 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="组合数学" data-md-level="2"> <label class="md-nav__title" for="__nav_9_14"> <span class="md-nav__icon md-icon"></span> 组合数学 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/combinatorics/combination/" class="md-nav__link"> 排列组合 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/drawer-principle/" class="md-nav__link"> 抽屉原理 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/inclusion-exclusion-principle/" class="md-nav__link"> 容斥原理 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/fibonacci/" class="md-nav__link"> 斐波那契数列 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/derangement/" class="md-nav__link"> 错位排列 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/catalan/" class="md-nav__link"> 卡特兰数 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/stirling/" class="md-nav__link"> 斯特林数 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/bell/" class="md-nav__link"> 贝尔数 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/bernoulli/" class="md-nav__link"> 伯努利数 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/entringer/" class="md-nav__link"> Entringer Number </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/eulerian/" class="md-nav__link"> Eulerian Number </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/partition/" class="md-nav__link"> 分拆数 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/vandermonde-convolution/" class="md-nav__link"> 范德蒙德卷积 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/polya/" class="md-nav__link"> Pólya 计数 </a> </li> <li class="md-nav__item"> <a href="../../math/combinatorics/graph-enumeration/" class="md-nav__link"> 图论计数 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_15" type="checkbox" id="__nav_9_15"> <label class="md-nav__link" for="__nav_9_15"> 线性代数 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="线性代数" data-md-level="2"> <label class="md-nav__title" for="__nav_9_15"> <span class="md-nav__icon md-icon"></span> 线性代数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/linear-algebra/" class="md-nav__link"> 线性代数简介 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/vector/" class="md-nav__link"> 向量 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/product/" class="md-nav__link"> 内积和外积 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/matrix/" class="md-nav__link"> 矩阵 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/elementary-operations/" class="md-nav__link"> 初等变换 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/determinant/" class="md-nav__link"> 行列式 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/vector-space/" class="md-nav__link"> 线性空间 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/basis/" class="md-nav__link"> 线性基 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/linear-mapping/" class="md-nav__link"> 线性映射 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/char-poly/" class="md-nav__link"> 特征多项式 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/diagonalization/" class="md-nav__link"> 对角化 </a> </li> <li class="md-nav__item"> <a href="../../math/linear-algebra/jordan/" class="md-nav__link"> Jordan标准型 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_16" type="checkbox" id="__nav_9_16"> <label class="md-nav__link" for="__nav_9_16"> 线性规划 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="线性规划" data-md-level="2"> <label class="md-nav__title" for="__nav_9_16"> <span class="md-nav__icon md-icon"></span> 线性规划 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/linear-programming/" class="md-nav__link"> 线性规划简介 </a> </li> <li class="md-nav__item"> <a href="../../math/simplex/" class="md-nav__link"> 单纯形算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_17" type="checkbox" id="__nav_9_17"> <label class="md-nav__link" for="__nav_9_17"> 抽象代数 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="抽象代数" data-md-level="2"> <label class="md-nav__title" for="__nav_9_17"> <span class="md-nav__icon md-icon"></span> 抽象代数 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/algebra/basic/" class="md-nav__link"> 基本概念 </a> </li> <li class="md-nav__item"> <a href="../../math/algebra/group-theory/" class="md-nav__link"> 群论 </a> </li> <li class="md-nav__item"> <a href="../../math/algebra/ring-theory/" class="md-nav__link"> 环论 </a> </li> <li class="md-nav__item"> <a href="../../math/algebra/field-theory/" class="md-nav__link"> 域论 </a> </li> <li class="md-nav__item"> <a href="../../math/algebra/schreier-sims/" class="md-nav__link"> Schreier–Sims 算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_18" type="checkbox" id="__nav_9_18"> <label class="md-nav__link" for="__nav_9_18"> 概率论 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="概率论" data-md-level="2"> <label class="md-nav__title" for="__nav_9_18"> <span class="md-nav__icon md-icon"></span> 概率论 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/probability/basic-conception/" class="md-nav__link"> 基本概念 </a> </li> <li class="md-nav__item"> <a href="../../math/probability/conditional-probability/" class="md-nav__link"> 条件概率与独立性 </a> </li> <li class="md-nav__item"> <a href="../../math/probability/random-variable/" class="md-nav__link"> 随机变量 </a> </li> <li class="md-nav__item"> <a href="../../math/probability/exp-var/" class="md-nav__link"> 随机变量的数字特征 </a> </li> <li class="md-nav__item"> <a href="../../math/probability/concentration-inequality/" class="md-nav__link"> 概率不等式 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_19" type="checkbox" id="__nav_9_19"> <label class="md-nav__link" for="__nav_9_19"> 博弈论 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="博弈论" data-md-level="2"> <label class="md-nav__title" for="__nav_9_19"> <span class="md-nav__icon md-icon"></span> 博弈论 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/game-theory/intro/" class="md-nav__link"> 博弈论简介 </a> </li> <li class="md-nav__item"> <a href="../../math/game-theory/impartial-game/" class="md-nav__link"> 公平组合游戏 </a> </li> <li class="md-nav__item"> <a href="../../math/game-theory/partizan-game/" class="md-nav__link"> 非公平组合游戏 </a> </li> <li class="md-nav__item"> <a href="../../math/game-theory/misere-game/" class="md-nav__link"> 反常游戏 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9_20" type="checkbox" id="__nav_9_20"> <label class="md-nav__link" for="__nav_9_20"> 数值算法 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="数值算法" data-md-level="2"> <label class="md-nav__title" for="__nav_9_20"> <span class="md-nav__icon md-icon"></span> 数值算法 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../math/numerical/interp/" class="md-nav__link"> 插值 </a> </li> <li class="md-nav__item"> <a href="../../math/numerical/integral/" class="md-nav__link"> 数值积分 </a> </li> <li class="md-nav__item"> <a href="../../math/numerical/gauss/" class="md-nav__link"> 高斯消元 </a> </li> <li class="md-nav__item"> <a href="../../math/numerical/newton/" class="md-nav__link"> 牛顿迭代法 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../math/fourier-motzkin-elimination/" class="md-nav__link"> 傅里叶-莫茨金消元法 </a> </li> <li class="md-nav__item"> <a href="../../math/order-theory/" class="md-nav__link"> 序理论 </a> </li> <li class="md-nav__item"> <a href="../../math/young-tableau/" class="md-nav__link"> 杨氏矩阵 </a> </li> <li class="md-nav__item"> <a href="../../math/matroid/" class="md-nav__link"> 拟阵 </a> </li> <li class="md-nav__item"> <a href="../../math/berlekamp-massey/" class="md-nav__link"> Berlekamp–Massey 算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" checked=""> <label class="md-nav__link" for="__nav_10"> 数据结构 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="数据结构" data-md-level="1"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> 数据结构 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../" class="md-nav__link"> 数据结构部分简介 </a> </li> <li class="md-nav__item"> <a href="../stack/" class="md-nav__link"> 栈 </a> </li> <li class="md-nav__item"> <a href="../queue/" class="md-nav__link"> 队列 </a> </li> <li class="md-nav__item"> <a href="../linked-list/" class="md-nav__link"> 链表 </a> </li> <li class="md-nav__item"> <a href="../hash/" class="md-nav__link"> 哈希表 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_6" type="checkbox" id="__nav_10_6"> <label class="md-nav__link" for="__nav_10_6"> 并查集 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="并查集" data-md-level="2"> <label class="md-nav__title" for="__nav_10_6"> <span class="md-nav__icon md-icon"></span> 并查集 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../dsu/" class="md-nav__link"> 并查集 </a> </li> <li class="md-nav__item"> <a href="../dsu-complexity/" class="md-nav__link"> 并查集复杂度 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_7" type="checkbox" id="__nav_10_7"> <label class="md-nav__link" for="__nav_10_7"> 堆 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="堆" data-md-level="2"> <label class="md-nav__title" for="__nav_10_7"> <span class="md-nav__icon md-icon"></span> 堆 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../heap/" class="md-nav__link"> 堆简介 </a> </li> <li class="md-nav__item"> <a href="../binary-heap/" class="md-nav__link"> 二叉堆 </a> </li> <li class="md-nav__item"> <a href="../pairing-heap/" class="md-nav__link"> 配对堆 </a> </li> <li class="md-nav__item"> <a href="../leftist-tree/" class="md-nav__link"> 左偏树 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_8" type="checkbox" id="__nav_10_8"> <label class="md-nav__link" for="__nav_10_8"> 块状数据结构 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="块状数据结构" data-md-level="2"> <label class="md-nav__title" for="__nav_10_8"> <span class="md-nav__icon md-icon"></span> 块状数据结构 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../decompose/" class="md-nav__link"> 分块思想 </a> </li> <li class="md-nav__item"> <a href="../block-array/" class="md-nav__link"> 块状数组 </a> </li> <li class="md-nav__item"> <a href="../block-list/" class="md-nav__link"> 块状链表 </a> </li> <li class="md-nav__item"> <a href="../tree-decompose/" class="md-nav__link"> 树分块 </a> </li> <li class="md-nav__item"> <a href="../sqrt-tree/" class="md-nav__link"> Sqrt Tree </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../monotonous-stack/" class="md-nav__link"> 单调栈 </a> </li> <li class="md-nav__item"> <a href="../monotonous-queue/" class="md-nav__link"> 单调队列 </a> </li> <li class="md-nav__item"> <a href="../sparse-table/" class="md-nav__link"> ST 表 </a> </li> <li class="md-nav__item"> <a href="../fenwick/" class="md-nav__link"> 树状数组 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_13" type="checkbox" id="__nav_10_13"> <label class="md-nav__link" for="__nav_10_13"> 线段树 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="线段树" data-md-level="2"> <label class="md-nav__title" for="__nav_10_13"> <span class="md-nav__icon md-icon"></span> 线段树 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../seg/" class="md-nav__link"> 线段树基础 </a> </li> <li class="md-nav__item"> <a href="../seg-merge-split/" class="md-nav__link"> 线段树合并 &amp; 分裂 </a> </li> <li class="md-nav__item"> <a href="../li-chao-tree/" class="md-nav__link"> 李超线段树 </a> </li> <li class="md-nav__item"> <a href="../cat-tree/" class="md-nav__link"> 猫树 </a> </li> <li class="md-nav__item"> <a href="../seg-beats/" class="md-nav__link"> 区间最值操作 &amp; 区间历史最值 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../dividing/" class="md-nav__link"> 划分树 </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_15" type="checkbox" id="__nav_10_15" checked=""> <label class="md-nav__link" for="__nav_10_15"> 二叉搜索树 &amp; 平衡树 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="二叉搜索树 &amp; 平衡树" data-md-level="2"> <label class="md-nav__title" for="__nav_10_15"> <span class="md-nav__icon md-icon"></span> 二叉搜索树 &amp; 平衡树 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../bst/" class="md-nav__link"> 二叉搜索树 &amp; 平衡树 </a> </li> <li class="md-nav__item"> <a href="../treap/" class="md-nav__link"> Treap </a> </li> <li class="md-nav__item"> <a href="../splay/" class="md-nav__link"> Splay 树 </a> </li> <li class="md-nav__item"> <a href="../wblt/" class="md-nav__link"> WBLT </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> Size Balanced Tree <span class="md-nav__icon md-icon"></span> </label> <a href="./" class="md-nav__link md-nav__link--active"> Size Balanced Tree </a> <nav class="md-nav md-nav--secondary" aria-label="目录"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a href="#节点定义" class="md-nav__link"> 节点定义 </a> </li> <li class="md-nav__item"> <a href="#性质" class="md-nav__link"> 性质 </a> </li> <li class="md-nav__item"> <a href="#平衡维护" class="md-nav__link"> 平衡维护 </a> <nav class="md-nav" aria-label="平衡维护"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#旋转" class="md-nav__link"> 旋转 </a> </li> <li class="md-nav__item"> <a href="#维护" class="md-nav__link"> 维护 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#操作" class="md-nav__link"> 操作 </a> <nav class="md-nav" aria-label="操作"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#插入" class="md-nav__link"> 插入 </a> </li> <li class="md-nav__item"> <a href="#删除" class="md-nav__link"> 删除 </a> </li> <li class="md-nav__item"> <a href="#查询排名" class="md-nav__link"> 查询排名 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="#参考代码" class="md-nav__link"> 参考代码 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../avl/" class="md-nav__link"> AVL 树 </a> </li> <li class="md-nav__item"> <a href="../b-tree/" class="md-nav__link"> B 树 </a> </li> <li class="md-nav__item"> <a href="../bplus-tree/" class="md-nav__link"> B+ 树 </a> </li> <li class="md-nav__item"> <a href="../sgt/" class="md-nav__link"> 替罪羊树 </a> </li> <li class="md-nav__item"> <a href="../leafy-tree/" class="md-nav__link"> Leafy Tree </a> </li> <li class="md-nav__item"> <a href="../cartesian-tree/" class="md-nav__link"> 笛卡尔树 </a> </li> <li class="md-nav__item"> <a href="../rbtree/" class="md-nav__link"> 红黑树 </a> </li> <li class="md-nav__item"> <a href="../llrbt/" class="md-nav__link"> 左偏红黑树 </a> </li> <li class="md-nav__item"> <a href="../aa-tree/" class="md-nav__link"> AA 树 </a> </li> <li class="md-nav__item"> <a href="../2-3-tree/" class="md-nav__link"> 2-3 树 </a> </li> <li class="md-nav__item"> <a href="../2-3-4-tree/" class="md-nav__link"> 2-3-4 树 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../skiplist/" class="md-nav__link"> 跳表 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_17" type="checkbox" id="__nav_10_17"> <label class="md-nav__link" for="__nav_10_17"> 可持久化数据结构 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="可持久化数据结构" data-md-level="2"> <label class="md-nav__title" for="__nav_10_17"> <span class="md-nav__icon md-icon"></span> 可持久化数据结构 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../persistent/" class="md-nav__link"> 可持久化数据结构简介 </a> </li> <li class="md-nav__item"> <a href="../persistent-seg/" class="md-nav__link"> 可持久化线段树 </a> </li> <li class="md-nav__item"> <a href="../persistent-block-array/" class="md-nav__link"> 可持久化块状数组 </a> </li> <li class="md-nav__item"> <a href="../persistent-balanced/" class="md-nav__link"> 可持久化平衡树 </a> </li> <li class="md-nav__item"> <a href="../persistent-trie/" class="md-nav__link"> 可持久化字典树 </a> </li> <li class="md-nav__item"> <a href="../persistent-heap/" class="md-nav__link"> 可持久化可并堆 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_18" type="checkbox" id="__nav_10_18"> <label class="md-nav__link" for="__nav_10_18"> 树套树 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="树套树" data-md-level="2"> <label class="md-nav__title" for="__nav_10_18"> <span class="md-nav__icon md-icon"></span> 树套树 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../seg-in-seg/" class="md-nav__link"> 线段树套线段树 </a> </li> <li class="md-nav__item"> <a href="../seg-in-balanced/" class="md-nav__link"> 平衡树套线段树 </a> </li> <li class="md-nav__item"> <a href="../balanced-in-seg/" class="md-nav__link"> 线段树套平衡树 </a> </li> <li class="md-nav__item"> <a href="../seg-in-bit/" class="md-nav__link"> 树状数组套权值线段树 </a> </li> <li class="md-nav__item"> <a href="../bit-in-block-array/" class="md-nav__link"> 分块套树状数组 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../kdt/" class="md-nav__link"> K-D Tree </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10_20" type="checkbox" id="__nav_10_20"> <label class="md-nav__link" for="__nav_10_20"> 动态树 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="动态树" data-md-level="2"> <label class="md-nav__title" for="__nav_10_20"> <span class="md-nav__icon md-icon"></span> 动态树 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../lct/" class="md-nav__link"> Link Cut Tree </a> </li> <li class="md-nav__item"> <a href="../global-bst/" class="md-nav__link"> 全局平衡二叉树 </a> </li> <li class="md-nav__item"> <a href="../ett/" class="md-nav__link"> Euler Tour Tree </a> </li> <li class="md-nav__item"> <a href="../top-tree/" class="md-nav__link"> Top Tree </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../divide-combine/" class="md-nav__link"> 析合树 </a> </li> <li class="md-nav__item"> <a href="../pq-tree/" class="md-nav__link"> PQ 树 </a> </li> <li class="md-nav__item"> <a href="../finger-tree/" class="md-nav__link"> 手指树 </a> </li> <li class="md-nav__item"> <a href="../huffman-tree/" class="md-nav__link"> 霍夫曼树 </a> </li> <li class="md-nav__item"> <a href="../loser-tree/" class="md-nav__link"> 败者树 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11"> <label class="md-nav__link" for="__nav_11"> 图论 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="图论" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> 图论 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/" class="md-nav__link"> 图论部分简介 </a> </li> <li class="md-nav__item"> <a href="../../graph/concept/" class="md-nav__link"> 图论相关概念 </a> </li> <li class="md-nav__item"> <a href="../../graph/save/" class="md-nav__link"> 图的存储 </a> </li> <li class="md-nav__item"> <a href="../../graph/dfs/" class="md-nav__link"> DFS（图论） </a> </li> <li class="md-nav__item"> <a href="../../graph/bfs/" class="md-nav__link"> BFS（图论） </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_6" type="checkbox" id="__nav_11_6"> <label class="md-nav__link" for="__nav_11_6"> 树上问题 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="树上问题" data-md-level="2"> <label class="md-nav__title" for="__nav_11_6"> <span class="md-nav__icon md-icon"></span> 树上问题 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/tree-basic/" class="md-nav__link"> 树基础 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-diameter/" class="md-nav__link"> 树的直径 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-center/" class="md-nav__link"> 树的中心 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-centroid/" class="md-nav__link"> 树的重心 </a> </li> <li class="md-nav__item"> <a href="../../graph/lca/" class="md-nav__link"> 最近公共祖先 </a> </li> <li class="md-nav__item"> <a href="../../graph/hld/" class="md-nav__link"> 树链剖分 </a> </li> <li class="md-nav__item"> <a href="../../graph/dsu-on-tree/" class="md-nav__link"> 树上启发式合并 </a> </li> <li class="md-nav__item"> <a href="../../graph/virtual-tree/" class="md-nav__link"> 虚树 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-divide/" class="md-nav__link"> 树分治 </a> </li> <li class="md-nav__item"> <a href="../../graph/dynamic-tree-divide/" class="md-nav__link"> 动态树分治 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-ahu/" class="md-nav__link"> AHU 算法 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-hash/" class="md-nav__link"> 树哈希 </a> </li> <li class="md-nav__item"> <a href="../../graph/tree-random-walk/" class="md-nav__link"> 树上随机游走 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../graph/matrix-tree/" class="md-nav__link"> 矩阵树定理 </a> </li> <li class="md-nav__item"> <a href="../../graph/dag/" class="md-nav__link"> 有向无环图 </a> </li> <li class="md-nav__item"> <a href="../../graph/topo/" class="md-nav__link"> 拓扑排序 </a> </li> <li class="md-nav__item"> <a href="../../graph/mst/" class="md-nav__link"> 最小生成树 </a> </li> <li class="md-nav__item"> <a href="../../graph/steiner-tree/" class="md-nav__link"> 斯坦纳树 </a> </li> <li class="md-nav__item"> <a href="../../graph/dmst/" class="md-nav__link"> 最小树形图 </a> </li> <li class="md-nav__item"> <a href="../../graph/mdst/" class="md-nav__link"> 最小直径生成树 </a> </li> <li class="md-nav__item"> <a href="../../graph/shortest-path/" class="md-nav__link"> 最短路 </a> </li> <li class="md-nav__item"> <a href="../../graph/node/" class="md-nav__link"> 拆点 </a> </li> <li class="md-nav__item"> <a href="../../graph/diff-constraints/" class="md-nav__link"> 差分约束 </a> </li> <li class="md-nav__item"> <a href="../../graph/kth-path/" class="md-nav__link"> k 短路 </a> </li> <li class="md-nav__item"> <a href="../../graph/mod-shortest-path/" class="md-nav__link"> 同余最短路 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_19" type="checkbox" id="__nav_11_19"> <label class="md-nav__link" for="__nav_11_19"> 连通性相关 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="连通性相关" data-md-level="2"> <label class="md-nav__title" for="__nav_11_19"> <span class="md-nav__icon md-icon"></span> 连通性相关 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/scc/" class="md-nav__link"> 强连通分量 </a> </li> <li class="md-nav__item"> <a href="../../graph/bcc/" class="md-nav__link"> 双连通分量 </a> </li> <li class="md-nav__item"> <a href="../../graph/cut/" class="md-nav__link"> 割点和桥 </a> </li> <li class="md-nav__item"> <a href="../../graph/block-forest/" class="md-nav__link"> 圆方树 </a> </li> <li class="md-nav__item"> <a href="../../graph/connectivity/" class="md-nav__link"> 点/边连通度 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../graph/rings-count/" class="md-nav__link"> 环计数问题 </a> </li> <li class="md-nav__item"> <a href="../../graph/2-sat/" class="md-nav__link"> 2-SAT </a> </li> <li class="md-nav__item"> <a href="../../graph/euler/" class="md-nav__link"> 欧拉图 </a> </li> <li class="md-nav__item"> <a href="../../graph/hamilton/" class="md-nav__link"> 哈密顿图 </a> </li> <li class="md-nav__item"> <a href="../../graph/bi-graph/" class="md-nav__link"> 二分图 </a> </li> <li class="md-nav__item"> <a href="../../graph/min-cycle/" class="md-nav__link"> 最小环 </a> </li> <li class="md-nav__item"> <a href="../../graph/planar/" class="md-nav__link"> 平面图 </a> </li> <li class="md-nav__item"> <a href="../../graph/color/" class="md-nav__link"> 图的着色 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_28" type="checkbox" id="__nav_11_28"> <label class="md-nav__link" for="__nav_11_28"> 网络流 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="网络流" data-md-level="2"> <label class="md-nav__title" for="__nav_11_28"> <span class="md-nav__icon md-icon"></span> 网络流 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/flow/" class="md-nav__link"> 网络流简介 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/max-flow/" class="md-nav__link"> 最大流 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/min-cut/" class="md-nav__link"> 最小割 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/min-cost/" class="md-nav__link"> 费用流 </a> </li> <li class="md-nav__item"> <a href="../../graph/flow/bound/" class="md-nav__link"> 上下界网络流 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../graph/stoer-wagner/" class="md-nav__link"> Stoer–Wagner 算法 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11_30" type="checkbox" id="__nav_11_30"> <label class="md-nav__link" for="__nav_11_30"> 图的匹配 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="图的匹配" data-md-level="2"> <label class="md-nav__title" for="__nav_11_30"> <span class="md-nav__icon md-icon"></span> 图的匹配 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../graph/graph-matching/graph-match/" class="md-nav__link"> 图匹配 </a> </li> <li class="md-nav__item"> <a href="../../graph/graph-matching/augment/" class="md-nav__link"> 增广路 </a> </li> <li class="md-nav__item"> <a href="../../graph/graph-matching/bigraph-match/" class="md-nav__link"> 二分图最大匹配 </a> </li> <li class="md-nav__item"> <a href="../../graph/graph-matching/bigraph-weight-match/" class="md-nav__link"> 二分图最大权匹配 </a> </li> <li class="md-nav__item"> <a href="../../graph/graph-matching/general-match/" class="md-nav__link"> 一般图最大匹配 </a> </li> <li class="md-nav__item"> <a href="../../graph/graph-matching/general-weight-match/" class="md-nav__link"> 一般图最大权匹配 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../graph/prufer/" class="md-nav__link"> Prüfer 序列 </a> </li> <li class="md-nav__item"> <a href="../../graph/lgv/" class="md-nav__link"> LGV 引理 </a> </li> <li class="md-nav__item"> <a href="../../graph/chord/" class="md-nav__link"> 弦图 </a> </li> <li class="md-nav__item"> <a href="../../graph/max-clique/" class="md-nav__link"> 最大团搜索算法 </a> </li> <li class="md-nav__item"> <a href="../../graph/dominator-tree/" class="md-nav__link"> 支配树 </a> </li> <li class="md-nav__item"> <a href="../../graph/graph-random-walk/" class="md-nav__link"> 图上随机游走 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12"> <label class="md-nav__link" for="__nav_12"> 计算几何 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="计算几何" data-md-level="1"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> 计算几何 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../geometry/" class="md-nav__link"> 计算几何部分简介 </a> </li> <li class="md-nav__item"> <a href="../../geometry/2d/" class="md-nav__link"> 二维计算几何基础 </a> </li> <li class="md-nav__item"> <a href="../../geometry/3d/" class="md-nav__link"> 三维计算几何基础 </a> </li> <li class="md-nav__item"> <a href="../../geometry/distance/" class="md-nav__link"> 距离 </a> </li> <li class="md-nav__item"> <a href="../../geometry/pick/" class="md-nav__link"> Pick 定理 </a> </li> <li class="md-nav__item"> <a href="../../geometry/triangulation/" class="md-nav__link"> 三角剖分 </a> </li> <li class="md-nav__item"> <a href="../../geometry/convex-hull/" class="md-nav__link"> 凸包 </a> </li> <li class="md-nav__item"> <a href="../../geometry/scanning/" class="md-nav__link"> 扫描线 </a> </li> <li class="md-nav__item"> <a href="../../geometry/rotating-calipers/" class="md-nav__link"> 旋转卡壳 </a> </li> <li class="md-nav__item"> <a href="../../geometry/half-plane/" class="md-nav__link"> 半平面交 </a> </li> <li class="md-nav__item"> <a href="../../geometry/nearest-points/" class="md-nav__link"> 平面最近点对 </a> </li> <li class="md-nav__item"> <a href="../../geometry/random-incremental/" class="md-nav__link"> 随机增量法 </a> </li> <li class="md-nav__item"> <a href="../../geometry/inverse/" class="md-nav__link"> 反演变换 </a> </li> <li class="md-nav__item"> <a href="../../geometry/misc/" class="md-nav__link"> 计算几何杂项 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13"> <label class="md-nav__link" for="__nav_13"> 杂项 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="杂项" data-md-level="1"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> 杂项 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/" class="md-nav__link"> 杂项简介 </a> </li> <li class="md-nav__item"> <a href="../../misc/discrete/" class="md-nav__link"> 离散化 </a> </li> <li class="md-nav__item"> <a href="../../misc/two-pointer/" class="md-nav__link"> 双指针 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_4" type="checkbox" id="__nav_13_4"> <label class="md-nav__link" for="__nav_13_4"> 离线算法 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="离线算法" data-md-level="2"> <label class="md-nav__title" for="__nav_13_4"> <span class="md-nav__icon md-icon"></span> 离线算法 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/offline/" class="md-nav__link"> 离线算法简介 </a> </li> <li class="md-nav__item"> <a href="../../misc/cdq-divide/" class="md-nav__link"> CDQ 分治 </a> </li> <li class="md-nav__item"> <a href="../../misc/parallel-binsearch/" class="md-nav__link"> 整体二分 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_4_4" type="checkbox" id="__nav_13_4_4"> <label class="md-nav__link" for="__nav_13_4_4"> 莫队算法 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="莫队算法" data-md-level="3"> <label class="md-nav__title" for="__nav_13_4_4"> <span class="md-nav__icon md-icon"></span> 莫队算法 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/mo-algo-intro/" class="md-nav__link"> 莫队算法简介 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo/" class="md-nav__link"> 普通莫队算法 </a> </li> <li class="md-nav__item"> <a href="../../misc/modifiable-mo-algo/" class="md-nav__link"> 带修改莫队 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo-on-tree/" class="md-nav__link"> 树上莫队 </a> </li> <li class="md-nav__item"> <a href="../../misc/rollback-mo-algo/" class="md-nav__link"> 回滚莫队 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo-2dimen/" class="md-nav__link"> 二维莫队 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo-secondary-offline/" class="md-nav__link"> 莫队二次离线 </a> </li> <li class="md-nav__item"> <a href="../../misc/mo-algo-with-bitset/" class="md-nav__link"> 莫队配合 bitset </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../misc/frac-programming/" class="md-nav__link"> 分数规划 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_6" type="checkbox" id="__nav_13_6"> <label class="md-nav__link" for="__nav_13_6"> 随机化 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="随机化" data-md-level="2"> <label class="md-nav__title" for="__nav_13_6"> <span class="md-nav__icon md-icon"></span> 随机化 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../misc/random/" class="md-nav__link"> 随机函数 </a> </li> <li class="md-nav__item"> <a href="../../misc/rand-technique/" class="md-nav__link"> 随机化技巧 </a> </li> <li class="md-nav__item"> <a href="../../misc/hill-climbing/" class="md-nav__link"> 爬山算法 </a> </li> <li class="md-nav__item"> <a href="../../misc/simulated-annealing/" class="md-nav__link"> 模拟退火 </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../misc/hoverline/" class="md-nav__link"> 悬线法 </a> </li> <li class="md-nav__item"> <a href="../../misc/cc-basic/" class="md-nav__link"> 计算理论基础 </a> </li> <li class="md-nav__item"> <a href="../../misc/endianness/" class="md-nav__link"> 字节顺序 </a> </li> <li class="md-nav__item"> <a href="../../misc/josephus/" class="md-nav__link"> 约瑟夫问题 </a> </li> <li class="md-nav__item"> <a href="../../misc/gray-code/" class="md-nav__link"> 格雷码 </a> </li> <li class="md-nav__item"> <a href="../../misc/expression/" class="md-nav__link"> 表达式求值 </a> </li> <li class="md-nav__item"> <a href="../../misc/job-order/" class="md-nav__link"> 在一台机器上规划任务 </a> </li> <li class="md-nav__item"> <a href="../../misc/main-element/" class="md-nav__link"> 主元素问题 </a> </li> <li class="md-nav__item"> <a href="../../misc/garsia-wachs/" class="md-nav__link"> Garsia–Wachs 算法 </a> </li> <li class="md-nav__item"> <a href="../../misc/15-puzzle/" class="md-nav__link"> 15-puzzle </a> </li> <li class="md-nav__item"> <a href="../../misc/kahan-summation/" class="md-nav__link"> Kahan 求和 </a> </li> <li class="md-nav__item"> <a href="../../misc/odt/" class="md-nav__link"> 珂朵莉树/颜色段均摊 </a> </li> <li class="md-nav__item"> <a href="../../misc/space-optimization/" class="md-nav__link"> 空间优化简介 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14"> <label class="md-nav__link" for="__nav_14"> 专题 <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" aria-label="专题" data-md-level="1"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> 专题 </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a href="../../topic/rmq/" class="md-nav__link"> RMQ </a> </li> <li class="md-nav__item"> <a href="../../topic/dsu-app/" class="md-nav__link"> 并查集应用 </a> </li> <li class="md-nav__item"> <a href="../../topic/bracket/" class="md-nav__link"> 括号序列 </a> </li> <li class="md-nav__item"> <a href="../../topic/segment-tree-offline/" class="md-nav__link"> 线段树与离线询问 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1>Size Balanced Tree</h1> <p>Size Balanced Tree (SBT) 是由中国 OI 选手陈启峰在 2007 年提出的一种自平衡二叉搜索树 (Self-Balanced Binary Search Tree, SBBST), 通过检查子树的节点数量进行自身的平衡维护。相比于红黑树，AVL 等主流自平衡二叉搜索树而言，Size Balanced Tree 支持在 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.112ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3585.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5456-TEX-I-1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path id="MJX-5456-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-5456-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-5456-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-5456-TEX-N-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path><path id="MJX-5456-TEX-N-2061" d=""></path><path id="MJX-5456-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-5456-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D442" xlink:href="#MJX-5456-TEX-I-1D442"></use></g><g data-mml-node="mo" transform="translate(763,0)"><use data-c="28" xlink:href="#MJX-5456-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1152,0)"><use data-c="6C" xlink:href="#MJX-5456-TEX-N-6C"></use><use data-c="6F" xlink:href="#MJX-5456-TEX-N-6F" transform="translate(278,0)"></use><use data-c="67" xlink:href="#MJX-5456-TEX-N-67" transform="translate(778,0)"></use></g><g data-mml-node="mo" transform="translate(2430,0)"><use data-c="2061" xlink:href="#MJX-5456-TEX-N-2061"></use></g><g data-mml-node="mi" transform="translate(2596.7,0)"><use data-c="1D45B" xlink:href="#MJX-5456-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(3196.7,0)"><use data-c="29" xlink:href="#MJX-5456-TEX-N-29"></use></g></g></g></svg></mjx-container></span> 的时间复杂度内查询某个键值在树中的排名 (rank).</p> <h2 id="节点定义">节点定义<a class="headerlink" href="#节点定义" title="Permanent link"></a></h2> <p>相比与普通二叉搜索树，SBT 的每个节点 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5457-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-5457-TEX-I-1D441"></use></g></g></g></svg></mjx-container></span> 仅需要多维护一个整数字段 <code>size</code>, 用于储存以 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5458-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-5458-TEX-I-1D441"></use></g></g></g></svg></mjx-container></span> 为根的子树中节点的个数。节点类型 <code>Node</code> 的具体定义如下：</p> <table> <thead> <tr> <th>Identifier</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>left</code></td> <td><code>Node*</code></td> <td>左子节点引用</td> </tr> <tr> <td><code>right</code></td> <td><code>Node*</code></td> <td>右子节点引用</td> </tr> <tr> <td><code>size</code></td> <td><code>int</code></td> <td>以该节点为根的子树中节点的个数</td> </tr> </tbody> </table> <h2 id="性质">性质<a class="headerlink" href="#性质" title="Permanent link"></a></h2> <p>Size Balanced Tree 中任意节点 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5459-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-5459-TEX-I-1D441"></use></g></g></g></svg></mjx-container></span> 满足如下几条性质：</p> <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a>size(N.left) &gt;= size(N.right.left)
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a>size(N.left) &gt;= size(N.right.right)
<a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a>size(N.right) &gt;= size(N.left.left)
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a>size(N.right) &gt;= size(N.left.right)
</code></pre></div> <p>使用自然语言可描述为：任意节点的 <code>size</code> 不小于其兄弟节点（Sibling）的所有子节点（Nephew）的 <code>size</code>.</p> <h2 id="平衡维护">平衡维护<a class="headerlink" href="#平衡维护" title="Permanent link"></a></h2> <h3 id="旋转">旋转<a class="headerlink" href="#旋转" title="Permanent link"></a></h3> <p>SBT 主要通过旋转操作改变自身高度从而进行平衡维护。其旋转操作与绝大部分自平衡二叉搜索树类似，唯一区别在于在完成旋转之后需要对旋转过程中左右子节点发生改变的节点更新 <code>size</code>. 示例代码如下：</p> <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kt">void</span><span class="w"> </span><span class="nf">updateSize</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">leftSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a><a href="#__codelineno-1-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">rightSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a><a href="#__codelineno-1-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">  </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftSize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rightSize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a><a href="#__codelineno-1-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="p">}</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a><a href="#__codelineno-1-6"><span class="linenos" data-linenos=" 6 "></span></a>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a><a href="#__codelineno-1-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">rotateLeft</span><span class="p">(</span><span class="n">NodePtr</span><span class="o">&amp;</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a><a href="#__codelineno-1-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a><a href="#__codelineno-1-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="c1">// clang-format off</span>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a><a href="#__codelineno-1-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="c1">//     |                       |</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a><a href="#__codelineno-1-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span><span class="c1">//     N                       S</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a><a href="#__codelineno-1-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="c1">//    / \     l-rotate(N)     / \</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a><a href="#__codelineno-1-13"><span class="linenos" data-linenos="13 "></span></a><span class="c1">  //   L   S    ==========&gt;    N   R</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a><a href="#__codelineno-1-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="c1">//      / \                 / \</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a><a href="#__codelineno-1-15"><span class="linenos" data-linenos="15 "></span></a><span class="c1">  //     M   R               L   M</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a><a href="#__codelineno-1-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">  </span><span class="c1">// clang-format on</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a><a href="#__codelineno-1-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">  </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a><a href="#__codelineno-1-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">  </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a><a href="#__codelineno-1-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">  </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a><a href="#__codelineno-1-20"><span class="linenos" data-linenos="20 "></span></a>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a><a href="#__codelineno-1-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">  </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a><a href="#__codelineno-1-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">  </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a><a href="#__codelineno-1-23"><span class="linenos" data-linenos="23 "></span></a>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a><a href="#__codelineno-1-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">  </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-1-25" name="__codelineno-1-25"></a><a href="#__codelineno-1-25"><span class="linenos" data-linenos="25 "></span></a><span class="p">}</span>
<a id="__codelineno-1-26" name="__codelineno-1-26"></a><a href="#__codelineno-1-26"><span class="linenos" data-linenos="26 "></span></a>
<a id="__codelineno-1-27" name="__codelineno-1-27"></a><a href="#__codelineno-1-27"><span class="linenos" data-linenos="27 "></span></a><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">rotateRight</span><span class="p">(</span><span class="n">NodePtr</span><span class="o">&amp;</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-1-28" name="__codelineno-1-28"></a><a href="#__codelineno-1-28"><span class="linenos" data-linenos="28 "></span></a><span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-1-29" name="__codelineno-1-29"></a><a href="#__codelineno-1-29"><span class="linenos" data-linenos="29 "></span></a><span class="w">  </span><span class="c1">// clang-format off</span>
<a id="__codelineno-1-30" name="__codelineno-1-30"></a><a href="#__codelineno-1-30"><span class="linenos" data-linenos="30 "></span></a><span class="w">  </span><span class="c1">//       |                   |</span>
<a id="__codelineno-1-31" name="__codelineno-1-31"></a><a href="#__codelineno-1-31"><span class="linenos" data-linenos="31 "></span></a><span class="w">  </span><span class="c1">//       N                   S</span>
<a id="__codelineno-1-32" name="__codelineno-1-32"></a><a href="#__codelineno-1-32"><span class="linenos" data-linenos="32 "></span></a><span class="w">  </span><span class="c1">//      / \   r-rotate(N)   / \</span>
<a id="__codelineno-1-33" name="__codelineno-1-33"></a><a href="#__codelineno-1-33"><span class="linenos" data-linenos="33 "></span></a><span class="c1">  //     S   R  ==========&gt;  L   N</span>
<a id="__codelineno-1-34" name="__codelineno-1-34"></a><a href="#__codelineno-1-34"><span class="linenos" data-linenos="34 "></span></a><span class="w">  </span><span class="c1">//    / \                     / \</span>
<a id="__codelineno-1-35" name="__codelineno-1-35"></a><a href="#__codelineno-1-35"><span class="linenos" data-linenos="35 "></span></a><span class="c1">  //   L   M                   M   R</span>
<a id="__codelineno-1-36" name="__codelineno-1-36"></a><a href="#__codelineno-1-36"><span class="linenos" data-linenos="36 "></span></a><span class="w">  </span><span class="c1">// clang-format on</span>
<a id="__codelineno-1-37" name="__codelineno-1-37"></a><a href="#__codelineno-1-37"><span class="linenos" data-linenos="37 "></span></a><span class="w">  </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-1-38" name="__codelineno-1-38"></a><a href="#__codelineno-1-38"><span class="linenos" data-linenos="38 "></span></a><span class="w">  </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-1-39" name="__codelineno-1-39"></a><a href="#__codelineno-1-39"><span class="linenos" data-linenos="39 "></span></a><span class="w">  </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-1-40" name="__codelineno-1-40"></a><a href="#__codelineno-1-40"><span class="linenos" data-linenos="40 "></span></a>
<a id="__codelineno-1-41" name="__codelineno-1-41"></a><a href="#__codelineno-1-41"><span class="linenos" data-linenos="41 "></span></a><span class="w">  </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-1-42" name="__codelineno-1-42"></a><a href="#__codelineno-1-42"><span class="linenos" data-linenos="42 "></span></a><span class="w">  </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-1-43" name="__codelineno-1-43"></a><a href="#__codelineno-1-43"><span class="linenos" data-linenos="43 "></span></a>
<a id="__codelineno-1-44" name="__codelineno-1-44"></a><a href="#__codelineno-1-44"><span class="linenos" data-linenos="44 "></span></a><span class="w">  </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-1-45" name="__codelineno-1-45"></a><a href="#__codelineno-1-45"><span class="linenos" data-linenos="45 "></span></a><span class="p">}</span>
</code></pre></div> <h3 id="维护">维护<a class="headerlink" href="#维护" title="Permanent link"></a></h3> <h4 id="case-1">Case 1<a class="headerlink" href="#case-1" title="Permanent link"></a></h4> <p><code>size(N.left) &lt; size(N.right.left)</code></p> <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="c1">// clang-format off</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="c1">//     |                     |                      |</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">  </span><span class="c1">//     N                     N                     [M]</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">  </span><span class="c1">//    / \    r-rotate(R)    / \     l-rotate(N)    / \</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1">  //  &lt;L&gt;  R   ==========&gt;  &lt;L&gt; [M]   ==========&gt;   N   R</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><a href="#__codelineno-2-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">  </span><span class="c1">//      /                       \                /</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a><a href="#__codelineno-2-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span><span class="c1">//    [M]                        R             &lt;L&gt;</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a><a href="#__codelineno-2-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="c1">// clang-format on</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a><a href="#__codelineno-2-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="n">rotateRight</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a><a href="#__codelineno-2-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span><span class="n">rotateLeft</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-2-12" name="__codelineno-2-12"></a><a href="#__codelineno-2-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-2-13" name="__codelineno-2-13"></a><a href="#__codelineno-2-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-2-14" name="__codelineno-2-14"></a><a href="#__codelineno-2-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-2-15" name="__codelineno-2-15"></a><a href="#__codelineno-2-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">  </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-2-16" name="__codelineno-2-16"></a><a href="#__codelineno-2-16"><span class="linenos" data-linenos="16 "></span></a><span class="p">}</span>
</code></pre></div> <h4 id="case-2">Case 2<a class="headerlink" href="#case-2" title="Permanent link"></a></h4> <p><code>size(N.left) &lt; size(N.right.right)</code></p> <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="c1">// clang-format off</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><a href="#__codelineno-3-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="c1">//     |                       |</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><a href="#__codelineno-3-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">  </span><span class="c1">//     N                       R</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><a href="#__codelineno-3-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">  </span><span class="c1">//    / \     l-rotate(N)     / \</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><a href="#__codelineno-3-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1">  //  &lt;L&gt;  R    ==========&gt;    N  [M]</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><a href="#__codelineno-3-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">  </span><span class="c1">//        \                 /</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a><a href="#__codelineno-3-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span><span class="c1">//        [M]             &lt;L&gt;</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a><a href="#__codelineno-3-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="c1">// clang-format on</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a><a href="#__codelineno-3-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="n">rotateLeft</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a><a href="#__codelineno-3-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a><a href="#__codelineno-3-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a><a href="#__codelineno-3-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">  </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a><a href="#__codelineno-3-14"><span class="linenos" data-linenos="14 "></span></a><span class="p">}</span>
</code></pre></div> <h4 id="case-3">Case 3<a class="headerlink" href="#case-3" title="Permanent link"></a></h4> <p><code>size(N.right) &lt; size(N.left.left)</code></p> <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="c1">// clang-format off</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><a href="#__codelineno-4-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="c1">//       |                       |</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><a href="#__codelineno-4-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">  </span><span class="c1">//       N                       L</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><a href="#__codelineno-4-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">  </span><span class="c1">//      / \     r-rotate(N)     / \</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a><a href="#__codelineno-4-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1">  //     L  &lt;R&gt;   ==========&gt;   [M]  N</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><a href="#__codelineno-4-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">  </span><span class="c1">//    /                             \</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><a href="#__codelineno-4-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1">  //  [M]                             &lt;R&gt;</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><a href="#__codelineno-4-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="c1">// clang-format on</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a><a href="#__codelineno-4-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="n">rotateRight</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a><a href="#__codelineno-4-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><a href="#__codelineno-4-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a><a href="#__codelineno-4-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">  </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a><a href="#__codelineno-4-14"><span class="linenos" data-linenos="14 "></span></a><span class="p">}</span>
</code></pre></div> <h4 id="case-4">Case 4<a class="headerlink" href="#case-4" title="Permanent link"></a></h4> <p><code>size(N.right) &lt; size(N.left.right)</code></p> <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><a href="#__codelineno-5-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="c1">// clang-format off</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><a href="#__codelineno-5-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="c1">//     |                     |                      |</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><a href="#__codelineno-5-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">  </span><span class="c1">//     N                     N                     [M]</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><a href="#__codelineno-5-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">  </span><span class="c1">//    / \    l-rotate(L)    / \     r-rotate(N)    / \</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><a href="#__codelineno-5-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1">  //   L  &lt;R&gt;  ==========&gt;  [M] &lt;R&gt;   ==========&gt;   L   N</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><a href="#__codelineno-5-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">  </span><span class="c1">//    \                   /                            \</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><a href="#__codelineno-5-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1">  //    [M]                L                             &lt;R&gt;</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><a href="#__codelineno-5-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="c1">// clang-format on</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><a href="#__codelineno-5-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="n">rotateLeft</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><a href="#__codelineno-5-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span><span class="n">rotateRight</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a><a href="#__codelineno-5-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><a href="#__codelineno-5-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><a href="#__codelineno-5-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><a href="#__codelineno-5-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">  </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><a href="#__codelineno-5-16"><span class="linenos" data-linenos="16 "></span></a><span class="p">}</span>
</code></pre></div> <h2 id="操作">操作<a class="headerlink" href="#操作" title="Permanent link"></a></h2> <h3 id="插入">插入<a class="headerlink" href="#插入" title="Permanent link"></a></h3> <p>SBT 的插入操作需要在完成普通二叉搜索树的插入操作的基础上递归地进行节点 <code>size</code> 字段的更新及平衡维护。示例代码如下：</p> <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-6-3" name="__codelineno-6-3"></a><a href="#__codelineno-6-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4"></a><a href="#__codelineno-6-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-6-5" name="__codelineno-6-5"></a><a href="#__codelineno-6-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-6-6" name="__codelineno-6-6"></a><a href="#__codelineno-6-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-7" name="__codelineno-6-7"></a><a href="#__codelineno-6-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">    </span><span class="n">insert</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="p">);</span>
<a id="__codelineno-6-8" name="__codelineno-6-8"></a><a href="#__codelineno-6-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-6-9" name="__codelineno-6-9"></a><a href="#__codelineno-6-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">    </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-6-10" name="__codelineno-6-10"></a><a href="#__codelineno-6-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-11" name="__codelineno-6-11"></a><a href="#__codelineno-6-11"><span class="linenos" data-linenos="11 "></span></a><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-12" name="__codelineno-6-12"></a><a href="#__codelineno-6-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-6-13" name="__codelineno-6-13"></a><a href="#__codelineno-6-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-14" name="__codelineno-6-14"></a><a href="#__codelineno-6-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-6-15" name="__codelineno-6-15"></a><a href="#__codelineno-6-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-6-16" name="__codelineno-6-16"></a><a href="#__codelineno-6-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-6-17" name="__codelineno-6-17"></a><a href="#__codelineno-6-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">    </span><span class="n">insert</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="p">);</span>
<a id="__codelineno-6-18" name="__codelineno-6-18"></a><a href="#__codelineno-6-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-6-19" name="__codelineno-6-19"></a><a href="#__codelineno-6-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">    </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-6-20" name="__codelineno-6-20"></a><a href="#__codelineno-6-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-6-21" name="__codelineno-6-21"></a><a href="#__codelineno-6-21"><span class="linenos" data-linenos="21 "></span></a><span class="p">}</span>
</code></pre></div> <h3 id="删除">删除<a class="headerlink" href="#删除" title="Permanent link"></a></h3> <p>根据 Size Balanced Tree 的提出者陈启峰在其论文中对于删除操作的描述：</p> <blockquote> <p>It can result in a destroyed SBT. But with the insertion above, a BST is still kept at the height of <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.112ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3585.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5460-TEX-I-1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path id="MJX-5460-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-5460-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-5460-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-5460-TEX-N-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path><path id="MJX-5460-TEX-N-2061" d=""></path><path id="MJX-5460-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-5460-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D442" xlink:href="#MJX-5460-TEX-I-1D442"></use></g><g data-mml-node="mo" transform="translate(763,0)"><use data-c="28" xlink:href="#MJX-5460-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1152,0)"><use data-c="6C" xlink:href="#MJX-5460-TEX-N-6C"></use><use data-c="6F" xlink:href="#MJX-5460-TEX-N-6F" transform="translate(278,0)"></use><use data-c="67" xlink:href="#MJX-5460-TEX-N-67" transform="translate(778,0)"></use></g><g data-mml-node="mo" transform="translate(2430,0)"><use data-c="2061" xlink:href="#MJX-5460-TEX-N-2061"></use></g><g data-mml-node="mi" transform="translate(2596.7,0)"><use data-c="1D45B" xlink:href="#MJX-5460-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(3196.7,0)"><use data-c="29" xlink:href="#MJX-5460-TEX-N-29"></use></g></g></g></svg></mjx-container></span> where <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5461-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45B" xlink:href="#MJX-5461-TEX-I-1D45B"></use></g></g></g></svg></mjx-container></span> is the total number of insertions, not the current size.</p> </blockquote> <p>删除操作虽然有可能使得 SBT 的性质被打破，但并不会使树的高度增高，因此不会影响后续操作的效率。但在实际情况下，如果在一次批量插入操作后只进行大量的删除和查询操作，依然有可能由于树的失衡影响整体效率，因此本文在实现 SBT 的删除操作时依然选择加入平衡维护。参考代码如下：</p> <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos="  1 "></span></a><span class="kt">bool</span><span class="w"> </span><span class="nf">remove</span><span class="p">(</span><span class="n">NodePtr</span><span class="o">&amp;</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">NodeConsumer</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><a href="#__codelineno-7-2"><span class="linenos" data-linenos="  2 "></span></a><span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><a href="#__codelineno-7-3"><span class="linenos" data-linenos="  3 "></span></a>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><a href="#__codelineno-7-4"><span class="linenos" data-linenos="  4 "></span></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><a href="#__codelineno-7-5"><span class="linenos" data-linenos="  5 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><a href="#__codelineno-7-6"><span class="linenos" data-linenos="  6 "></span></a><span class="w">      </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><a href="#__codelineno-7-7"><span class="linenos" data-linenos="  7 "></span></a><span class="w">      </span><span class="n">NodePtr</span><span class="o">&amp;</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><a href="#__codelineno-7-8"><span class="linenos" data-linenos="  8 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">remove</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><a href="#__codelineno-7-9"><span class="linenos" data-linenos="  9 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><a href="#__codelineno-7-10"><span class="linenos" data-linenos=" 10 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><a href="#__codelineno-7-11"><span class="linenos" data-linenos=" 11 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><a href="#__codelineno-7-12"><span class="linenos" data-linenos=" 12 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><a href="#__codelineno-7-13"><span class="linenos" data-linenos=" 13 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><a href="#__codelineno-7-14"><span class="linenos" data-linenos=" 14 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><a href="#__codelineno-7-15"><span class="linenos" data-linenos=" 15 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><a href="#__codelineno-7-16"><span class="linenos" data-linenos=" 16 "></span></a><span class="w">      </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><a href="#__codelineno-7-17"><span class="linenos" data-linenos=" 17 "></span></a><span class="w">      </span><span class="n">NodePtr</span><span class="o">&amp;</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><a href="#__codelineno-7-18"><span class="linenos" data-linenos=" 18 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">remove</span><span class="p">(</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><a href="#__codelineno-7-19"><span class="linenos" data-linenos=" 19 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><a href="#__codelineno-7-20"><span class="linenos" data-linenos=" 20 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a><a href="#__codelineno-7-21"><span class="linenos" data-linenos=" 21 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><a href="#__codelineno-7-22"><span class="linenos" data-linenos=" 22 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><a href="#__codelineno-7-23"><span class="linenos" data-linenos=" 23 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a><a href="#__codelineno-7-24"><span class="linenos" data-linenos=" 24 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a><a href="#__codelineno-7-25"><span class="linenos" data-linenos=" 25 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a><a href="#__codelineno-7-26"><span class="linenos" data-linenos=" 26 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-7-27" name="__codelineno-7-27"></a><a href="#__codelineno-7-27"><span class="linenos" data-linenos=" 27 "></span></a>
<a id="__codelineno-7-28" name="__codelineno-7-28"></a><a href="#__codelineno-7-28"><span class="linenos" data-linenos=" 28 "></span></a><span class="w">  </span><span class="n">assert</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-7-29" name="__codelineno-7-29"></a><a href="#__codelineno-7-29"><span class="linenos" data-linenos=" 29 "></span></a><span class="w">  </span><span class="n">action</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-7-30" name="__codelineno-7-30"></a><a href="#__codelineno-7-30"><span class="linenos" data-linenos=" 30 "></span></a>
<a id="__codelineno-7-31" name="__codelineno-7-31"></a><a href="#__codelineno-7-31"><span class="linenos" data-linenos=" 31 "></span></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-32" name="__codelineno-7-32"></a><a href="#__codelineno-7-32"><span class="linenos" data-linenos=" 32 "></span></a><span class="w">    </span><span class="c1">// Case 1: no child</span>
<a id="__codelineno-7-33" name="__codelineno-7-33"></a><a href="#__codelineno-7-33"><span class="linenos" data-linenos=" 33 "></span></a><span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<a id="__codelineno-7-34" name="__codelineno-7-34"></a><a href="#__codelineno-7-34"><span class="linenos" data-linenos=" 34 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-35" name="__codelineno-7-35"></a><a href="#__codelineno-7-35"><span class="linenos" data-linenos=" 35 "></span></a><span class="w">    </span><span class="c1">// Case 2: left child only</span>
<a id="__codelineno-7-36" name="__codelineno-7-36"></a><a href="#__codelineno-7-36"><span class="linenos" data-linenos=" 36 "></span></a><span class="w">    </span><span class="c1">// clang-format off</span>
<a id="__codelineno-7-37" name="__codelineno-7-37"></a><a href="#__codelineno-7-37"><span class="linenos" data-linenos=" 37 "></span></a><span class="w">    </span><span class="c1">//     P</span>
<a id="__codelineno-7-38" name="__codelineno-7-38"></a><a href="#__codelineno-7-38"><span class="linenos" data-linenos=" 38 "></span></a><span class="w">    </span><span class="c1">//     |  remove(N)  P</span>
<a id="__codelineno-7-39" name="__codelineno-7-39"></a><a href="#__codelineno-7-39"><span class="linenos" data-linenos=" 39 "></span></a><span class="w">    </span><span class="c1">//     N  ========&gt;  |</span>
<a id="__codelineno-7-40" name="__codelineno-7-40"></a><a href="#__codelineno-7-40"><span class="linenos" data-linenos=" 40 "></span></a><span class="w">    </span><span class="c1">//    /              L</span>
<a id="__codelineno-7-41" name="__codelineno-7-41"></a><a href="#__codelineno-7-41"><span class="linenos" data-linenos=" 41 "></span></a><span class="w">    </span><span class="c1">//   L</span>
<a id="__codelineno-7-42" name="__codelineno-7-42"></a><a href="#__codelineno-7-42"><span class="linenos" data-linenos=" 42 "></span></a><span class="w">    </span><span class="c1">// clang-format on</span>
<a id="__codelineno-7-43" name="__codelineno-7-43"></a><a href="#__codelineno-7-43"><span class="linenos" data-linenos=" 43 "></span></a><span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-7-44" name="__codelineno-7-44"></a><a href="#__codelineno-7-44"><span class="linenos" data-linenos=" 44 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-45" name="__codelineno-7-45"></a><a href="#__codelineno-7-45"><span class="linenos" data-linenos=" 45 "></span></a><span class="w">    </span><span class="c1">// Case 3: right child only</span>
<a id="__codelineno-7-46" name="__codelineno-7-46"></a><a href="#__codelineno-7-46"><span class="linenos" data-linenos=" 46 "></span></a><span class="w">    </span><span class="c1">// clang-format off</span>
<a id="__codelineno-7-47" name="__codelineno-7-47"></a><a href="#__codelineno-7-47"><span class="linenos" data-linenos=" 47 "></span></a><span class="w">    </span><span class="c1">//   P</span>
<a id="__codelineno-7-48" name="__codelineno-7-48"></a><a href="#__codelineno-7-48"><span class="linenos" data-linenos=" 48 "></span></a><span class="w">    </span><span class="c1">//   |    remove(N)  P</span>
<a id="__codelineno-7-49" name="__codelineno-7-49"></a><a href="#__codelineno-7-49"><span class="linenos" data-linenos=" 49 "></span></a><span class="w">    </span><span class="c1">//   N    ========&gt;  |</span>
<a id="__codelineno-7-50" name="__codelineno-7-50"></a><a href="#__codelineno-7-50"><span class="linenos" data-linenos=" 50 "></span></a><span class="w">    </span><span class="c1">//    \              R</span>
<a id="__codelineno-7-51" name="__codelineno-7-51"></a><a href="#__codelineno-7-51"><span class="linenos" data-linenos=" 51 "></span></a><span class="w">    </span><span class="c1">//     R</span>
<a id="__codelineno-7-52" name="__codelineno-7-52"></a><a href="#__codelineno-7-52"><span class="linenos" data-linenos=" 52 "></span></a><span class="w">    </span><span class="c1">// clang-format on</span>
<a id="__codelineno-7-53" name="__codelineno-7-53"></a><a href="#__codelineno-7-53"><span class="linenos" data-linenos=" 53 "></span></a><span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-7-54" name="__codelineno-7-54"></a><a href="#__codelineno-7-54"><span class="linenos" data-linenos=" 54 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-55" name="__codelineno-7-55"></a><a href="#__codelineno-7-55"><span class="linenos" data-linenos=" 55 "></span></a><span class="w">    </span><span class="c1">// Case 4: both left and right child, right child has no left child</span>
<a id="__codelineno-7-56" name="__codelineno-7-56"></a><a href="#__codelineno-7-56"><span class="linenos" data-linenos=" 56 "></span></a><span class="w">    </span><span class="c1">// clang-format off</span>
<a id="__codelineno-7-57" name="__codelineno-7-57"></a><a href="#__codelineno-7-57"><span class="linenos" data-linenos=" 57 "></span></a><span class="w">    </span><span class="c1">//    |                 |</span>
<a id="__codelineno-7-58" name="__codelineno-7-58"></a><a href="#__codelineno-7-58"><span class="linenos" data-linenos=" 58 "></span></a><span class="w">    </span><span class="c1">//    N    remove(N)    R</span>
<a id="__codelineno-7-59" name="__codelineno-7-59"></a><a href="#__codelineno-7-59"><span class="linenos" data-linenos=" 59 "></span></a><span class="w">    </span><span class="c1">//   / \   ========&gt;   /</span>
<a id="__codelineno-7-60" name="__codelineno-7-60"></a><a href="#__codelineno-7-60"><span class="linenos" data-linenos=" 60 "></span></a><span class="w">    </span><span class="c1">//  L   R             L</span>
<a id="__codelineno-7-61" name="__codelineno-7-61"></a><a href="#__codelineno-7-61"><span class="linenos" data-linenos=" 61 "></span></a><span class="w">    </span><span class="c1">// clang-format on</span>
<a id="__codelineno-7-62" name="__codelineno-7-62"></a><a href="#__codelineno-7-62"><span class="linenos" data-linenos=" 62 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-7-63" name="__codelineno-7-63"></a><a href="#__codelineno-7-63"><span class="linenos" data-linenos=" 63 "></span></a><span class="w">    </span><span class="n">swapNode</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-7-64" name="__codelineno-7-64"></a><a href="#__codelineno-7-64"><span class="linenos" data-linenos=" 64 "></span></a><span class="w">    </span><span class="n">right</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-7-65" name="__codelineno-7-65"></a><a href="#__codelineno-7-65"><span class="linenos" data-linenos=" 65 "></span></a><span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-7-66" name="__codelineno-7-66"></a><a href="#__codelineno-7-66"><span class="linenos" data-linenos=" 66 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-7-67" name="__codelineno-7-67"></a><a href="#__codelineno-7-67"><span class="linenos" data-linenos=" 67 "></span></a><span class="w">    </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-7-68" name="__codelineno-7-68"></a><a href="#__codelineno-7-68"><span class="linenos" data-linenos=" 68 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-69" name="__codelineno-7-69"></a><a href="#__codelineno-7-69"><span class="linenos" data-linenos=" 69 "></span></a><span class="w">    </span><span class="c1">// Case 5: both left and right child, right child is not a leaf</span>
<a id="__codelineno-7-70" name="__codelineno-7-70"></a><a href="#__codelineno-7-70"><span class="linenos" data-linenos=" 70 "></span></a><span class="w">    </span><span class="c1">// clang-format off</span>
<a id="__codelineno-7-71" name="__codelineno-7-71"></a><a href="#__codelineno-7-71"><span class="linenos" data-linenos=" 71 "></span></a><span class="w">    </span><span class="c1">//   Step 1. find the node N with the smallest key</span>
<a id="__codelineno-7-72" name="__codelineno-7-72"></a><a href="#__codelineno-7-72"><span class="linenos" data-linenos=" 72 "></span></a><span class="w">    </span><span class="c1">//           and its parent P on the right subtree</span>
<a id="__codelineno-7-73" name="__codelineno-7-73"></a><a href="#__codelineno-7-73"><span class="linenos" data-linenos=" 73 "></span></a><span class="w">    </span><span class="c1">//   Step 2. swap S and N</span>
<a id="__codelineno-7-74" name="__codelineno-7-74"></a><a href="#__codelineno-7-74"><span class="linenos" data-linenos=" 74 "></span></a><span class="w">    </span><span class="c1">//   Step 3. remove node N like Case 1 or Case 3</span>
<a id="__codelineno-7-75" name="__codelineno-7-75"></a><a href="#__codelineno-7-75"><span class="linenos" data-linenos=" 75 "></span></a><span class="w">    </span><span class="c1">//   Step 4. update size for all nodes on the path</span>
<a id="__codelineno-7-76" name="__codelineno-7-76"></a><a href="#__codelineno-7-76"><span class="linenos" data-linenos=" 76 "></span></a><span class="w">    </span><span class="c1">//           from S to P</span>
<a id="__codelineno-7-77" name="__codelineno-7-77"></a><a href="#__codelineno-7-77"><span class="linenos" data-linenos=" 77 "></span></a><span class="w">    </span><span class="c1">//     |                  |</span>
<a id="__codelineno-7-78" name="__codelineno-7-78"></a><a href="#__codelineno-7-78"><span class="linenos" data-linenos=" 78 "></span></a><span class="w">    </span><span class="c1">//     N                  S                 |</span>
<a id="__codelineno-7-79" name="__codelineno-7-79"></a><a href="#__codelineno-7-79"><span class="linenos" data-linenos=" 79 "></span></a><span class="w">    </span><span class="c1">//    / \                / \                S</span>
<a id="__codelineno-7-80" name="__codelineno-7-80"></a><a href="#__codelineno-7-80"><span class="linenos" data-linenos=" 80 "></span></a><span class="w">    </span><span class="c1">//   L  ..  swap(N, S)  L  ..  remove(N)   / \</span>
<a id="__codelineno-7-81" name="__codelineno-7-81"></a><a href="#__codelineno-7-81"><span class="linenos" data-linenos=" 81 "></span></a><span class="c1">    //       |  =========&gt;      |  ========&gt;  L  ..</span>
<a id="__codelineno-7-82" name="__codelineno-7-82"></a><a href="#__codelineno-7-82"><span class="linenos" data-linenos=" 82 "></span></a><span class="w">    </span><span class="c1">//       P                  P                 |</span>
<a id="__codelineno-7-83" name="__codelineno-7-83"></a><a href="#__codelineno-7-83"><span class="linenos" data-linenos=" 83 "></span></a><span class="w">    </span><span class="c1">//      / \                / \                P</span>
<a id="__codelineno-7-84" name="__codelineno-7-84"></a><a href="#__codelineno-7-84"><span class="linenos" data-linenos=" 84 "></span></a><span class="w">    </span><span class="c1">//     S  ..              N  ..              / \</span>
<a id="__codelineno-7-85" name="__codelineno-7-85"></a><a href="#__codelineno-7-85"><span class="linenos" data-linenos=" 85 "></span></a><span class="c1">    //      \                  \                R  ..</span>
<a id="__codelineno-7-86" name="__codelineno-7-86"></a><a href="#__codelineno-7-86"><span class="linenos" data-linenos=" 86 "></span></a><span class="w">    </span><span class="c1">//       R                  R</span>
<a id="__codelineno-7-87" name="__codelineno-7-87"></a><a href="#__codelineno-7-87"><span class="linenos" data-linenos=" 87 "></span></a><span class="w">    </span><span class="c1">//</span>
<a id="__codelineno-7-88" name="__codelineno-7-88"></a><a href="#__codelineno-7-88"><span class="linenos" data-linenos=" 88 "></span></a><span class="w">    </span><span class="c1">// clang-format on</span>
<a id="__codelineno-7-89" name="__codelineno-7-89"></a><a href="#__codelineno-7-89"><span class="linenos" data-linenos=" 89 "></span></a>
<a id="__codelineno-7-90" name="__codelineno-7-90"></a><a href="#__codelineno-7-90"><span class="linenos" data-linenos=" 90 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="n">NodePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
<a id="__codelineno-7-91" name="__codelineno-7-91"></a><a href="#__codelineno-7-91"><span class="linenos" data-linenos=" 91 "></span></a>
<a id="__codelineno-7-92" name="__codelineno-7-92"></a><a href="#__codelineno-7-92"><span class="linenos" data-linenos=" 92 "></span></a><span class="w">    </span><span class="c1">// Step 1</span>
<a id="__codelineno-7-93" name="__codelineno-7-93"></a><a href="#__codelineno-7-93"><span class="linenos" data-linenos=" 93 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-7-94" name="__codelineno-7-94"></a><a href="#__codelineno-7-94"><span class="linenos" data-linenos=" 94 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-7-95" name="__codelineno-7-95"></a><a href="#__codelineno-7-95"><span class="linenos" data-linenos=" 95 "></span></a><span class="w">    </span><span class="n">path</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-7-96" name="__codelineno-7-96"></a><a href="#__codelineno-7-96"><span class="linenos" data-linenos=" 96 "></span></a>
<a id="__codelineno-7-97" name="__codelineno-7-97"></a><a href="#__codelineno-7-97"><span class="linenos" data-linenos=" 97 "></span></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-98" name="__codelineno-7-98"></a><a href="#__codelineno-7-98"><span class="linenos" data-linenos=" 98 "></span></a><span class="w">      </span><span class="n">path</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">successor</span><span class="p">);</span>
<a id="__codelineno-7-99" name="__codelineno-7-99"></a><a href="#__codelineno-7-99"><span class="linenos" data-linenos=" 99 "></span></a><span class="w">      </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-7-100" name="__codelineno-7-100"></a><a href="#__codelineno-7-100"><span class="linenos" data-linenos="100 "></span></a><span class="w">      </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-7-101" name="__codelineno-7-101"></a><a href="#__codelineno-7-101"><span class="linenos" data-linenos="101 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-102" name="__codelineno-7-102"></a><a href="#__codelineno-7-102"><span class="linenos" data-linenos="102 "></span></a>
<a id="__codelineno-7-103" name="__codelineno-7-103"></a><a href="#__codelineno-7-103"><span class="linenos" data-linenos="103 "></span></a><span class="w">    </span><span class="c1">// Step 2</span>
<a id="__codelineno-7-104" name="__codelineno-7-104"></a><a href="#__codelineno-7-104"><span class="linenos" data-linenos="104 "></span></a><span class="w">    </span><span class="n">swapNode</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">successor</span><span class="p">);</span>
<a id="__codelineno-7-105" name="__codelineno-7-105"></a><a href="#__codelineno-7-105"><span class="linenos" data-linenos="105 "></span></a>
<a id="__codelineno-7-106" name="__codelineno-7-106"></a><a href="#__codelineno-7-106"><span class="linenos" data-linenos="106 "></span></a><span class="w">    </span><span class="c1">// Step 3</span>
<a id="__codelineno-7-107" name="__codelineno-7-107"></a><a href="#__codelineno-7-107"><span class="linenos" data-linenos="107 "></span></a><span class="w">    </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-7-108" name="__codelineno-7-108"></a><a href="#__codelineno-7-108"><span class="linenos" data-linenos="108 "></span></a><span class="w">    </span><span class="c1">// Restore node</span>
<a id="__codelineno-7-109" name="__codelineno-7-109"></a><a href="#__codelineno-7-109"><span class="linenos" data-linenos="109 "></span></a><span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-7-110" name="__codelineno-7-110"></a><a href="#__codelineno-7-110"><span class="linenos" data-linenos="110 "></span></a>
<a id="__codelineno-7-111" name="__codelineno-7-111"></a><a href="#__codelineno-7-111"><span class="linenos" data-linenos="111 "></span></a><span class="w">    </span><span class="c1">// Step 4</span>
<a id="__codelineno-7-112" name="__codelineno-7-112"></a><a href="#__codelineno-7-112"><span class="linenos" data-linenos="112 "></span></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">path</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-7-113" name="__codelineno-7-113"></a><a href="#__codelineno-7-113"><span class="linenos" data-linenos="113 "></span></a><span class="w">      </span><span class="n">path</span><span class="p">.</span><span class="n">top</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-7-114" name="__codelineno-7-114"></a><a href="#__codelineno-7-114"><span class="linenos" data-linenos="114 "></span></a><span class="w">      </span><span class="n">path</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-7-115" name="__codelineno-7-115"></a><a href="#__codelineno-7-115"><span class="linenos" data-linenos="115 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-7-116" name="__codelineno-7-116"></a><a href="#__codelineno-7-116"><span class="linenos" data-linenos="116 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-7-117" name="__codelineno-7-117"></a><a href="#__codelineno-7-117"><span class="linenos" data-linenos="117 "></span></a>
<a id="__codelineno-7-118" name="__codelineno-7-118"></a><a href="#__codelineno-7-118"><span class="linenos" data-linenos="118 "></span></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="__codelineno-7-119" name="__codelineno-7-119"></a><a href="#__codelineno-7-119"><span class="linenos" data-linenos="119 "></span></a><span class="p">}</span>
</code></pre></div> <p>值得注意的是，在上述代码的 Case 5 中使用后继节点 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5462-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D446" xlink:href="#MJX-5462-TEX-I-1D446"></use></g></g></g></svg></mjx-container></span>（也可以选择前驱节点）替换待删除节点 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5463-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-5463-TEX-I-1D441"></use></g></g></g></svg></mjx-container></span> 并删除替换后的 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5464-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-5464-TEX-I-1D441"></use></g></g></g></svg></mjx-container></span> 以后，需要更新替换前 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5465-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D446" xlink:href="#MJX-5465-TEX-I-1D446"></use></g></g></g></svg></mjx-container></span> 节点的父节点 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.699ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 751 683" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5466-TEX-I-1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D443" xlink:href="#MJX-5466-TEX-I-1D443"></use></g></g></g></svg></mjx-container></span> 到替换后的 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5467-TEX-I-1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D446" xlink:href="#MJX-5467-TEX-I-1D446"></use></g></g></g></svg></mjx-container></span> 节点这条路径（如代码中注释所示）上的所有节点的 <code>size</code> 字段。本文的实现选择使用栈依次记录路径上的节点，最后再按遍历的相反顺序出栈进行更新。</p> <h3 id="查询排名">查询排名<a class="headerlink" href="#查询排名" title="Permanent link"></a></h3> <p>由于 SBT 节点中储存了子树节点个数的信息，因此可以在 <span class="arithmatex_inline"><mjx-container class="MathJax" jax="SVG" display="false"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.112ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3585.7 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5468-TEX-I-1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z"></path><path id="MJX-5468-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-5468-TEX-N-6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path id="MJX-5468-TEX-N-6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z"></path><path id="MJX-5468-TEX-N-67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z"></path><path id="MJX-5468-TEX-N-2061" d=""></path><path id="MJX-5468-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-5468-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D442" xlink:href="#MJX-5468-TEX-I-1D442"></use></g><g data-mml-node="mo" transform="translate(763,0)"><use data-c="28" xlink:href="#MJX-5468-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1152,0)"><use data-c="6C" xlink:href="#MJX-5468-TEX-N-6C"></use><use data-c="6F" xlink:href="#MJX-5468-TEX-N-6F" transform="translate(278,0)"></use><use data-c="67" xlink:href="#MJX-5468-TEX-N-67" transform="translate(778,0)"></use></g><g data-mml-node="mo" transform="translate(2430,0)"><use data-c="2061" xlink:href="#MJX-5468-TEX-N-2061"></use></g><g data-mml-node="mi" transform="translate(2596.7,0)"><use data-c="1D45B" xlink:href="#MJX-5468-TEX-I-1D45B"></use></g><g data-mml-node="mo" transform="translate(3196.7,0)"><use data-c="29" xlink:href="#MJX-5468-TEX-N-29"></use></g></g></g></svg></mjx-container></span> 的时间复杂度下查询某个 <code>key</code> 的排名（或者大于/小于某个 <code>key</code> 的节点个数）。示例代码如下：</p> <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="n">USize</span><span class="w"> </span><span class="nf">countLess</span><span class="p">(</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">countEqual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><a href="#__codelineno-8-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-3" name="__codelineno-8-3"></a><a href="#__codelineno-8-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-8-4" name="__codelineno-8-4"></a><a href="#__codelineno-8-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-5" name="__codelineno-8-5"></a><a href="#__codelineno-8-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">countLess</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-8-6" name="__codelineno-8-6"></a><a href="#__codelineno-8-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-7" name="__codelineno-8-7"></a><a href="#__codelineno-8-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">countLess</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-8-8" name="__codelineno-8-8"></a><a href="#__codelineno-8-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-9" name="__codelineno-8-9"></a><a href="#__codelineno-8-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">countEqual</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-8-10" name="__codelineno-8-10"></a><a href="#__codelineno-8-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-8-11" name="__codelineno-8-11"></a><a href="#__codelineno-8-11"><span class="linenos" data-linenos="11 "></span></a><span class="p">}</span>
<a id="__codelineno-8-12" name="__codelineno-8-12"></a><a href="#__codelineno-8-12"><span class="linenos" data-linenos="12 "></span></a>
<a id="__codelineno-8-13" name="__codelineno-8-13"></a><a href="#__codelineno-8-13"><span class="linenos" data-linenos="13 "></span></a><span class="n">USize</span><span class="w"> </span><span class="nf">countGreater</span><span class="p">(</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">countEqual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-14" name="__codelineno-8-14"></a><a href="#__codelineno-8-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-15" name="__codelineno-8-15"></a><a href="#__codelineno-8-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-8-16" name="__codelineno-8-16"></a><a href="#__codelineno-8-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-17" name="__codelineno-8-17"></a><a href="#__codelineno-8-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">countGreater</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-8-18" name="__codelineno-8-18"></a><a href="#__codelineno-8-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-19" name="__codelineno-8-19"></a><a href="#__codelineno-8-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">countGreater</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-8-20" name="__codelineno-8-20"></a><a href="#__codelineno-8-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-8-21" name="__codelineno-8-21"></a><a href="#__codelineno-8-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">countEqual</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-8-22" name="__codelineno-8-22"></a><a href="#__codelineno-8-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-8-23" name="__codelineno-8-23"></a><a href="#__codelineno-8-23"><span class="linenos" data-linenos="23 "></span></a><span class="p">}</span>
</code></pre></div> <h2 id="参考代码">参考代码<a class="headerlink" href="#参考代码" title="Permanent link"></a></h2> <p>下面的代码是用 SBT 实现的 <code>Map</code>，即有序不可重映射：</p> <details class="note"> <summary>完整代码</summary> <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="  1 "></span></a><span class="cm">/**</span>
<a id="__codelineno-9-2" name="__codelineno-9-2"></a><a href="#__codelineno-9-2"><span class="linenos" data-linenos="  2 "></span></a><span class="cm"> * @file SizeBalancedTreeMap.hpp</span>
<a id="__codelineno-9-3" name="__codelineno-9-3"></a><a href="#__codelineno-9-3"><span class="linenos" data-linenos="  3 "></span></a><span class="cm"> * @brief An SizeBalancedTree-based map implementation</span>
<a id="__codelineno-9-4" name="__codelineno-9-4"></a><a href="#__codelineno-9-4"><span class="linenos" data-linenos="  4 "></span></a><span class="cm"> * @details The map is sorted according to the natural ordering of its</span>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a><a href="#__codelineno-9-5"><span class="linenos" data-linenos="  5 "></span></a><span class="cm"> *  keys or by a {@code Compare} function provided; This implementation</span>
<a id="__codelineno-9-6" name="__codelineno-9-6"></a><a href="#__codelineno-9-6"><span class="linenos" data-linenos="  6 "></span></a><span class="cm"> *  provides guaranteed log(n) time cost for the contains, get, insert</span>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a><a href="#__codelineno-9-7"><span class="linenos" data-linenos="  7 "></span></a><span class="cm"> *  and remove operations.</span>
<a id="__codelineno-9-8" name="__codelineno-9-8"></a><a href="#__codelineno-9-8"><span class="linenos" data-linenos="  8 "></span></a><span class="cm"> * @author [r.ivance](https://github.com/RIvance)</span>
<a id="__codelineno-9-9" name="__codelineno-9-9"></a><a href="#__codelineno-9-9"><span class="linenos" data-linenos="  9 "></span></a><span class="cm"> */</span>
<a id="__codelineno-9-10" name="__codelineno-9-10"></a><a href="#__codelineno-9-10"><span class="linenos" data-linenos=" 10 "></span></a>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a><a href="#__codelineno-9-11"><span class="linenos" data-linenos=" 11 "></span></a><span class="cp">#ifndef SIZE_BALANCED_TREE_MAP_HPP</span>
<a id="__codelineno-9-12" name="__codelineno-9-12"></a><a href="#__codelineno-9-12"><span class="linenos" data-linenos=" 12 "></span></a><span class="cp">#define SIZE_BALANCED_TREE_MAP_HPP</span>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a><a href="#__codelineno-9-13"><span class="linenos" data-linenos=" 13 "></span></a>
<a id="__codelineno-9-14" name="__codelineno-9-14"></a><a href="#__codelineno-9-14"><span class="linenos" data-linenos=" 14 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cassert&gt;</span>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a><a href="#__codelineno-9-15"><span class="linenos" data-linenos=" 15 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstddef&gt;</span>
<a id="__codelineno-9-16" name="__codelineno-9-16"></a><a href="#__codelineno-9-16"><span class="linenos" data-linenos=" 16 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdint&gt;</span>
<a id="__codelineno-9-17" name="__codelineno-9-17"></a><a href="#__codelineno-9-17"><span class="linenos" data-linenos=" 17 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;functional&gt;</span>
<a id="__codelineno-9-18" name="__codelineno-9-18"></a><a href="#__codelineno-9-18"><span class="linenos" data-linenos=" 18 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span>
<a id="__codelineno-9-19" name="__codelineno-9-19"></a><a href="#__codelineno-9-19"><span class="linenos" data-linenos=" 19 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stack&gt;</span>
<a id="__codelineno-9-20" name="__codelineno-9-20"></a><a href="#__codelineno-9-20"><span class="linenos" data-linenos=" 20 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;utility&gt;</span>
<a id="__codelineno-9-21" name="__codelineno-9-21"></a><a href="#__codelineno-9-21"><span class="linenos" data-linenos=" 21 "></span></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
<a id="__codelineno-9-22" name="__codelineno-9-22"></a><a href="#__codelineno-9-22"><span class="linenos" data-linenos=" 22 "></span></a>
<a id="__codelineno-9-23" name="__codelineno-9-23"></a><a href="#__codelineno-9-23"><span class="linenos" data-linenos=" 23 "></span></a><span class="cm">/**</span>
<a id="__codelineno-9-24" name="__codelineno-9-24"></a><a href="#__codelineno-9-24"><span class="linenos" data-linenos=" 24 "></span></a><span class="cm"> * An SizeBalancedTree-based map implementation</span>
<a id="__codelineno-9-25" name="__codelineno-9-25"></a><a href="#__codelineno-9-25"><span class="linenos" data-linenos=" 25 "></span></a><span class="cm"> * http://wcipeg.com/wiki/Size_Balanced_Tree</span>
<a id="__codelineno-9-26" name="__codelineno-9-26"></a><a href="#__codelineno-9-26"><span class="linenos" data-linenos=" 26 "></span></a><span class="cm"> * @tparam Key the type of keys maintained by this map</span>
<a id="__codelineno-9-27" name="__codelineno-9-27"></a><a href="#__codelineno-9-27"><span class="linenos" data-linenos=" 27 "></span></a><span class="cm"> * @tparam Value the type of mapped values</span>
<a id="__codelineno-9-28" name="__codelineno-9-28"></a><a href="#__codelineno-9-28"><span class="linenos" data-linenos=" 28 "></span></a><span class="cm"> * @tparam Compare the compare function</span>
<a id="__codelineno-9-29" name="__codelineno-9-29"></a><a href="#__codelineno-9-29"><span class="linenos" data-linenos=" 29 "></span></a><span class="cm"> */</span>
<a id="__codelineno-9-30" name="__codelineno-9-30"></a><a href="#__codelineno-9-30"><span class="linenos" data-linenos=" 30 "></span></a><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Key</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Value</span><span class="p">,</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Compare</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">less</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span>
<a id="__codelineno-9-31" name="__codelineno-9-31"></a><a href="#__codelineno-9-31"><span class="linenos" data-linenos=" 31 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">SizeBalancedTreeMap</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-32" name="__codelineno-9-32"></a><a href="#__codelineno-9-32"><span class="linenos" data-linenos=" 32 "></span></a><span class="w"> </span><span class="k">private</span><span class="o">:</span>
<a id="__codelineno-9-33" name="__codelineno-9-33"></a><a href="#__codelineno-9-33"><span class="linenos" data-linenos=" 33 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">USize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">size_t</span><span class="p">;</span>
<a id="__codelineno-9-34" name="__codelineno-9-34"></a><a href="#__codelineno-9-34"><span class="linenos" data-linenos=" 34 "></span></a>
<a id="__codelineno-9-35" name="__codelineno-9-35"></a><a href="#__codelineno-9-35"><span class="linenos" data-linenos=" 35 "></span></a><span class="w">  </span><span class="n">Compare</span><span class="w"> </span><span class="n">compare</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Compare</span><span class="p">();</span>
<a id="__codelineno-9-36" name="__codelineno-9-36"></a><a href="#__codelineno-9-36"><span class="linenos" data-linenos=" 36 "></span></a>
<a id="__codelineno-9-37" name="__codelineno-9-37"></a><a href="#__codelineno-9-37"><span class="linenos" data-linenos=" 37 "></span></a><span class="w"> </span><span class="k">public</span><span class="o">:</span>
<a id="__codelineno-9-38" name="__codelineno-9-38"></a><a href="#__codelineno-9-38"><span class="linenos" data-linenos=" 38 "></span></a><span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">Entry</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-39" name="__codelineno-9-39"></a><a href="#__codelineno-9-39"><span class="linenos" data-linenos=" 39 "></span></a><span class="w">    </span><span class="n">Key</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-9-40" name="__codelineno-9-40"></a><a href="#__codelineno-9-40"><span class="linenos" data-linenos=" 40 "></span></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-41" name="__codelineno-9-41"></a><a href="#__codelineno-9-41"><span class="linenos" data-linenos=" 41 "></span></a>
<a id="__codelineno-9-42" name="__codelineno-9-42"></a><a href="#__codelineno-9-42"><span class="linenos" data-linenos=" 42 "></span></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">==</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Entry</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-43" name="__codelineno-9-43"></a><a href="#__codelineno-9-43"><span class="linenos" data-linenos=" 43 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rhs</span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rhs</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-44" name="__codelineno-9-44"></a><a href="#__codelineno-9-44"><span class="linenos" data-linenos=" 44 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-45" name="__codelineno-9-45"></a><a href="#__codelineno-9-45"><span class="linenos" data-linenos=" 45 "></span></a>
<a id="__codelineno-9-46" name="__codelineno-9-46"></a><a href="#__codelineno-9-46"><span class="linenos" data-linenos=" 46 "></span></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="k">operator</span><span class="o">!=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Entry</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-47" name="__codelineno-9-47"></a><a href="#__codelineno-9-47"><span class="linenos" data-linenos=" 47 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">rhs</span><span class="p">.</span><span class="n">key</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">value</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">rhs</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-48" name="__codelineno-9-48"></a><a href="#__codelineno-9-48"><span class="linenos" data-linenos=" 48 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-49" name="__codelineno-9-49"></a><a href="#__codelineno-9-49"><span class="linenos" data-linenos=" 49 "></span></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-9-50" name="__codelineno-9-50"></a><a href="#__codelineno-9-50"><span class="linenos" data-linenos=" 50 "></span></a>
<a id="__codelineno-9-51" name="__codelineno-9-51"></a><a href="#__codelineno-9-51"><span class="linenos" data-linenos=" 51 "></span></a><span class="w"> </span><span class="k">private</span><span class="o">:</span>
<a id="__codelineno-9-52" name="__codelineno-9-52"></a><a href="#__codelineno-9-52"><span class="linenos" data-linenos=" 52 "></span></a><span class="w">  </span><span class="k">struct</span><span class="w"> </span><span class="nc">Node</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-53" name="__codelineno-9-53"></a><a href="#__codelineno-9-53"><span class="linenos" data-linenos=" 53 "></span></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">Ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">;</span>
<a id="__codelineno-9-54" name="__codelineno-9-54"></a><a href="#__codelineno-9-54"><span class="linenos" data-linenos=" 54 "></span></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">Provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">Ptr</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-55" name="__codelineno-9-55"></a><a href="#__codelineno-9-55"><span class="linenos" data-linenos=" 55 "></span></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="n">Consumer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Ptr</span><span class="w"> </span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-56" name="__codelineno-9-56"></a><a href="#__codelineno-9-56"><span class="linenos" data-linenos=" 56 "></span></a>
<a id="__codelineno-9-57" name="__codelineno-9-57"></a><a href="#__codelineno-9-57"><span class="linenos" data-linenos=" 57 "></span></a><span class="w">    </span><span class="n">Key</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
<a id="__codelineno-9-58" name="__codelineno-9-58"></a><a href="#__codelineno-9-58"><span class="linenos" data-linenos=" 58 "></span></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="n">value</span><span class="p">{};</span>
<a id="__codelineno-9-59" name="__codelineno-9-59"></a><a href="#__codelineno-9-59"><span class="linenos" data-linenos=" 59 "></span></a>
<a id="__codelineno-9-60" name="__codelineno-9-60"></a><a href="#__codelineno-9-60"><span class="linenos" data-linenos=" 60 "></span></a><span class="w">    </span><span class="n">Ptr</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<a id="__codelineno-9-61" name="__codelineno-9-61"></a><a href="#__codelineno-9-61"><span class="linenos" data-linenos=" 61 "></span></a><span class="w">    </span><span class="n">Ptr</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<a id="__codelineno-9-62" name="__codelineno-9-62"></a><a href="#__codelineno-9-62"><span class="linenos" data-linenos=" 62 "></span></a>
<a id="__codelineno-9-63" name="__codelineno-9-63"></a><a href="#__codelineno-9-63"><span class="linenos" data-linenos=" 63 "></span></a><span class="w">    </span><span class="n">USize</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-9-64" name="__codelineno-9-64"></a><a href="#__codelineno-9-64"><span class="linenos" data-linenos=" 64 "></span></a>
<a id="__codelineno-9-65" name="__codelineno-9-65"></a><a href="#__codelineno-9-65"><span class="linenos" data-linenos=" 65 "></span></a><span class="w">    </span><span class="k">explicit</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="n">Key</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-9-66" name="__codelineno-9-66"></a><a href="#__codelineno-9-66"><span class="linenos" data-linenos=" 66 "></span></a>
<a id="__codelineno-9-67" name="__codelineno-9-67"></a><a href="#__codelineno-9-67"><span class="linenos" data-linenos=" 67 "></span></a><span class="w">    </span><span class="k">explicit</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="n">Key</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">key</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">k</span><span class="p">)),</span><span class="w"> </span><span class="n">value</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-9-68" name="__codelineno-9-68"></a><a href="#__codelineno-9-68"><span class="linenos" data-linenos=" 68 "></span></a>
<a id="__codelineno-9-69" name="__codelineno-9-69"></a><a href="#__codelineno-9-69"><span class="linenos" data-linenos=" 69 "></span></a><span class="w">    </span><span class="o">~</span><span class="n">Node</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<a id="__codelineno-9-70" name="__codelineno-9-70"></a><a href="#__codelineno-9-70"><span class="linenos" data-linenos=" 70 "></span></a>
<a id="__codelineno-9-71" name="__codelineno-9-71"></a><a href="#__codelineno-9-71"><span class="linenos" data-linenos=" 71 "></span></a><span class="w">    </span><span class="kr">inline</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">isLeaf</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-72" name="__codelineno-9-72"></a><a href="#__codelineno-9-72"><span class="linenos" data-linenos=" 72 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<a id="__codelineno-9-73" name="__codelineno-9-73"></a><a href="#__codelineno-9-73"><span class="linenos" data-linenos=" 73 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-74" name="__codelineno-9-74"></a><a href="#__codelineno-9-74"><span class="linenos" data-linenos=" 74 "></span></a>
<a id="__codelineno-9-75" name="__codelineno-9-75"></a><a href="#__codelineno-9-75"><span class="linenos" data-linenos=" 75 "></span></a><span class="w">    </span><span class="kr">inline</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateSize</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-76" name="__codelineno-9-76"></a><a href="#__codelineno-9-76"><span class="linenos" data-linenos=" 76 "></span></a><span class="w">      </span><span class="n">USize</span><span class="w"> </span><span class="n">leftSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-9-77" name="__codelineno-9-77"></a><a href="#__codelineno-9-77"><span class="linenos" data-linenos=" 77 "></span></a><span class="w">      </span><span class="n">USize</span><span class="w"> </span><span class="n">rightSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-9-78" name="__codelineno-9-78"></a><a href="#__codelineno-9-78"><span class="linenos" data-linenos=" 78 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">leftSize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rightSize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<a id="__codelineno-9-79" name="__codelineno-9-79"></a><a href="#__codelineno-9-79"><span class="linenos" data-linenos=" 79 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-80" name="__codelineno-9-80"></a><a href="#__codelineno-9-80"><span class="linenos" data-linenos=" 80 "></span></a>
<a id="__codelineno-9-81" name="__codelineno-9-81"></a><a href="#__codelineno-9-81"><span class="linenos" data-linenos=" 81 "></span></a><span class="w">    </span><span class="kr">inline</span><span class="w"> </span><span class="n">Entry</span><span class="w"> </span><span class="nf">entry</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Entry</span><span class="p">{</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">};</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-82" name="__codelineno-9-82"></a><a href="#__codelineno-9-82"><span class="linenos" data-linenos=" 82 "></span></a>
<a id="__codelineno-9-83" name="__codelineno-9-83"></a><a href="#__codelineno-9-83"><span class="linenos" data-linenos=" 83 "></span></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">Ptr</span><span class="w"> </span><span class="nf">from</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">&amp;</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">k</span><span class="p">));</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-84" name="__codelineno-9-84"></a><a href="#__codelineno-9-84"><span class="linenos" data-linenos=" 84 "></span></a>
<a id="__codelineno-9-85" name="__codelineno-9-85"></a><a href="#__codelineno-9-85"><span class="linenos" data-linenos=" 85 "></span></a><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">Ptr</span><span class="w"> </span><span class="nf">from</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">&amp;</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="o">&amp;</span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-86" name="__codelineno-9-86"></a><a href="#__codelineno-9-86"><span class="linenos" data-linenos=" 86 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span><span class="p">(</span><span class="n">Node</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">));</span>
<a id="__codelineno-9-87" name="__codelineno-9-87"></a><a href="#__codelineno-9-87"><span class="linenos" data-linenos=" 87 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-88" name="__codelineno-9-88"></a><a href="#__codelineno-9-88"><span class="linenos" data-linenos=" 88 "></span></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-9-89" name="__codelineno-9-89"></a><a href="#__codelineno-9-89"><span class="linenos" data-linenos=" 89 "></span></a>
<a id="__codelineno-9-90" name="__codelineno-9-90"></a><a href="#__codelineno-9-90"><span class="linenos" data-linenos=" 90 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">NodePtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Node</span><span class="o">::</span><span class="n">Ptr</span><span class="p">;</span>
<a id="__codelineno-9-91" name="__codelineno-9-91"></a><a href="#__codelineno-9-91"><span class="linenos" data-linenos=" 91 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-92" name="__codelineno-9-92"></a><a href="#__codelineno-9-92"><span class="linenos" data-linenos=" 92 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">NodeProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Node</span><span class="o">::</span><span class="n">Provider</span><span class="p">;</span>
<a id="__codelineno-9-93" name="__codelineno-9-93"></a><a href="#__codelineno-9-93"><span class="linenos" data-linenos=" 93 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">NodeConsumer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">typename</span><span class="w"> </span><span class="nc">Node</span><span class="o">::</span><span class="n">Consumer</span><span class="p">;</span>
<a id="__codelineno-9-94" name="__codelineno-9-94"></a><a href="#__codelineno-9-94"><span class="linenos" data-linenos=" 94 "></span></a>
<a id="__codelineno-9-95" name="__codelineno-9-95"></a><a href="#__codelineno-9-95"><span class="linenos" data-linenos=" 95 "></span></a><span class="w">  </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<a id="__codelineno-9-96" name="__codelineno-9-96"></a><a href="#__codelineno-9-96"><span class="linenos" data-linenos=" 96 "></span></a>
<a id="__codelineno-9-97" name="__codelineno-9-97"></a><a href="#__codelineno-9-97"><span class="linenos" data-linenos=" 97 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-98" name="__codelineno-9-98"></a><a href="#__codelineno-9-98"><span class="linenos" data-linenos=" 98 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-99" name="__codelineno-9-99"></a><a href="#__codelineno-9-99"><span class="linenos" data-linenos=" 99 "></span></a>
<a id="__codelineno-9-100" name="__codelineno-9-100"></a><a href="#__codelineno-9-100"><span class="linenos" data-linenos="100 "></span></a><span class="w"> </span><span class="k">public</span><span class="o">:</span>
<a id="__codelineno-9-101" name="__codelineno-9-101"></a><a href="#__codelineno-9-101"><span class="linenos" data-linenos="101 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">EntryList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Entry</span><span class="o">&gt;</span><span class="p">;</span>
<a id="__codelineno-9-102" name="__codelineno-9-102"></a><a href="#__codelineno-9-102"><span class="linenos" data-linenos="102 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">KeyValueConsumer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-103" name="__codelineno-9-103"></a><a href="#__codelineno-9-103"><span class="linenos" data-linenos="103 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">MutKeyValueConsumer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">void</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="o">&amp;</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-104" name="__codelineno-9-104"></a><a href="#__codelineno-9-104"><span class="linenos" data-linenos="104 "></span></a><span class="w">  </span><span class="k">using</span><span class="w"> </span><span class="n">KeyValueFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="p">;</span>
<a id="__codelineno-9-105" name="__codelineno-9-105"></a><a href="#__codelineno-9-105"><span class="linenos" data-linenos="105 "></span></a>
<a id="__codelineno-9-106" name="__codelineno-9-106"></a><a href="#__codelineno-9-106"><span class="linenos" data-linenos="106 "></span></a><span class="w">  </span><span class="k">class</span><span class="w"> </span><span class="nc">NoSuchMappingException</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">protected</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-107" name="__codelineno-9-107"></a><a href="#__codelineno-9-107"><span class="linenos" data-linenos="107 "></span></a><span class="w">   </span><span class="k">private</span><span class="o">:</span>
<a id="__codelineno-9-108" name="__codelineno-9-108"></a><a href="#__codelineno-9-108"><span class="linenos" data-linenos="108 "></span></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">message</span><span class="p">;</span>
<a id="__codelineno-9-109" name="__codelineno-9-109"></a><a href="#__codelineno-9-109"><span class="linenos" data-linenos="109 "></span></a>
<a id="__codelineno-9-110" name="__codelineno-9-110"></a><a href="#__codelineno-9-110"><span class="linenos" data-linenos="110 "></span></a><span class="w">   </span><span class="k">public</span><span class="o">:</span>
<a id="__codelineno-9-111" name="__codelineno-9-111"></a><a href="#__codelineno-9-111"><span class="linenos" data-linenos="111 "></span></a><span class="w">    </span><span class="k">explicit</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<a id="__codelineno-9-112" name="__codelineno-9-112"></a><a href="#__codelineno-9-112"><span class="linenos" data-linenos="112 "></span></a>
<a id="__codelineno-9-113" name="__codelineno-9-113"></a><a href="#__codelineno-9-113"><span class="linenos" data-linenos="113 "></span></a><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">message</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-114" name="__codelineno-9-114"></a><a href="#__codelineno-9-114"><span class="linenos" data-linenos="114 "></span></a><span class="w">  </span><span class="p">};</span>
<a id="__codelineno-9-115" name="__codelineno-9-115"></a><a href="#__codelineno-9-115"><span class="linenos" data-linenos="115 "></span></a>
<a id="__codelineno-9-116" name="__codelineno-9-116"></a><a href="#__codelineno-9-116"><span class="linenos" data-linenos="116 "></span></a><span class="w">  </span><span class="n">SizeBalancedTreeMap</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
<a id="__codelineno-9-117" name="__codelineno-9-117"></a><a href="#__codelineno-9-117"><span class="linenos" data-linenos="117 "></span></a>
<a id="__codelineno-9-118" name="__codelineno-9-118"></a><a href="#__codelineno-9-118"><span class="linenos" data-linenos="118 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-119" name="__codelineno-9-119"></a><a href="#__codelineno-9-119"><span class="linenos" data-linenos="119 "></span></a><span class="cm">   * Returns the number of entries in this map.</span>
<a id="__codelineno-9-120" name="__codelineno-9-120"></a><a href="#__codelineno-9-120"><span class="linenos" data-linenos="120 "></span></a><span class="cm">   * @return size_t</span>
<a id="__codelineno-9-121" name="__codelineno-9-121"></a><a href="#__codelineno-9-121"><span class="linenos" data-linenos="121 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-122" name="__codelineno-9-122"></a><a href="#__codelineno-9-122"><span class="linenos" data-linenos="122 "></span></a><span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="n">USize</span><span class="w"> </span><span class="nf">size</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-123" name="__codelineno-9-123"></a><a href="#__codelineno-9-123"><span class="linenos" data-linenos="123 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-124" name="__codelineno-9-124"></a><a href="#__codelineno-9-124"><span class="linenos" data-linenos="124 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">;</span>
<a id="__codelineno-9-125" name="__codelineno-9-125"></a><a href="#__codelineno-9-125"><span class="linenos" data-linenos="125 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-126" name="__codelineno-9-126"></a><a href="#__codelineno-9-126"><span class="linenos" data-linenos="126 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-9-127" name="__codelineno-9-127"></a><a href="#__codelineno-9-127"><span class="linenos" data-linenos="127 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-128" name="__codelineno-9-128"></a><a href="#__codelineno-9-128"><span class="linenos" data-linenos="128 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-129" name="__codelineno-9-129"></a><a href="#__codelineno-9-129"><span class="linenos" data-linenos="129 "></span></a>
<a id="__codelineno-9-130" name="__codelineno-9-130"></a><a href="#__codelineno-9-130"><span class="linenos" data-linenos="130 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-131" name="__codelineno-9-131"></a><a href="#__codelineno-9-131"><span class="linenos" data-linenos="131 "></span></a><span class="cm">   * Returns true if this collection contains no elements.</span>
<a id="__codelineno-9-132" name="__codelineno-9-132"></a><a href="#__codelineno-9-132"><span class="linenos" data-linenos="132 "></span></a><span class="cm">   * @return bool</span>
<a id="__codelineno-9-133" name="__codelineno-9-133"></a><a href="#__codelineno-9-133"><span class="linenos" data-linenos="133 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-134" name="__codelineno-9-134"></a><a href="#__codelineno-9-134"><span class="linenos" data-linenos="134 "></span></a><span class="w">  </span><span class="kr">inline</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">empty</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-135" name="__codelineno-9-135"></a><a href="#__codelineno-9-135"><span class="linenos" data-linenos="135 "></span></a>
<a id="__codelineno-9-136" name="__codelineno-9-136"></a><a href="#__codelineno-9-136"><span class="linenos" data-linenos="136 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-137" name="__codelineno-9-137"></a><a href="#__codelineno-9-137"><span class="linenos" data-linenos="137 "></span></a><span class="cm">   * Removes all of the elements from this map.</span>
<a id="__codelineno-9-138" name="__codelineno-9-138"></a><a href="#__codelineno-9-138"><span class="linenos" data-linenos="138 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-139" name="__codelineno-9-139"></a><a href="#__codelineno-9-139"><span class="linenos" data-linenos="139 "></span></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">clear</span><span class="p">()</span><span class="w"> </span><span class="k">noexcept</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-140" name="__codelineno-9-140"></a><a href="#__codelineno-9-140"><span class="linenos" data-linenos="140 "></span></a>
<a id="__codelineno-9-141" name="__codelineno-9-141"></a><a href="#__codelineno-9-141"><span class="linenos" data-linenos="141 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-142" name="__codelineno-9-142"></a><a href="#__codelineno-9-142"><span class="linenos" data-linenos="142 "></span></a><span class="cm">   * Returns the value to which the specified key is mapped; If this map</span>
<a id="__codelineno-9-143" name="__codelineno-9-143"></a><a href="#__codelineno-9-143"><span class="linenos" data-linenos="143 "></span></a><span class="cm">   * contains no mapping for the key, a {@code NoSuchMappingException} will</span>
<a id="__codelineno-9-144" name="__codelineno-9-144"></a><a href="#__codelineno-9-144"><span class="linenos" data-linenos="144 "></span></a><span class="cm">   * be thrown.</span>
<a id="__codelineno-9-145" name="__codelineno-9-145"></a><a href="#__codelineno-9-145"><span class="linenos" data-linenos="145 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-146" name="__codelineno-9-146"></a><a href="#__codelineno-9-146"><span class="linenos" data-linenos="146 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Value</span>
<a id="__codelineno-9-147" name="__codelineno-9-147"></a><a href="#__codelineno-9-147"><span class="linenos" data-linenos="147 "></span></a><span class="cm">   * @throws NoSuchMappingException</span>
<a id="__codelineno-9-148" name="__codelineno-9-148"></a><a href="#__codelineno-9-148"><span class="linenos" data-linenos="148 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-149" name="__codelineno-9-149"></a><a href="#__codelineno-9-149"><span class="linenos" data-linenos="149 "></span></a><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-150" name="__codelineno-9-150"></a><a href="#__codelineno-9-150"><span class="linenos" data-linenos="150 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-151" name="__codelineno-9-151"></a><a href="#__codelineno-9-151"><span class="linenos" data-linenos="151 "></span></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"Invalid key"</span><span class="p">);</span>
<a id="__codelineno-9-152" name="__codelineno-9-152"></a><a href="#__codelineno-9-152"><span class="linenos" data-linenos="152 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-153" name="__codelineno-9-153"></a><a href="#__codelineno-9-153"><span class="linenos" data-linenos="153 "></span></a><span class="w">      </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getNode</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-154" name="__codelineno-9-154"></a><a href="#__codelineno-9-154"><span class="linenos" data-linenos="154 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-155" name="__codelineno-9-155"></a><a href="#__codelineno-9-155"><span class="linenos" data-linenos="155 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-156" name="__codelineno-9-156"></a><a href="#__codelineno-9-156"><span class="linenos" data-linenos="156 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-157" name="__codelineno-9-157"></a><a href="#__codelineno-9-157"><span class="linenos" data-linenos="157 "></span></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"Invalid key"</span><span class="p">);</span>
<a id="__codelineno-9-158" name="__codelineno-9-158"></a><a href="#__codelineno-9-158"><span class="linenos" data-linenos="158 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-159" name="__codelineno-9-159"></a><a href="#__codelineno-9-159"><span class="linenos" data-linenos="159 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-160" name="__codelineno-9-160"></a><a href="#__codelineno-9-160"><span class="linenos" data-linenos="160 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-161" name="__codelineno-9-161"></a><a href="#__codelineno-9-161"><span class="linenos" data-linenos="161 "></span></a>
<a id="__codelineno-9-162" name="__codelineno-9-162"></a><a href="#__codelineno-9-162"><span class="linenos" data-linenos="162 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-163" name="__codelineno-9-163"></a><a href="#__codelineno-9-163"><span class="linenos" data-linenos="163 "></span></a><span class="cm">   * Returns the value to which the specified key is mapped; If this map</span>
<a id="__codelineno-9-164" name="__codelineno-9-164"></a><a href="#__codelineno-9-164"><span class="linenos" data-linenos="164 "></span></a><span class="cm">   * contains no mapping for the key, a new mapping with a default value</span>
<a id="__codelineno-9-165" name="__codelineno-9-165"></a><a href="#__codelineno-9-165"><span class="linenos" data-linenos="165 "></span></a><span class="cm">   * will be inserted.</span>
<a id="__codelineno-9-166" name="__codelineno-9-166"></a><a href="#__codelineno-9-166"><span class="linenos" data-linenos="166 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-167" name="__codelineno-9-167"></a><a href="#__codelineno-9-167"><span class="linenos" data-linenos="167 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Value &amp;</span>
<a id="__codelineno-9-168" name="__codelineno-9-168"></a><a href="#__codelineno-9-168"><span class="linenos" data-linenos="168 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-169" name="__codelineno-9-169"></a><a href="#__codelineno-9-169"><span class="linenos" data-linenos="169 "></span></a><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">&amp;</span><span class="nf">getOrDefault</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-170" name="__codelineno-9-170"></a><a href="#__codelineno-9-170"><span class="linenos" data-linenos="170 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-171" name="__codelineno-9-171"></a><a href="#__codelineno-9-171"><span class="linenos" data-linenos="171 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-172" name="__codelineno-9-172"></a><a href="#__codelineno-9-172"><span class="linenos" data-linenos="172 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-173" name="__codelineno-9-173"></a><a href="#__codelineno-9-173"><span class="linenos" data-linenos="173 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-174" name="__codelineno-9-174"></a><a href="#__codelineno-9-174"><span class="linenos" data-linenos="174 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span>
<a id="__codelineno-9-175" name="__codelineno-9-175"></a><a href="#__codelineno-9-175"><span class="linenos" data-linenos="175 "></span></a><span class="w">          </span><span class="o">-&gt;</span><span class="n">getNodeOrProvide</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<a id="__codelineno-9-176" name="__codelineno-9-176"></a><a href="#__codelineno-9-176"><span class="linenos" data-linenos="176 "></span></a><span class="w">                             </span><span class="p">[</span><span class="o">&amp;</span><span class="n">key</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="w"> </span><span class="p">})</span>
<a id="__codelineno-9-177" name="__codelineno-9-177"></a><a href="#__codelineno-9-177"><span class="linenos" data-linenos="177 "></span></a><span class="w">          </span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-178" name="__codelineno-9-178"></a><a href="#__codelineno-9-178"><span class="linenos" data-linenos="178 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-179" name="__codelineno-9-179"></a><a href="#__codelineno-9-179"><span class="linenos" data-linenos="179 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-180" name="__codelineno-9-180"></a><a href="#__codelineno-9-180"><span class="linenos" data-linenos="180 "></span></a>
<a id="__codelineno-9-181" name="__codelineno-9-181"></a><a href="#__codelineno-9-181"><span class="linenos" data-linenos="181 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-182" name="__codelineno-9-182"></a><a href="#__codelineno-9-182"><span class="linenos" data-linenos="182 "></span></a><span class="cm">   * Returns true if this map contains a mapping for the specified key.</span>
<a id="__codelineno-9-183" name="__codelineno-9-183"></a><a href="#__codelineno-9-183"><span class="linenos" data-linenos="183 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-184" name="__codelineno-9-184"></a><a href="#__codelineno-9-184"><span class="linenos" data-linenos="184 "></span></a><span class="cm">   * @return bool</span>
<a id="__codelineno-9-185" name="__codelineno-9-185"></a><a href="#__codelineno-9-185"><span class="linenos" data-linenos="185 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-186" name="__codelineno-9-186"></a><a href="#__codelineno-9-186"><span class="linenos" data-linenos="186 "></span></a><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-187" name="__codelineno-9-187"></a><a href="#__codelineno-9-187"><span class="linenos" data-linenos="187 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getNode</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<a id="__codelineno-9-188" name="__codelineno-9-188"></a><a href="#__codelineno-9-188"><span class="linenos" data-linenos="188 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-189" name="__codelineno-9-189"></a><a href="#__codelineno-9-189"><span class="linenos" data-linenos="189 "></span></a>
<a id="__codelineno-9-190" name="__codelineno-9-190"></a><a href="#__codelineno-9-190"><span class="linenos" data-linenos="190 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-191" name="__codelineno-9-191"></a><a href="#__codelineno-9-191"><span class="linenos" data-linenos="191 "></span></a><span class="cm">   * Associates the specified value with the specified key in this map.</span>
<a id="__codelineno-9-192" name="__codelineno-9-192"></a><a href="#__codelineno-9-192"><span class="linenos" data-linenos="192 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-193" name="__codelineno-9-193"></a><a href="#__codelineno-9-193"><span class="linenos" data-linenos="193 "></span></a><span class="cm">   * @param value</span>
<a id="__codelineno-9-194" name="__codelineno-9-194"></a><a href="#__codelineno-9-194"><span class="linenos" data-linenos="194 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-195" name="__codelineno-9-195"></a><a href="#__codelineno-9-195"><span class="linenos" data-linenos="195 "></span></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-196" name="__codelineno-9-196"></a><a href="#__codelineno-9-196"><span class="linenos" data-linenos="196 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-197" name="__codelineno-9-197"></a><a href="#__codelineno-9-197"><span class="linenos" data-linenos="197 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-9-198" name="__codelineno-9-198"></a><a href="#__codelineno-9-198"><span class="linenos" data-linenos="198 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-199" name="__codelineno-9-199"></a><a href="#__codelineno-9-199"><span class="linenos" data-linenos="199 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-9-200" name="__codelineno-9-200"></a><a href="#__codelineno-9-200"><span class="linenos" data-linenos="200 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-201" name="__codelineno-9-201"></a><a href="#__codelineno-9-201"><span class="linenos" data-linenos="201 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-202" name="__codelineno-9-202"></a><a href="#__codelineno-9-202"><span class="linenos" data-linenos="202 "></span></a>
<a id="__codelineno-9-203" name="__codelineno-9-203"></a><a href="#__codelineno-9-203"><span class="linenos" data-linenos="203 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-204" name="__codelineno-9-204"></a><a href="#__codelineno-9-204"><span class="linenos" data-linenos="204 "></span></a><span class="cm">   * If the specified key is not already associated with a value, associates</span>
<a id="__codelineno-9-205" name="__codelineno-9-205"></a><a href="#__codelineno-9-205"><span class="linenos" data-linenos="205 "></span></a><span class="cm">   * it with the given value and returns true, else returns false.</span>
<a id="__codelineno-9-206" name="__codelineno-9-206"></a><a href="#__codelineno-9-206"><span class="linenos" data-linenos="206 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-207" name="__codelineno-9-207"></a><a href="#__codelineno-9-207"><span class="linenos" data-linenos="207 "></span></a><span class="cm">   * @param value</span>
<a id="__codelineno-9-208" name="__codelineno-9-208"></a><a href="#__codelineno-9-208"><span class="linenos" data-linenos="208 "></span></a><span class="cm">   * @return bool</span>
<a id="__codelineno-9-209" name="__codelineno-9-209"></a><a href="#__codelineno-9-209"><span class="linenos" data-linenos="209 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-210" name="__codelineno-9-210"></a><a href="#__codelineno-9-210"><span class="linenos" data-linenos="210 "></span></a><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="nf">insertIfAbsent</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-211" name="__codelineno-9-211"></a><a href="#__codelineno-9-211"><span class="linenos" data-linenos="211 "></span></a><span class="w">    </span><span class="n">USize</span><span class="w"> </span><span class="n">sizeBeforeInsertion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">();</span>
<a id="__codelineno-9-212" name="__codelineno-9-212"></a><a href="#__codelineno-9-212"><span class="linenos" data-linenos="212 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-213" name="__codelineno-9-213"></a><a href="#__codelineno-9-213"><span class="linenos" data-linenos="213 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-9-214" name="__codelineno-9-214"></a><a href="#__codelineno-9-214"><span class="linenos" data-linenos="214 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-215" name="__codelineno-9-215"></a><a href="#__codelineno-9-215"><span class="linenos" data-linenos="215 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">insert</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<a id="__codelineno-9-216" name="__codelineno-9-216"></a><a href="#__codelineno-9-216"><span class="linenos" data-linenos="216 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-217" name="__codelineno-9-217"></a><a href="#__codelineno-9-217"><span class="linenos" data-linenos="217 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sizeBeforeInsertion</span><span class="p">;</span>
<a id="__codelineno-9-218" name="__codelineno-9-218"></a><a href="#__codelineno-9-218"><span class="linenos" data-linenos="218 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-219" name="__codelineno-9-219"></a><a href="#__codelineno-9-219"><span class="linenos" data-linenos="219 "></span></a>
<a id="__codelineno-9-220" name="__codelineno-9-220"></a><a href="#__codelineno-9-220"><span class="linenos" data-linenos="220 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-221" name="__codelineno-9-221"></a><a href="#__codelineno-9-221"><span class="linenos" data-linenos="221 "></span></a><span class="cm">   * If the specified key is not already associated with a value, associates</span>
<a id="__codelineno-9-222" name="__codelineno-9-222"></a><a href="#__codelineno-9-222"><span class="linenos" data-linenos="222 "></span></a><span class="cm">   * it with the given value and returns the value, else returns the associated</span>
<a id="__codelineno-9-223" name="__codelineno-9-223"></a><a href="#__codelineno-9-223"><span class="linenos" data-linenos="223 "></span></a><span class="cm">   * value.</span>
<a id="__codelineno-9-224" name="__codelineno-9-224"></a><a href="#__codelineno-9-224"><span class="linenos" data-linenos="224 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-225" name="__codelineno-9-225"></a><a href="#__codelineno-9-225"><span class="linenos" data-linenos="225 "></span></a><span class="cm">   * @param value</span>
<a id="__codelineno-9-226" name="__codelineno-9-226"></a><a href="#__codelineno-9-226"><span class="linenos" data-linenos="226 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Value &amp;</span>
<a id="__codelineno-9-227" name="__codelineno-9-227"></a><a href="#__codelineno-9-227"><span class="linenos" data-linenos="227 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-228" name="__codelineno-9-228"></a><a href="#__codelineno-9-228"><span class="linenos" data-linenos="228 "></span></a><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">&amp;</span><span class="nf">getOrInsert</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-229" name="__codelineno-9-229"></a><a href="#__codelineno-9-229"><span class="linenos" data-linenos="229 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-230" name="__codelineno-9-230"></a><a href="#__codelineno-9-230"><span class="linenos" data-linenos="230 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-9-231" name="__codelineno-9-231"></a><a href="#__codelineno-9-231"><span class="linenos" data-linenos="231 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">root</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-232" name="__codelineno-9-232"></a><a href="#__codelineno-9-232"><span class="linenos" data-linenos="232 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-233" name="__codelineno-9-233"></a><a href="#__codelineno-9-233"><span class="linenos" data-linenos="233 "></span></a><span class="w">      </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getNodeOrProvide</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span>
<a id="__codelineno-9-234" name="__codelineno-9-234"></a><a href="#__codelineno-9-234"><span class="linenos" data-linenos="234 "></span></a><span class="w">                                      </span><span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-9-235" name="__codelineno-9-235"></a><a href="#__codelineno-9-235"><span class="linenos" data-linenos="235 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-236" name="__codelineno-9-236"></a><a href="#__codelineno-9-236"><span class="linenos" data-linenos="236 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-237" name="__codelineno-9-237"></a><a href="#__codelineno-9-237"><span class="linenos" data-linenos="237 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-238" name="__codelineno-9-238"></a><a href="#__codelineno-9-238"><span class="linenos" data-linenos="238 "></span></a>
<a id="__codelineno-9-239" name="__codelineno-9-239"></a><a href="#__codelineno-9-239"><span class="linenos" data-linenos="239 "></span></a><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="k">operator</span><span class="p">[](</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-240" name="__codelineno-9-240"></a><a href="#__codelineno-9-240"><span class="linenos" data-linenos="240 "></span></a>
<a id="__codelineno-9-241" name="__codelineno-9-241"></a><a href="#__codelineno-9-241"><span class="linenos" data-linenos="241 "></span></a><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="o">&amp;</span><span class="k">operator</span><span class="p">[](</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">getOrDefault</span><span class="p">(</span><span class="n">key</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-242" name="__codelineno-9-242"></a><a href="#__codelineno-9-242"><span class="linenos" data-linenos="242 "></span></a>
<a id="__codelineno-9-243" name="__codelineno-9-243"></a><a href="#__codelineno-9-243"><span class="linenos" data-linenos="243 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-244" name="__codelineno-9-244"></a><a href="#__codelineno-9-244"><span class="linenos" data-linenos="244 "></span></a><span class="cm">   * Removes the mapping for a key from this map if it is present;</span>
<a id="__codelineno-9-245" name="__codelineno-9-245"></a><a href="#__codelineno-9-245"><span class="linenos" data-linenos="245 "></span></a><span class="cm">   * Returns true if the mapping is present else returns false</span>
<a id="__codelineno-9-246" name="__codelineno-9-246"></a><a href="#__codelineno-9-246"><span class="linenos" data-linenos="246 "></span></a><span class="cm">   * @param key the key of the mapping</span>
<a id="__codelineno-9-247" name="__codelineno-9-247"></a><a href="#__codelineno-9-247"><span class="linenos" data-linenos="247 "></span></a><span class="cm">   * @return bool</span>
<a id="__codelineno-9-248" name="__codelineno-9-248"></a><a href="#__codelineno-9-248"><span class="linenos" data-linenos="248 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-249" name="__codelineno-9-249"></a><a href="#__codelineno-9-249"><span class="linenos" data-linenos="249 "></span></a><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">remove</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-250" name="__codelineno-9-250"></a><a href="#__codelineno-9-250"><span class="linenos" data-linenos="250 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-251" name="__codelineno-9-251"></a><a href="#__codelineno-9-251"><span class="linenos" data-linenos="251 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<a id="__codelineno-9-252" name="__codelineno-9-252"></a><a href="#__codelineno-9-252"><span class="linenos" data-linenos="252 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-253" name="__codelineno-9-253"></a><a href="#__codelineno-9-253"><span class="linenos" data-linenos="253 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">remove</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="p">[](</span><span class="n">ConstNodePtr</span><span class="p">)</span><span class="w"> </span><span class="p">{});</span>
<a id="__codelineno-9-254" name="__codelineno-9-254"></a><a href="#__codelineno-9-254"><span class="linenos" data-linenos="254 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-255" name="__codelineno-9-255"></a><a href="#__codelineno-9-255"><span class="linenos" data-linenos="255 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-256" name="__codelineno-9-256"></a><a href="#__codelineno-9-256"><span class="linenos" data-linenos="256 "></span></a>
<a id="__codelineno-9-257" name="__codelineno-9-257"></a><a href="#__codelineno-9-257"><span class="linenos" data-linenos="257 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-258" name="__codelineno-9-258"></a><a href="#__codelineno-9-258"><span class="linenos" data-linenos="258 "></span></a><span class="cm">   * Removes the mapping for a key from this map if it is present and returns</span>
<a id="__codelineno-9-259" name="__codelineno-9-259"></a><a href="#__codelineno-9-259"><span class="linenos" data-linenos="259 "></span></a><span class="cm">   * the value which is mapped to the key; If this map contains no mapping for</span>
<a id="__codelineno-9-260" name="__codelineno-9-260"></a><a href="#__codelineno-9-260"><span class="linenos" data-linenos="260 "></span></a><span class="cm">   * the key, a {@code NoSuchMappingException} will be thrown.</span>
<a id="__codelineno-9-261" name="__codelineno-9-261"></a><a href="#__codelineno-9-261"><span class="linenos" data-linenos="261 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-262" name="__codelineno-9-262"></a><a href="#__codelineno-9-262"><span class="linenos" data-linenos="262 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Value</span>
<a id="__codelineno-9-263" name="__codelineno-9-263"></a><a href="#__codelineno-9-263"><span class="linenos" data-linenos="263 "></span></a><span class="cm">   * @throws NoSuchMappingException</span>
<a id="__codelineno-9-264" name="__codelineno-9-264"></a><a href="#__codelineno-9-264"><span class="linenos" data-linenos="264 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-265" name="__codelineno-9-265"></a><a href="#__codelineno-9-265"><span class="linenos" data-linenos="265 "></span></a><span class="w">  </span><span class="n">Value</span><span class="w"> </span><span class="n">getAndRemove</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-266" name="__codelineno-9-266"></a><a href="#__codelineno-9-266"><span class="linenos" data-linenos="266 "></span></a><span class="w">    </span><span class="n">Value</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<a id="__codelineno-9-267" name="__codelineno-9-267"></a><a href="#__codelineno-9-267"><span class="linenos" data-linenos="267 "></span></a><span class="w">    </span><span class="n">NodeConsumer</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span><span class="w"> </span><span class="p">};</span>
<a id="__codelineno-9-268" name="__codelineno-9-268"></a><a href="#__codelineno-9-268"><span class="linenos" data-linenos="268 "></span></a>
<a id="__codelineno-9-269" name="__codelineno-9-269"></a><a href="#__codelineno-9-269"><span class="linenos" data-linenos="269 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-270" name="__codelineno-9-270"></a><a href="#__codelineno-9-270"><span class="linenos" data-linenos="270 "></span></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"Invalid key"</span><span class="p">);</span>
<a id="__codelineno-9-271" name="__codelineno-9-271"></a><a href="#__codelineno-9-271"><span class="linenos" data-linenos="271 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-272" name="__codelineno-9-272"></a><a href="#__codelineno-9-272"><span class="linenos" data-linenos="272 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">remove</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-273" name="__codelineno-9-273"></a><a href="#__codelineno-9-273"><span class="linenos" data-linenos="273 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<a id="__codelineno-9-274" name="__codelineno-9-274"></a><a href="#__codelineno-9-274"><span class="linenos" data-linenos="274 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-275" name="__codelineno-9-275"></a><a href="#__codelineno-9-275"><span class="linenos" data-linenos="275 "></span></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"Invalid key"</span><span class="p">);</span>
<a id="__codelineno-9-276" name="__codelineno-9-276"></a><a href="#__codelineno-9-276"><span class="linenos" data-linenos="276 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-277" name="__codelineno-9-277"></a><a href="#__codelineno-9-277"><span class="linenos" data-linenos="277 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-278" name="__codelineno-9-278"></a><a href="#__codelineno-9-278"><span class="linenos" data-linenos="278 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-279" name="__codelineno-9-279"></a><a href="#__codelineno-9-279"><span class="linenos" data-linenos="279 "></span></a>
<a id="__codelineno-9-280" name="__codelineno-9-280"></a><a href="#__codelineno-9-280"><span class="linenos" data-linenos="280 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-281" name="__codelineno-9-281"></a><a href="#__codelineno-9-281"><span class="linenos" data-linenos="281 "></span></a><span class="cm">   * Gets the entry corresponding to the specified key; if no such entry</span>
<a id="__codelineno-9-282" name="__codelineno-9-282"></a><a href="#__codelineno-9-282"><span class="linenos" data-linenos="282 "></span></a><span class="cm">   * exists, returns the entry for the least key greater than the specified</span>
<a id="__codelineno-9-283" name="__codelineno-9-283"></a><a href="#__codelineno-9-283"><span class="linenos" data-linenos="283 "></span></a><span class="cm">   * key; if no such entry exists (i.e., the greatest key in the Tree is less</span>
<a id="__codelineno-9-284" name="__codelineno-9-284"></a><a href="#__codelineno-9-284"><span class="linenos" data-linenos="284 "></span></a><span class="cm">   * than the specified key), a {@code NoSuchMappingException} will be thrown.</span>
<a id="__codelineno-9-285" name="__codelineno-9-285"></a><a href="#__codelineno-9-285"><span class="linenos" data-linenos="285 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-286" name="__codelineno-9-286"></a><a href="#__codelineno-9-286"><span class="linenos" data-linenos="286 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Entry</span>
<a id="__codelineno-9-287" name="__codelineno-9-287"></a><a href="#__codelineno-9-287"><span class="linenos" data-linenos="287 "></span></a><span class="cm">   * @throws NoSuchMappingException</span>
<a id="__codelineno-9-288" name="__codelineno-9-288"></a><a href="#__codelineno-9-288"><span class="linenos" data-linenos="288 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-289" name="__codelineno-9-289"></a><a href="#__codelineno-9-289"><span class="linenos" data-linenos="289 "></span></a><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="n">getCeilingEntry</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-290" name="__codelineno-9-290"></a><a href="#__codelineno-9-290"><span class="linenos" data-linenos="290 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-291" name="__codelineno-9-291"></a><a href="#__codelineno-9-291"><span class="linenos" data-linenos="291 "></span></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No ceiling entry in this map"</span><span class="p">);</span>
<a id="__codelineno-9-292" name="__codelineno-9-292"></a><a href="#__codelineno-9-292"><span class="linenos" data-linenos="292 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-293" name="__codelineno-9-293"></a><a href="#__codelineno-9-293"><span class="linenos" data-linenos="293 "></span></a>
<a id="__codelineno-9-294" name="__codelineno-9-294"></a><a href="#__codelineno-9-294"><span class="linenos" data-linenos="294 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-9-295" name="__codelineno-9-295"></a><a href="#__codelineno-9-295"><span class="linenos" data-linenos="295 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="n">NodePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ancestors</span><span class="p">;</span>
<a id="__codelineno-9-296" name="__codelineno-9-296"></a><a href="#__codelineno-9-296"><span class="linenos" data-linenos="296 "></span></a>
<a id="__codelineno-9-297" name="__codelineno-9-297"></a><a href="#__codelineno-9-297"><span class="linenos" data-linenos="297 "></span></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-298" name="__codelineno-9-298"></a><a href="#__codelineno-9-298"><span class="linenos" data-linenos="298 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-299" name="__codelineno-9-299"></a><a href="#__codelineno-9-299"><span class="linenos" data-linenos="299 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-300" name="__codelineno-9-300"></a><a href="#__codelineno-9-300"><span class="linenos" data-linenos="300 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-301" name="__codelineno-9-301"></a><a href="#__codelineno-9-301"><span class="linenos" data-linenos="301 "></span></a>
<a id="__codelineno-9-302" name="__codelineno-9-302"></a><a href="#__codelineno-9-302"><span class="linenos" data-linenos="302 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-303" name="__codelineno-9-303"></a><a href="#__codelineno-9-303"><span class="linenos" data-linenos="303 "></span></a><span class="w">        </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-9-304" name="__codelineno-9-304"></a><a href="#__codelineno-9-304"><span class="linenos" data-linenos="304 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-305" name="__codelineno-9-305"></a><a href="#__codelineno-9-305"><span class="linenos" data-linenos="305 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-306" name="__codelineno-9-306"></a><a href="#__codelineno-9-306"><span class="linenos" data-linenos="306 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-307" name="__codelineno-9-307"></a><a href="#__codelineno-9-307"><span class="linenos" data-linenos="307 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-308" name="__codelineno-9-308"></a><a href="#__codelineno-9-308"><span class="linenos" data-linenos="308 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-309" name="__codelineno-9-309"></a><a href="#__codelineno-9-309"><span class="linenos" data-linenos="309 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-310" name="__codelineno-9-310"></a><a href="#__codelineno-9-310"><span class="linenos" data-linenos="310 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-311" name="__codelineno-9-311"></a><a href="#__codelineno-9-311"><span class="linenos" data-linenos="311 "></span></a><span class="w">        </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-9-312" name="__codelineno-9-312"></a><a href="#__codelineno-9-312"><span class="linenos" data-linenos="312 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-313" name="__codelineno-9-313"></a><a href="#__codelineno-9-313"><span class="linenos" data-linenos="313 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-314" name="__codelineno-9-314"></a><a href="#__codelineno-9-314"><span class="linenos" data-linenos="314 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-315" name="__codelineno-9-315"></a><a href="#__codelineno-9-315"><span class="linenos" data-linenos="315 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-316" name="__codelineno-9-316"></a><a href="#__codelineno-9-316"><span class="linenos" data-linenos="316 "></span></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-317" name="__codelineno-9-317"></a><a href="#__codelineno-9-317"><span class="linenos" data-linenos="317 "></span></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No ceiling entry in this map"</span><span class="p">);</span>
<a id="__codelineno-9-318" name="__codelineno-9-318"></a><a href="#__codelineno-9-318"><span class="linenos" data-linenos="318 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-319" name="__codelineno-9-319"></a><a href="#__codelineno-9-319"><span class="linenos" data-linenos="319 "></span></a>
<a id="__codelineno-9-320" name="__codelineno-9-320"></a><a href="#__codelineno-9-320"><span class="linenos" data-linenos="320 "></span></a><span class="w">          </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-321" name="__codelineno-9-321"></a><a href="#__codelineno-9-321"><span class="linenos" data-linenos="321 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-322" name="__codelineno-9-322"></a><a href="#__codelineno-9-322"><span class="linenos" data-linenos="322 "></span></a>
<a id="__codelineno-9-323" name="__codelineno-9-323"></a><a href="#__codelineno-9-323"><span class="linenos" data-linenos="323 "></span></a><span class="w">          </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-324" name="__codelineno-9-324"></a><a href="#__codelineno-9-324"><span class="linenos" data-linenos="324 "></span></a><span class="w">            </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-9-325" name="__codelineno-9-325"></a><a href="#__codelineno-9-325"><span class="linenos" data-linenos="325 "></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-326" name="__codelineno-9-326"></a><a href="#__codelineno-9-326"><span class="linenos" data-linenos="326 "></span></a><span class="w">              </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-327" name="__codelineno-9-327"></a><a href="#__codelineno-9-327"><span class="linenos" data-linenos="327 "></span></a><span class="w">              </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-328" name="__codelineno-9-328"></a><a href="#__codelineno-9-328"><span class="linenos" data-linenos="328 "></span></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-329" name="__codelineno-9-329"></a><a href="#__codelineno-9-329"><span class="linenos" data-linenos="329 "></span></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No ceiling entry in this map"</span><span class="p">);</span>
<a id="__codelineno-9-330" name="__codelineno-9-330"></a><a href="#__codelineno-9-330"><span class="linenos" data-linenos="330 "></span></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-9-331" name="__codelineno-9-331"></a><a href="#__codelineno-9-331"><span class="linenos" data-linenos="331 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-332" name="__codelineno-9-332"></a><a href="#__codelineno-9-332"><span class="linenos" data-linenos="332 "></span></a>
<a id="__codelineno-9-333" name="__codelineno-9-333"></a><a href="#__codelineno-9-333"><span class="linenos" data-linenos="333 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-334" name="__codelineno-9-334"></a><a href="#__codelineno-9-334"><span class="linenos" data-linenos="334 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-335" name="__codelineno-9-335"></a><a href="#__codelineno-9-335"><span class="linenos" data-linenos="335 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-336" name="__codelineno-9-336"></a><a href="#__codelineno-9-336"><span class="linenos" data-linenos="336 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-337" name="__codelineno-9-337"></a><a href="#__codelineno-9-337"><span class="linenos" data-linenos="337 "></span></a>
<a id="__codelineno-9-338" name="__codelineno-9-338"></a><a href="#__codelineno-9-338"><span class="linenos" data-linenos="338 "></span></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No ceiling entry in this map"</span><span class="p">);</span>
<a id="__codelineno-9-339" name="__codelineno-9-339"></a><a href="#__codelineno-9-339"><span class="linenos" data-linenos="339 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-340" name="__codelineno-9-340"></a><a href="#__codelineno-9-340"><span class="linenos" data-linenos="340 "></span></a>
<a id="__codelineno-9-341" name="__codelineno-9-341"></a><a href="#__codelineno-9-341"><span class="linenos" data-linenos="341 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-342" name="__codelineno-9-342"></a><a href="#__codelineno-9-342"><span class="linenos" data-linenos="342 "></span></a><span class="cm">   * Gets the entry corresponding to the specified key; if no such entry exists,</span>
<a id="__codelineno-9-343" name="__codelineno-9-343"></a><a href="#__codelineno-9-343"><span class="linenos" data-linenos="343 "></span></a><span class="cm">   * returns the entry for the greatest key less than the specified key;</span>
<a id="__codelineno-9-344" name="__codelineno-9-344"></a><a href="#__codelineno-9-344"><span class="linenos" data-linenos="344 "></span></a><span class="cm">   * if no such entry exists, a {@code NoSuchMappingException} will be thrown.</span>
<a id="__codelineno-9-345" name="__codelineno-9-345"></a><a href="#__codelineno-9-345"><span class="linenos" data-linenos="345 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-346" name="__codelineno-9-346"></a><a href="#__codelineno-9-346"><span class="linenos" data-linenos="346 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Entry</span>
<a id="__codelineno-9-347" name="__codelineno-9-347"></a><a href="#__codelineno-9-347"><span class="linenos" data-linenos="347 "></span></a><span class="cm">   * @throws NoSuchMappingException</span>
<a id="__codelineno-9-348" name="__codelineno-9-348"></a><a href="#__codelineno-9-348"><span class="linenos" data-linenos="348 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-349" name="__codelineno-9-349"></a><a href="#__codelineno-9-349"><span class="linenos" data-linenos="349 "></span></a><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="n">getFloorEntry</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-350" name="__codelineno-9-350"></a><a href="#__codelineno-9-350"><span class="linenos" data-linenos="350 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-351" name="__codelineno-9-351"></a><a href="#__codelineno-9-351"><span class="linenos" data-linenos="351 "></span></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No floor entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-352" name="__codelineno-9-352"></a><a href="#__codelineno-9-352"><span class="linenos" data-linenos="352 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-353" name="__codelineno-9-353"></a><a href="#__codelineno-9-353"><span class="linenos" data-linenos="353 "></span></a>
<a id="__codelineno-9-354" name="__codelineno-9-354"></a><a href="#__codelineno-9-354"><span class="linenos" data-linenos="354 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-9-355" name="__codelineno-9-355"></a><a href="#__codelineno-9-355"><span class="linenos" data-linenos="355 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="n">NodePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ancestors</span><span class="p">;</span>
<a id="__codelineno-9-356" name="__codelineno-9-356"></a><a href="#__codelineno-9-356"><span class="linenos" data-linenos="356 "></span></a>
<a id="__codelineno-9-357" name="__codelineno-9-357"></a><a href="#__codelineno-9-357"><span class="linenos" data-linenos="357 "></span></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-358" name="__codelineno-9-358"></a><a href="#__codelineno-9-358"><span class="linenos" data-linenos="358 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-359" name="__codelineno-9-359"></a><a href="#__codelineno-9-359"><span class="linenos" data-linenos="359 "></span></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-360" name="__codelineno-9-360"></a><a href="#__codelineno-9-360"><span class="linenos" data-linenos="360 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-361" name="__codelineno-9-361"></a><a href="#__codelineno-9-361"><span class="linenos" data-linenos="361 "></span></a>
<a id="__codelineno-9-362" name="__codelineno-9-362"></a><a href="#__codelineno-9-362"><span class="linenos" data-linenos="362 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-363" name="__codelineno-9-363"></a><a href="#__codelineno-9-363"><span class="linenos" data-linenos="363 "></span></a><span class="w">        </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-9-364" name="__codelineno-9-364"></a><a href="#__codelineno-9-364"><span class="linenos" data-linenos="364 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-365" name="__codelineno-9-365"></a><a href="#__codelineno-9-365"><span class="linenos" data-linenos="365 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-366" name="__codelineno-9-366"></a><a href="#__codelineno-9-366"><span class="linenos" data-linenos="366 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-367" name="__codelineno-9-367"></a><a href="#__codelineno-9-367"><span class="linenos" data-linenos="367 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-368" name="__codelineno-9-368"></a><a href="#__codelineno-9-368"><span class="linenos" data-linenos="368 "></span></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-369" name="__codelineno-9-369"></a><a href="#__codelineno-9-369"><span class="linenos" data-linenos="369 "></span></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No floor entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-370" name="__codelineno-9-370"></a><a href="#__codelineno-9-370"><span class="linenos" data-linenos="370 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-371" name="__codelineno-9-371"></a><a href="#__codelineno-9-371"><span class="linenos" data-linenos="371 "></span></a>
<a id="__codelineno-9-372" name="__codelineno-9-372"></a><a href="#__codelineno-9-372"><span class="linenos" data-linenos="372 "></span></a><span class="w">          </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-373" name="__codelineno-9-373"></a><a href="#__codelineno-9-373"><span class="linenos" data-linenos="373 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-374" name="__codelineno-9-374"></a><a href="#__codelineno-9-374"><span class="linenos" data-linenos="374 "></span></a>
<a id="__codelineno-9-375" name="__codelineno-9-375"></a><a href="#__codelineno-9-375"><span class="linenos" data-linenos="375 "></span></a><span class="w">          </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-376" name="__codelineno-9-376"></a><a href="#__codelineno-9-376"><span class="linenos" data-linenos="376 "></span></a><span class="w">            </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-9-377" name="__codelineno-9-377"></a><a href="#__codelineno-9-377"><span class="linenos" data-linenos="377 "></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-378" name="__codelineno-9-378"></a><a href="#__codelineno-9-378"><span class="linenos" data-linenos="378 "></span></a><span class="w">              </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-379" name="__codelineno-9-379"></a><a href="#__codelineno-9-379"><span class="linenos" data-linenos="379 "></span></a><span class="w">              </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-380" name="__codelineno-9-380"></a><a href="#__codelineno-9-380"><span class="linenos" data-linenos="380 "></span></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-381" name="__codelineno-9-381"></a><a href="#__codelineno-9-381"><span class="linenos" data-linenos="381 "></span></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No floor entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-382" name="__codelineno-9-382"></a><a href="#__codelineno-9-382"><span class="linenos" data-linenos="382 "></span></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-9-383" name="__codelineno-9-383"></a><a href="#__codelineno-9-383"><span class="linenos" data-linenos="383 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-384" name="__codelineno-9-384"></a><a href="#__codelineno-9-384"><span class="linenos" data-linenos="384 "></span></a>
<a id="__codelineno-9-385" name="__codelineno-9-385"></a><a href="#__codelineno-9-385"><span class="linenos" data-linenos="385 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-386" name="__codelineno-9-386"></a><a href="#__codelineno-9-386"><span class="linenos" data-linenos="386 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-387" name="__codelineno-9-387"></a><a href="#__codelineno-9-387"><span class="linenos" data-linenos="387 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-388" name="__codelineno-9-388"></a><a href="#__codelineno-9-388"><span class="linenos" data-linenos="388 "></span></a><span class="w">        </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-9-389" name="__codelineno-9-389"></a><a href="#__codelineno-9-389"><span class="linenos" data-linenos="389 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-390" name="__codelineno-9-390"></a><a href="#__codelineno-9-390"><span class="linenos" data-linenos="390 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-391" name="__codelineno-9-391"></a><a href="#__codelineno-9-391"><span class="linenos" data-linenos="391 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-392" name="__codelineno-9-392"></a><a href="#__codelineno-9-392"><span class="linenos" data-linenos="392 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-393" name="__codelineno-9-393"></a><a href="#__codelineno-9-393"><span class="linenos" data-linenos="393 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-394" name="__codelineno-9-394"></a><a href="#__codelineno-9-394"><span class="linenos" data-linenos="394 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-395" name="__codelineno-9-395"></a><a href="#__codelineno-9-395"><span class="linenos" data-linenos="395 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-396" name="__codelineno-9-396"></a><a href="#__codelineno-9-396"><span class="linenos" data-linenos="396 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-397" name="__codelineno-9-397"></a><a href="#__codelineno-9-397"><span class="linenos" data-linenos="397 "></span></a>
<a id="__codelineno-9-398" name="__codelineno-9-398"></a><a href="#__codelineno-9-398"><span class="linenos" data-linenos="398 "></span></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No floor entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-399" name="__codelineno-9-399"></a><a href="#__codelineno-9-399"><span class="linenos" data-linenos="399 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-400" name="__codelineno-9-400"></a><a href="#__codelineno-9-400"><span class="linenos" data-linenos="400 "></span></a>
<a id="__codelineno-9-401" name="__codelineno-9-401"></a><a href="#__codelineno-9-401"><span class="linenos" data-linenos="401 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-402" name="__codelineno-9-402"></a><a href="#__codelineno-9-402"><span class="linenos" data-linenos="402 "></span></a><span class="cm">   * Gets the entry for the least key greater than the specified</span>
<a id="__codelineno-9-403" name="__codelineno-9-403"></a><a href="#__codelineno-9-403"><span class="linenos" data-linenos="403 "></span></a><span class="cm">   * key; if no such entry exists, returns the entry for the least</span>
<a id="__codelineno-9-404" name="__codelineno-9-404"></a><a href="#__codelineno-9-404"><span class="linenos" data-linenos="404 "></span></a><span class="cm">   * key greater than the specified key; if no such entry exists,</span>
<a id="__codelineno-9-405" name="__codelineno-9-405"></a><a href="#__codelineno-9-405"><span class="linenos" data-linenos="405 "></span></a><span class="cm">   * a {@code NoSuchMappingException} will be thrown.</span>
<a id="__codelineno-9-406" name="__codelineno-9-406"></a><a href="#__codelineno-9-406"><span class="linenos" data-linenos="406 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-407" name="__codelineno-9-407"></a><a href="#__codelineno-9-407"><span class="linenos" data-linenos="407 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Entry</span>
<a id="__codelineno-9-408" name="__codelineno-9-408"></a><a href="#__codelineno-9-408"><span class="linenos" data-linenos="408 "></span></a><span class="cm">   * @throws NoSuchMappingException</span>
<a id="__codelineno-9-409" name="__codelineno-9-409"></a><a href="#__codelineno-9-409"><span class="linenos" data-linenos="409 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-410" name="__codelineno-9-410"></a><a href="#__codelineno-9-410"><span class="linenos" data-linenos="410 "></span></a><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="n">getHigherEntry</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-411" name="__codelineno-9-411"></a><a href="#__codelineno-9-411"><span class="linenos" data-linenos="411 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-412" name="__codelineno-9-412"></a><a href="#__codelineno-9-412"><span class="linenos" data-linenos="412 "></span></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No higher entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-413" name="__codelineno-9-413"></a><a href="#__codelineno-9-413"><span class="linenos" data-linenos="413 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-414" name="__codelineno-9-414"></a><a href="#__codelineno-9-414"><span class="linenos" data-linenos="414 "></span></a>
<a id="__codelineno-9-415" name="__codelineno-9-415"></a><a href="#__codelineno-9-415"><span class="linenos" data-linenos="415 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-9-416" name="__codelineno-9-416"></a><a href="#__codelineno-9-416"><span class="linenos" data-linenos="416 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="n">NodePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ancestors</span><span class="p">;</span>
<a id="__codelineno-9-417" name="__codelineno-9-417"></a><a href="#__codelineno-9-417"><span class="linenos" data-linenos="417 "></span></a>
<a id="__codelineno-9-418" name="__codelineno-9-418"></a><a href="#__codelineno-9-418"><span class="linenos" data-linenos="418 "></span></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-419" name="__codelineno-9-419"></a><a href="#__codelineno-9-419"><span class="linenos" data-linenos="419 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-420" name="__codelineno-9-420"></a><a href="#__codelineno-9-420"><span class="linenos" data-linenos="420 "></span></a><span class="w">        </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-9-421" name="__codelineno-9-421"></a><a href="#__codelineno-9-421"><span class="linenos" data-linenos="421 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-422" name="__codelineno-9-422"></a><a href="#__codelineno-9-422"><span class="linenos" data-linenos="422 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-423" name="__codelineno-9-423"></a><a href="#__codelineno-9-423"><span class="linenos" data-linenos="423 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-424" name="__codelineno-9-424"></a><a href="#__codelineno-9-424"><span class="linenos" data-linenos="424 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-425" name="__codelineno-9-425"></a><a href="#__codelineno-9-425"><span class="linenos" data-linenos="425 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-426" name="__codelineno-9-426"></a><a href="#__codelineno-9-426"><span class="linenos" data-linenos="426 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-427" name="__codelineno-9-427"></a><a href="#__codelineno-9-427"><span class="linenos" data-linenos="427 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-428" name="__codelineno-9-428"></a><a href="#__codelineno-9-428"><span class="linenos" data-linenos="428 "></span></a><span class="w">        </span><span class="cm">/* key &gt;= node-&gt;key */</span>
<a id="__codelineno-9-429" name="__codelineno-9-429"></a><a href="#__codelineno-9-429"><span class="linenos" data-linenos="429 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-430" name="__codelineno-9-430"></a><a href="#__codelineno-9-430"><span class="linenos" data-linenos="430 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-431" name="__codelineno-9-431"></a><a href="#__codelineno-9-431"><span class="linenos" data-linenos="431 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-432" name="__codelineno-9-432"></a><a href="#__codelineno-9-432"><span class="linenos" data-linenos="432 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-433" name="__codelineno-9-433"></a><a href="#__codelineno-9-433"><span class="linenos" data-linenos="433 "></span></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-434" name="__codelineno-9-434"></a><a href="#__codelineno-9-434"><span class="linenos" data-linenos="434 "></span></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No higher entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-435" name="__codelineno-9-435"></a><a href="#__codelineno-9-435"><span class="linenos" data-linenos="435 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-436" name="__codelineno-9-436"></a><a href="#__codelineno-9-436"><span class="linenos" data-linenos="436 "></span></a>
<a id="__codelineno-9-437" name="__codelineno-9-437"></a><a href="#__codelineno-9-437"><span class="linenos" data-linenos="437 "></span></a><span class="w">          </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-438" name="__codelineno-9-438"></a><a href="#__codelineno-9-438"><span class="linenos" data-linenos="438 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-439" name="__codelineno-9-439"></a><a href="#__codelineno-9-439"><span class="linenos" data-linenos="439 "></span></a>
<a id="__codelineno-9-440" name="__codelineno-9-440"></a><a href="#__codelineno-9-440"><span class="linenos" data-linenos="440 "></span></a><span class="w">          </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-441" name="__codelineno-9-441"></a><a href="#__codelineno-9-441"><span class="linenos" data-linenos="441 "></span></a><span class="w">            </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-9-442" name="__codelineno-9-442"></a><a href="#__codelineno-9-442"><span class="linenos" data-linenos="442 "></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-443" name="__codelineno-9-443"></a><a href="#__codelineno-9-443"><span class="linenos" data-linenos="443 "></span></a><span class="w">              </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-444" name="__codelineno-9-444"></a><a href="#__codelineno-9-444"><span class="linenos" data-linenos="444 "></span></a><span class="w">              </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-445" name="__codelineno-9-445"></a><a href="#__codelineno-9-445"><span class="linenos" data-linenos="445 "></span></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-446" name="__codelineno-9-446"></a><a href="#__codelineno-9-446"><span class="linenos" data-linenos="446 "></span></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span>
<a id="__codelineno-9-447" name="__codelineno-9-447"></a><a href="#__codelineno-9-447"><span class="linenos" data-linenos="447 "></span></a><span class="w">                  </span><span class="s">"No higher entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-448" name="__codelineno-9-448"></a><a href="#__codelineno-9-448"><span class="linenos" data-linenos="448 "></span></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-9-449" name="__codelineno-9-449"></a><a href="#__codelineno-9-449"><span class="linenos" data-linenos="449 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-450" name="__codelineno-9-450"></a><a href="#__codelineno-9-450"><span class="linenos" data-linenos="450 "></span></a>
<a id="__codelineno-9-451" name="__codelineno-9-451"></a><a href="#__codelineno-9-451"><span class="linenos" data-linenos="451 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-452" name="__codelineno-9-452"></a><a href="#__codelineno-9-452"><span class="linenos" data-linenos="452 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-453" name="__codelineno-9-453"></a><a href="#__codelineno-9-453"><span class="linenos" data-linenos="453 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-454" name="__codelineno-9-454"></a><a href="#__codelineno-9-454"><span class="linenos" data-linenos="454 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-455" name="__codelineno-9-455"></a><a href="#__codelineno-9-455"><span class="linenos" data-linenos="455 "></span></a>
<a id="__codelineno-9-456" name="__codelineno-9-456"></a><a href="#__codelineno-9-456"><span class="linenos" data-linenos="456 "></span></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No higher entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-457" name="__codelineno-9-457"></a><a href="#__codelineno-9-457"><span class="linenos" data-linenos="457 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-458" name="__codelineno-9-458"></a><a href="#__codelineno-9-458"><span class="linenos" data-linenos="458 "></span></a>
<a id="__codelineno-9-459" name="__codelineno-9-459"></a><a href="#__codelineno-9-459"><span class="linenos" data-linenos="459 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-460" name="__codelineno-9-460"></a><a href="#__codelineno-9-460"><span class="linenos" data-linenos="460 "></span></a><span class="cm">   * Returns the entry for the greatest key less than the specified key; if</span>
<a id="__codelineno-9-461" name="__codelineno-9-461"></a><a href="#__codelineno-9-461"><span class="linenos" data-linenos="461 "></span></a><span class="cm">   * no such entry exists (i.e., the least key in the Tree is greater than</span>
<a id="__codelineno-9-462" name="__codelineno-9-462"></a><a href="#__codelineno-9-462"><span class="linenos" data-linenos="462 "></span></a><span class="cm">   * the specified key), a {@code NoSuchMappingException} will be thrown.</span>
<a id="__codelineno-9-463" name="__codelineno-9-463"></a><a href="#__codelineno-9-463"><span class="linenos" data-linenos="463 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-464" name="__codelineno-9-464"></a><a href="#__codelineno-9-464"><span class="linenos" data-linenos="464 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::Entry</span>
<a id="__codelineno-9-465" name="__codelineno-9-465"></a><a href="#__codelineno-9-465"><span class="linenos" data-linenos="465 "></span></a><span class="cm">   * @throws NoSuchMappingException</span>
<a id="__codelineno-9-466" name="__codelineno-9-466"></a><a href="#__codelineno-9-466"><span class="linenos" data-linenos="466 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-467" name="__codelineno-9-467"></a><a href="#__codelineno-9-467"><span class="linenos" data-linenos="467 "></span></a><span class="w">  </span><span class="n">Entry</span><span class="w"> </span><span class="n">getLowerEntry</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-468" name="__codelineno-9-468"></a><a href="#__codelineno-9-468"><span class="linenos" data-linenos="468 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-469" name="__codelineno-9-469"></a><a href="#__codelineno-9-469"><span class="linenos" data-linenos="469 "></span></a><span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No lower entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-470" name="__codelineno-9-470"></a><a href="#__codelineno-9-470"><span class="linenos" data-linenos="470 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-471" name="__codelineno-9-471"></a><a href="#__codelineno-9-471"><span class="linenos" data-linenos="471 "></span></a>
<a id="__codelineno-9-472" name="__codelineno-9-472"></a><a href="#__codelineno-9-472"><span class="linenos" data-linenos="472 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-9-473" name="__codelineno-9-473"></a><a href="#__codelineno-9-473"><span class="linenos" data-linenos="473 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="n">NodePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ancestors</span><span class="p">;</span>
<a id="__codelineno-9-474" name="__codelineno-9-474"></a><a href="#__codelineno-9-474"><span class="linenos" data-linenos="474 "></span></a>
<a id="__codelineno-9-475" name="__codelineno-9-475"></a><a href="#__codelineno-9-475"><span class="linenos" data-linenos="475 "></span></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-476" name="__codelineno-9-476"></a><a href="#__codelineno-9-476"><span class="linenos" data-linenos="476 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-477" name="__codelineno-9-477"></a><a href="#__codelineno-9-477"><span class="linenos" data-linenos="477 "></span></a><span class="w">        </span><span class="cm">/* key &lt;= node-&gt;key */</span>
<a id="__codelineno-9-478" name="__codelineno-9-478"></a><a href="#__codelineno-9-478"><span class="linenos" data-linenos="478 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-479" name="__codelineno-9-479"></a><a href="#__codelineno-9-479"><span class="linenos" data-linenos="479 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-480" name="__codelineno-9-480"></a><a href="#__codelineno-9-480"><span class="linenos" data-linenos="480 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-481" name="__codelineno-9-481"></a><a href="#__codelineno-9-481"><span class="linenos" data-linenos="481 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-482" name="__codelineno-9-482"></a><a href="#__codelineno-9-482"><span class="linenos" data-linenos="482 "></span></a><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-483" name="__codelineno-9-483"></a><a href="#__codelineno-9-483"><span class="linenos" data-linenos="483 "></span></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No lower entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-484" name="__codelineno-9-484"></a><a href="#__codelineno-9-484"><span class="linenos" data-linenos="484 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-485" name="__codelineno-9-485"></a><a href="#__codelineno-9-485"><span class="linenos" data-linenos="485 "></span></a>
<a id="__codelineno-9-486" name="__codelineno-9-486"></a><a href="#__codelineno-9-486"><span class="linenos" data-linenos="486 "></span></a><span class="w">          </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-487" name="__codelineno-9-487"></a><a href="#__codelineno-9-487"><span class="linenos" data-linenos="487 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-488" name="__codelineno-9-488"></a><a href="#__codelineno-9-488"><span class="linenos" data-linenos="488 "></span></a>
<a id="__codelineno-9-489" name="__codelineno-9-489"></a><a href="#__codelineno-9-489"><span class="linenos" data-linenos="489 "></span></a><span class="w">          </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-490" name="__codelineno-9-490"></a><a href="#__codelineno-9-490"><span class="linenos" data-linenos="490 "></span></a><span class="w">            </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>
<a id="__codelineno-9-491" name="__codelineno-9-491"></a><a href="#__codelineno-9-491"><span class="linenos" data-linenos="491 "></span></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ancestors</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-492" name="__codelineno-9-492"></a><a href="#__codelineno-9-492"><span class="linenos" data-linenos="492 "></span></a><span class="w">              </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ancestors</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-493" name="__codelineno-9-493"></a><a href="#__codelineno-9-493"><span class="linenos" data-linenos="493 "></span></a><span class="w">              </span><span class="n">ancestors</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-494" name="__codelineno-9-494"></a><a href="#__codelineno-9-494"><span class="linenos" data-linenos="494 "></span></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-495" name="__codelineno-9-495"></a><a href="#__codelineno-9-495"><span class="linenos" data-linenos="495 "></span></a><span class="w">              </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No lower entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-496" name="__codelineno-9-496"></a><a href="#__codelineno-9-496"><span class="linenos" data-linenos="496 "></span></a><span class="w">            </span><span class="p">}</span>
<a id="__codelineno-9-497" name="__codelineno-9-497"></a><a href="#__codelineno-9-497"><span class="linenos" data-linenos="497 "></span></a><span class="w">          </span><span class="p">}</span>
<a id="__codelineno-9-498" name="__codelineno-9-498"></a><a href="#__codelineno-9-498"><span class="linenos" data-linenos="498 "></span></a>
<a id="__codelineno-9-499" name="__codelineno-9-499"></a><a href="#__codelineno-9-499"><span class="linenos" data-linenos="499 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-500" name="__codelineno-9-500"></a><a href="#__codelineno-9-500"><span class="linenos" data-linenos="500 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-501" name="__codelineno-9-501"></a><a href="#__codelineno-9-501"><span class="linenos" data-linenos="501 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-502" name="__codelineno-9-502"></a><a href="#__codelineno-9-502"><span class="linenos" data-linenos="502 "></span></a><span class="w">        </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-9-503" name="__codelineno-9-503"></a><a href="#__codelineno-9-503"><span class="linenos" data-linenos="503 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-504" name="__codelineno-9-504"></a><a href="#__codelineno-9-504"><span class="linenos" data-linenos="504 "></span></a><span class="w">          </span><span class="n">ancestors</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-505" name="__codelineno-9-505"></a><a href="#__codelineno-9-505"><span class="linenos" data-linenos="505 "></span></a><span class="w">          </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-506" name="__codelineno-9-506"></a><a href="#__codelineno-9-506"><span class="linenos" data-linenos="506 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-507" name="__codelineno-9-507"></a><a href="#__codelineno-9-507"><span class="linenos" data-linenos="507 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">();</span>
<a id="__codelineno-9-508" name="__codelineno-9-508"></a><a href="#__codelineno-9-508"><span class="linenos" data-linenos="508 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-509" name="__codelineno-9-509"></a><a href="#__codelineno-9-509"><span class="linenos" data-linenos="509 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-510" name="__codelineno-9-510"></a><a href="#__codelineno-9-510"><span class="linenos" data-linenos="510 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-511" name="__codelineno-9-511"></a><a href="#__codelineno-9-511"><span class="linenos" data-linenos="511 "></span></a>
<a id="__codelineno-9-512" name="__codelineno-9-512"></a><a href="#__codelineno-9-512"><span class="linenos" data-linenos="512 "></span></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">NoSuchMappingException</span><span class="p">(</span><span class="s">"No lower entry exists in this map"</span><span class="p">);</span>
<a id="__codelineno-9-513" name="__codelineno-9-513"></a><a href="#__codelineno-9-513"><span class="linenos" data-linenos="513 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-514" name="__codelineno-9-514"></a><a href="#__codelineno-9-514"><span class="linenos" data-linenos="514 "></span></a>
<a id="__codelineno-9-515" name="__codelineno-9-515"></a><a href="#__codelineno-9-515"><span class="linenos" data-linenos="515 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-516" name="__codelineno-9-516"></a><a href="#__codelineno-9-516"><span class="linenos" data-linenos="516 "></span></a><span class="cm">   * Count the number of entries that are less than the given key</span>
<a id="__codelineno-9-517" name="__codelineno-9-517"></a><a href="#__codelineno-9-517"><span class="linenos" data-linenos="517 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-518" name="__codelineno-9-518"></a><a href="#__codelineno-9-518"><span class="linenos" data-linenos="518 "></span></a><span class="cm">   * @return USize</span>
<a id="__codelineno-9-519" name="__codelineno-9-519"></a><a href="#__codelineno-9-519"><span class="linenos" data-linenos="519 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-520" name="__codelineno-9-520"></a><a href="#__codelineno-9-520"><span class="linenos" data-linenos="520 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">countLessThan</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">countLess</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-521" name="__codelineno-9-521"></a><a href="#__codelineno-9-521"><span class="linenos" data-linenos="521 "></span></a>
<a id="__codelineno-9-522" name="__codelineno-9-522"></a><a href="#__codelineno-9-522"><span class="linenos" data-linenos="522 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-523" name="__codelineno-9-523"></a><a href="#__codelineno-9-523"><span class="linenos" data-linenos="523 "></span></a><span class="cm">   * Count the number of entries that are less or equal to the given key</span>
<a id="__codelineno-9-524" name="__codelineno-9-524"></a><a href="#__codelineno-9-524"><span class="linenos" data-linenos="524 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-525" name="__codelineno-9-525"></a><a href="#__codelineno-9-525"><span class="linenos" data-linenos="525 "></span></a><span class="cm">   * @return USize</span>
<a id="__codelineno-9-526" name="__codelineno-9-526"></a><a href="#__codelineno-9-526"><span class="linenos" data-linenos="526 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-527" name="__codelineno-9-527"></a><a href="#__codelineno-9-527"><span class="linenos" data-linenos="527 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">countLessOrEqualTo</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-528" name="__codelineno-9-528"></a><a href="#__codelineno-9-528"><span class="linenos" data-linenos="528 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">countLess</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<a id="__codelineno-9-529" name="__codelineno-9-529"></a><a href="#__codelineno-9-529"><span class="linenos" data-linenos="529 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-530" name="__codelineno-9-530"></a><a href="#__codelineno-9-530"><span class="linenos" data-linenos="530 "></span></a>
<a id="__codelineno-9-531" name="__codelineno-9-531"></a><a href="#__codelineno-9-531"><span class="linenos" data-linenos="531 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-532" name="__codelineno-9-532"></a><a href="#__codelineno-9-532"><span class="linenos" data-linenos="532 "></span></a><span class="cm">   * Count the number of entries that are greater than the given key</span>
<a id="__codelineno-9-533" name="__codelineno-9-533"></a><a href="#__codelineno-9-533"><span class="linenos" data-linenos="533 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-534" name="__codelineno-9-534"></a><a href="#__codelineno-9-534"><span class="linenos" data-linenos="534 "></span></a><span class="cm">   * @return USize</span>
<a id="__codelineno-9-535" name="__codelineno-9-535"></a><a href="#__codelineno-9-535"><span class="linenos" data-linenos="535 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-536" name="__codelineno-9-536"></a><a href="#__codelineno-9-536"><span class="linenos" data-linenos="536 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">countGreaterThan</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">countGreater</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-9-537" name="__codelineno-9-537"></a><a href="#__codelineno-9-537"><span class="linenos" data-linenos="537 "></span></a>
<a id="__codelineno-9-538" name="__codelineno-9-538"></a><a href="#__codelineno-9-538"><span class="linenos" data-linenos="538 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-539" name="__codelineno-9-539"></a><a href="#__codelineno-9-539"><span class="linenos" data-linenos="539 "></span></a><span class="cm">   * Count the number of entries that are greater or equal to the given key</span>
<a id="__codelineno-9-540" name="__codelineno-9-540"></a><a href="#__codelineno-9-540"><span class="linenos" data-linenos="540 "></span></a><span class="cm">   * @param key</span>
<a id="__codelineno-9-541" name="__codelineno-9-541"></a><a href="#__codelineno-9-541"><span class="linenos" data-linenos="541 "></span></a><span class="cm">   * @return USize</span>
<a id="__codelineno-9-542" name="__codelineno-9-542"></a><a href="#__codelineno-9-542"><span class="linenos" data-linenos="542 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-543" name="__codelineno-9-543"></a><a href="#__codelineno-9-543"><span class="linenos" data-linenos="543 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">countGreaterOrEqualTo</span><span class="p">(</span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-544" name="__codelineno-9-544"></a><a href="#__codelineno-9-544"><span class="linenos" data-linenos="544 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">countGreater</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<a id="__codelineno-9-545" name="__codelineno-9-545"></a><a href="#__codelineno-9-545"><span class="linenos" data-linenos="545 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-546" name="__codelineno-9-546"></a><a href="#__codelineno-9-546"><span class="linenos" data-linenos="546 "></span></a>
<a id="__codelineno-9-547" name="__codelineno-9-547"></a><a href="#__codelineno-9-547"><span class="linenos" data-linenos="547 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-548" name="__codelineno-9-548"></a><a href="#__codelineno-9-548"><span class="linenos" data-linenos="548 "></span></a><span class="cm">   * Remove all entries that satisfy the filter condition.</span>
<a id="__codelineno-9-549" name="__codelineno-9-549"></a><a href="#__codelineno-9-549"><span class="linenos" data-linenos="549 "></span></a><span class="cm">   * @param filter</span>
<a id="__codelineno-9-550" name="__codelineno-9-550"></a><a href="#__codelineno-9-550"><span class="linenos" data-linenos="550 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-551" name="__codelineno-9-551"></a><a href="#__codelineno-9-551"><span class="linenos" data-linenos="551 "></span></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">removeAll</span><span class="p">(</span><span class="n">KeyValueFilter</span><span class="w"> </span><span class="n">filter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-552" name="__codelineno-9-552"></a><a href="#__codelineno-9-552"><span class="linenos" data-linenos="552 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span><span class="w"> </span><span class="n">keys</span><span class="p">;</span>
<a id="__codelineno-9-553" name="__codelineno-9-553"></a><a href="#__codelineno-9-553"><span class="linenos" data-linenos="553 "></span></a><span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">inorderTraversal</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-554" name="__codelineno-9-554"></a><a href="#__codelineno-9-554"><span class="linenos" data-linenos="554 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-555" name="__codelineno-9-555"></a><a href="#__codelineno-9-555"><span class="linenos" data-linenos="555 "></span></a><span class="w">        </span><span class="n">keys</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-556" name="__codelineno-9-556"></a><a href="#__codelineno-9-556"><span class="linenos" data-linenos="556 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-557" name="__codelineno-9-557"></a><a href="#__codelineno-9-557"><span class="linenos" data-linenos="557 "></span></a><span class="w">    </span><span class="p">});</span>
<a id="__codelineno-9-558" name="__codelineno-9-558"></a><a href="#__codelineno-9-558"><span class="linenos" data-linenos="558 "></span></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">&amp;</span><span class="n">key</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">keys</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-559" name="__codelineno-9-559"></a><a href="#__codelineno-9-559"><span class="linenos" data-linenos="559 "></span></a><span class="w">      </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">remove</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-560" name="__codelineno-9-560"></a><a href="#__codelineno-9-560"><span class="linenos" data-linenos="560 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-561" name="__codelineno-9-561"></a><a href="#__codelineno-9-561"><span class="linenos" data-linenos="561 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-562" name="__codelineno-9-562"></a><a href="#__codelineno-9-562"><span class="linenos" data-linenos="562 "></span></a>
<a id="__codelineno-9-563" name="__codelineno-9-563"></a><a href="#__codelineno-9-563"><span class="linenos" data-linenos="563 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-564" name="__codelineno-9-564"></a><a href="#__codelineno-9-564"><span class="linenos" data-linenos="564 "></span></a><span class="cm">   * Performs the given action for each key and value entry in this map.</span>
<a id="__codelineno-9-565" name="__codelineno-9-565"></a><a href="#__codelineno-9-565"><span class="linenos" data-linenos="565 "></span></a><span class="cm">   * The value is immutable for the action.</span>
<a id="__codelineno-9-566" name="__codelineno-9-566"></a><a href="#__codelineno-9-566"><span class="linenos" data-linenos="566 "></span></a><span class="cm">   * @param action</span>
<a id="__codelineno-9-567" name="__codelineno-9-567"></a><a href="#__codelineno-9-567"><span class="linenos" data-linenos="567 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-568" name="__codelineno-9-568"></a><a href="#__codelineno-9-568"><span class="linenos" data-linenos="568 "></span></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">forEach</span><span class="p">(</span><span class="n">KeyValueConsumer</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-569" name="__codelineno-9-569"></a><a href="#__codelineno-9-569"><span class="linenos" data-linenos="569 "></span></a><span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">inorderTraversal</span><span class="p">(</span>
<a id="__codelineno-9-570" name="__codelineno-9-570"></a><a href="#__codelineno-9-570"><span class="linenos" data-linenos="570 "></span></a><span class="w">        </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">action</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-9-571" name="__codelineno-9-571"></a><a href="#__codelineno-9-571"><span class="linenos" data-linenos="571 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-572" name="__codelineno-9-572"></a><a href="#__codelineno-9-572"><span class="linenos" data-linenos="572 "></span></a>
<a id="__codelineno-9-573" name="__codelineno-9-573"></a><a href="#__codelineno-9-573"><span class="linenos" data-linenos="573 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-574" name="__codelineno-9-574"></a><a href="#__codelineno-9-574"><span class="linenos" data-linenos="574 "></span></a><span class="cm">   * Performs the given action for each key and value entry in this map.</span>
<a id="__codelineno-9-575" name="__codelineno-9-575"></a><a href="#__codelineno-9-575"><span class="linenos" data-linenos="575 "></span></a><span class="cm">   * The value is mutable for the action.</span>
<a id="__codelineno-9-576" name="__codelineno-9-576"></a><a href="#__codelineno-9-576"><span class="linenos" data-linenos="576 "></span></a><span class="cm">   * @param action</span>
<a id="__codelineno-9-577" name="__codelineno-9-577"></a><a href="#__codelineno-9-577"><span class="linenos" data-linenos="577 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-578" name="__codelineno-9-578"></a><a href="#__codelineno-9-578"><span class="linenos" data-linenos="578 "></span></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">forEachMut</span><span class="p">(</span><span class="n">MutKeyValueConsumer</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-579" name="__codelineno-9-579"></a><a href="#__codelineno-9-579"><span class="linenos" data-linenos="579 "></span></a><span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">inorderTraversal</span><span class="p">(</span>
<a id="__codelineno-9-580" name="__codelineno-9-580"></a><a href="#__codelineno-9-580"><span class="linenos" data-linenos="580 "></span></a><span class="w">        </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">action</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-9-581" name="__codelineno-9-581"></a><a href="#__codelineno-9-581"><span class="linenos" data-linenos="581 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-582" name="__codelineno-9-582"></a><a href="#__codelineno-9-582"><span class="linenos" data-linenos="582 "></span></a>
<a id="__codelineno-9-583" name="__codelineno-9-583"></a><a href="#__codelineno-9-583"><span class="linenos" data-linenos="583 "></span></a><span class="w">  </span><span class="cm">/**</span>
<a id="__codelineno-9-584" name="__codelineno-9-584"></a><a href="#__codelineno-9-584"><span class="linenos" data-linenos="584 "></span></a><span class="cm">   * Returns a list containing all of the entries in this map.</span>
<a id="__codelineno-9-585" name="__codelineno-9-585"></a><a href="#__codelineno-9-585"><span class="linenos" data-linenos="585 "></span></a><span class="cm">   * @return SizeBalancedTreeMap&lt;Key, Value&gt;::EntryList</span>
<a id="__codelineno-9-586" name="__codelineno-9-586"></a><a href="#__codelineno-9-586"><span class="linenos" data-linenos="586 "></span></a><span class="cm">   */</span>
<a id="__codelineno-9-587" name="__codelineno-9-587"></a><a href="#__codelineno-9-587"><span class="linenos" data-linenos="587 "></span></a><span class="w">  </span><span class="n">EntryList</span><span class="w"> </span><span class="n">toEntryList</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-588" name="__codelineno-9-588"></a><a href="#__codelineno-9-588"><span class="linenos" data-linenos="588 "></span></a><span class="w">    </span><span class="n">EntryList</span><span class="w"> </span><span class="n">entryList</span><span class="p">;</span>
<a id="__codelineno-9-589" name="__codelineno-9-589"></a><a href="#__codelineno-9-589"><span class="linenos" data-linenos="589 "></span></a><span class="w">    </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">inorderTraversal</span><span class="p">(</span>
<a id="__codelineno-9-590" name="__codelineno-9-590"></a><a href="#__codelineno-9-590"><span class="linenos" data-linenos="590 "></span></a><span class="w">        </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">entryList</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">entry</span><span class="p">());</span><span class="w"> </span><span class="p">});</span>
<a id="__codelineno-9-591" name="__codelineno-9-591"></a><a href="#__codelineno-9-591"><span class="linenos" data-linenos="591 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">entryList</span><span class="p">;</span>
<a id="__codelineno-9-592" name="__codelineno-9-592"></a><a href="#__codelineno-9-592"><span class="linenos" data-linenos="592 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-593" name="__codelineno-9-593"></a><a href="#__codelineno-9-593"><span class="linenos" data-linenos="593 "></span></a>
<a id="__codelineno-9-594" name="__codelineno-9-594"></a><a href="#__codelineno-9-594"><span class="linenos" data-linenos="594 "></span></a><span class="w"> </span><span class="k">private</span><span class="o">:</span>
<a id="__codelineno-9-595" name="__codelineno-9-595"></a><a href="#__codelineno-9-595"><span class="linenos" data-linenos="595 "></span></a><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="n">USize</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-596" name="__codelineno-9-596"></a><a href="#__codelineno-9-596"><span class="linenos" data-linenos="596 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">size</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-9-597" name="__codelineno-9-597"></a><a href="#__codelineno-9-597"><span class="linenos" data-linenos="597 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-598" name="__codelineno-9-598"></a><a href="#__codelineno-9-598"><span class="linenos" data-linenos="598 "></span></a>
<a id="__codelineno-9-599" name="__codelineno-9-599"></a><a href="#__codelineno-9-599"><span class="linenos" data-linenos="599 "></span></a><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">rotateLeft</span><span class="p">(</span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-600" name="__codelineno-9-600"></a><a href="#__codelineno-9-600"><span class="linenos" data-linenos="600 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-9-601" name="__codelineno-9-601"></a><a href="#__codelineno-9-601"><span class="linenos" data-linenos="601 "></span></a><span class="w">    </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-602" name="__codelineno-9-602"></a><a href="#__codelineno-9-602"><span class="linenos" data-linenos="602 "></span></a><span class="w">    </span><span class="c1">//     |                       |</span>
<a id="__codelineno-9-603" name="__codelineno-9-603"></a><a href="#__codelineno-9-603"><span class="linenos" data-linenos="603 "></span></a><span class="w">    </span><span class="c1">//     N                       S</span>
<a id="__codelineno-9-604" name="__codelineno-9-604"></a><a href="#__codelineno-9-604"><span class="linenos" data-linenos="604 "></span></a><span class="w">    </span><span class="c1">//    / \     l-rotate(N)     / \</span>
<a id="__codelineno-9-605" name="__codelineno-9-605"></a><a href="#__codelineno-9-605"><span class="linenos" data-linenos="605 "></span></a><span class="c1">    //   L   S    ==========&gt;    N   R</span>
<a id="__codelineno-9-606" name="__codelineno-9-606"></a><a href="#__codelineno-9-606"><span class="linenos" data-linenos="606 "></span></a><span class="w">    </span><span class="c1">//      / \                 / \</span>
<a id="__codelineno-9-607" name="__codelineno-9-607"></a><a href="#__codelineno-9-607"><span class="linenos" data-linenos="607 "></span></a><span class="c1">    //     M   R               L   M</span>
<a id="__codelineno-9-608" name="__codelineno-9-608"></a><a href="#__codelineno-9-608"><span class="linenos" data-linenos="608 "></span></a><span class="w">    </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-609" name="__codelineno-9-609"></a><a href="#__codelineno-9-609"><span class="linenos" data-linenos="609 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-610" name="__codelineno-9-610"></a><a href="#__codelineno-9-610"><span class="linenos" data-linenos="610 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-611" name="__codelineno-9-611"></a><a href="#__codelineno-9-611"><span class="linenos" data-linenos="611 "></span></a><span class="w">    </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-9-612" name="__codelineno-9-612"></a><a href="#__codelineno-9-612"><span class="linenos" data-linenos="612 "></span></a>
<a id="__codelineno-9-613" name="__codelineno-9-613"></a><a href="#__codelineno-9-613"><span class="linenos" data-linenos="613 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-614" name="__codelineno-9-614"></a><a href="#__codelineno-9-614"><span class="linenos" data-linenos="614 "></span></a><span class="w">    </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-615" name="__codelineno-9-615"></a><a href="#__codelineno-9-615"><span class="linenos" data-linenos="615 "></span></a>
<a id="__codelineno-9-616" name="__codelineno-9-616"></a><a href="#__codelineno-9-616"><span class="linenos" data-linenos="616 "></span></a><span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-9-617" name="__codelineno-9-617"></a><a href="#__codelineno-9-617"><span class="linenos" data-linenos="617 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-618" name="__codelineno-9-618"></a><a href="#__codelineno-9-618"><span class="linenos" data-linenos="618 "></span></a>
<a id="__codelineno-9-619" name="__codelineno-9-619"></a><a href="#__codelineno-9-619"><span class="linenos" data-linenos="619 "></span></a><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">rotateRight</span><span class="p">(</span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-620" name="__codelineno-9-620"></a><a href="#__codelineno-9-620"><span class="linenos" data-linenos="620 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-9-621" name="__codelineno-9-621"></a><a href="#__codelineno-9-621"><span class="linenos" data-linenos="621 "></span></a><span class="w">    </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-622" name="__codelineno-9-622"></a><a href="#__codelineno-9-622"><span class="linenos" data-linenos="622 "></span></a><span class="w">    </span><span class="c1">//       |                   |</span>
<a id="__codelineno-9-623" name="__codelineno-9-623"></a><a href="#__codelineno-9-623"><span class="linenos" data-linenos="623 "></span></a><span class="w">    </span><span class="c1">//       N                   S</span>
<a id="__codelineno-9-624" name="__codelineno-9-624"></a><a href="#__codelineno-9-624"><span class="linenos" data-linenos="624 "></span></a><span class="w">    </span><span class="c1">//      / \   r-rotate(N)   / \</span>
<a id="__codelineno-9-625" name="__codelineno-9-625"></a><a href="#__codelineno-9-625"><span class="linenos" data-linenos="625 "></span></a><span class="c1">    //     S   R  ==========&gt;  L   N</span>
<a id="__codelineno-9-626" name="__codelineno-9-626"></a><a href="#__codelineno-9-626"><span class="linenos" data-linenos="626 "></span></a><span class="w">    </span><span class="c1">//    / \                     / \</span>
<a id="__codelineno-9-627" name="__codelineno-9-627"></a><a href="#__codelineno-9-627"><span class="linenos" data-linenos="627 "></span></a><span class="c1">    //   L   M                   M   R</span>
<a id="__codelineno-9-628" name="__codelineno-9-628"></a><a href="#__codelineno-9-628"><span class="linenos" data-linenos="628 "></span></a><span class="w">    </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-629" name="__codelineno-9-629"></a><a href="#__codelineno-9-629"><span class="linenos" data-linenos="629 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-630" name="__codelineno-9-630"></a><a href="#__codelineno-9-630"><span class="linenos" data-linenos="630 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-631" name="__codelineno-9-631"></a><a href="#__codelineno-9-631"><span class="linenos" data-linenos="631 "></span></a><span class="w">    </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-9-632" name="__codelineno-9-632"></a><a href="#__codelineno-9-632"><span class="linenos" data-linenos="632 "></span></a>
<a id="__codelineno-9-633" name="__codelineno-9-633"></a><a href="#__codelineno-9-633"><span class="linenos" data-linenos="633 "></span></a><span class="w">    </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-634" name="__codelineno-9-634"></a><a href="#__codelineno-9-634"><span class="linenos" data-linenos="634 "></span></a><span class="w">    </span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-635" name="__codelineno-9-635"></a><a href="#__codelineno-9-635"><span class="linenos" data-linenos="635 "></span></a>
<a id="__codelineno-9-636" name="__codelineno-9-636"></a><a href="#__codelineno-9-636"><span class="linenos" data-linenos="636 "></span></a><span class="w">    </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-9-637" name="__codelineno-9-637"></a><a href="#__codelineno-9-637"><span class="linenos" data-linenos="637 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-638" name="__codelineno-9-638"></a><a href="#__codelineno-9-638"><span class="linenos" data-linenos="638 "></span></a>
<a id="__codelineno-9-639" name="__codelineno-9-639"></a><a href="#__codelineno-9-639"><span class="linenos" data-linenos="639 "></span></a><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">swapNode</span><span class="p">(</span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">lhs</span><span class="p">,</span><span class="w"> </span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-640" name="__codelineno-9-640"></a><a href="#__codelineno-9-640"><span class="linenos" data-linenos="640 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">lhs</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-641" name="__codelineno-9-641"></a><a href="#__codelineno-9-641"><span class="linenos" data-linenos="641 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">lhs</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-9-642" name="__codelineno-9-642"></a><a href="#__codelineno-9-642"><span class="linenos" data-linenos="642 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">lhs</span><span class="p">,</span><span class="w"> </span><span class="n">rhs</span><span class="p">);</span>
<a id="__codelineno-9-643" name="__codelineno-9-643"></a><a href="#__codelineno-9-643"><span class="linenos" data-linenos="643 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-644" name="__codelineno-9-644"></a><a href="#__codelineno-9-644"><span class="linenos" data-linenos="644 "></span></a>
<a id="__codelineno-9-645" name="__codelineno-9-645"></a><a href="#__codelineno-9-645"><span class="linenos" data-linenos="645 "></span></a><span class="w">  </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-646" name="__codelineno-9-646"></a><a href="#__codelineno-9-646"><span class="linenos" data-linenos="646 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-647" name="__codelineno-9-647"></a><a href="#__codelineno-9-647"><span class="linenos" data-linenos="647 "></span></a><span class="w">      </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-648" name="__codelineno-9-648"></a><a href="#__codelineno-9-648"><span class="linenos" data-linenos="648 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-649" name="__codelineno-9-649"></a><a href="#__codelineno-9-649"><span class="linenos" data-linenos="649 "></span></a>
<a id="__codelineno-9-650" name="__codelineno-9-650"></a><a href="#__codelineno-9-650"><span class="linenos" data-linenos="650 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-651" name="__codelineno-9-651"></a><a href="#__codelineno-9-651"><span class="linenos" data-linenos="651 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-652" name="__codelineno-9-652"></a><a href="#__codelineno-9-652"><span class="linenos" data-linenos="652 "></span></a><span class="w">        </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-653" name="__codelineno-9-653"></a><a href="#__codelineno-9-653"><span class="linenos" data-linenos="653 "></span></a><span class="w">        </span><span class="c1">//       |                       |</span>
<a id="__codelineno-9-654" name="__codelineno-9-654"></a><a href="#__codelineno-9-654"><span class="linenos" data-linenos="654 "></span></a><span class="w">        </span><span class="c1">//       N                       L</span>
<a id="__codelineno-9-655" name="__codelineno-9-655"></a><a href="#__codelineno-9-655"><span class="linenos" data-linenos="655 "></span></a><span class="w">        </span><span class="c1">//      / \     r-rotate(N)     / \</span>
<a id="__codelineno-9-656" name="__codelineno-9-656"></a><a href="#__codelineno-9-656"><span class="linenos" data-linenos="656 "></span></a><span class="c1">        //     L  &lt;R&gt;   ==========&gt;   [M]  N</span>
<a id="__codelineno-9-657" name="__codelineno-9-657"></a><a href="#__codelineno-9-657"><span class="linenos" data-linenos="657 "></span></a><span class="w">        </span><span class="c1">//    /                             \</span>
<a id="__codelineno-9-658" name="__codelineno-9-658"></a><a href="#__codelineno-9-658"><span class="linenos" data-linenos="658 "></span></a><span class="c1">        //  [M]                             &lt;R&gt;</span>
<a id="__codelineno-9-659" name="__codelineno-9-659"></a><a href="#__codelineno-9-659"><span class="linenos" data-linenos="659 "></span></a><span class="w">        </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-660" name="__codelineno-9-660"></a><a href="#__codelineno-9-660"><span class="linenos" data-linenos="660 "></span></a><span class="w">        </span><span class="n">rotateRight</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-661" name="__codelineno-9-661"></a><a href="#__codelineno-9-661"><span class="linenos" data-linenos="661 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-9-662" name="__codelineno-9-662"></a><a href="#__codelineno-9-662"><span class="linenos" data-linenos="662 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-663" name="__codelineno-9-663"></a><a href="#__codelineno-9-663"><span class="linenos" data-linenos="663 "></span></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-664" name="__codelineno-9-664"></a><a href="#__codelineno-9-664"><span class="linenos" data-linenos="664 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-665" name="__codelineno-9-665"></a><a href="#__codelineno-9-665"><span class="linenos" data-linenos="665 "></span></a><span class="w">        </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-666" name="__codelineno-9-666"></a><a href="#__codelineno-9-666"><span class="linenos" data-linenos="666 "></span></a><span class="w">        </span><span class="c1">//     |                     |                      |</span>
<a id="__codelineno-9-667" name="__codelineno-9-667"></a><a href="#__codelineno-9-667"><span class="linenos" data-linenos="667 "></span></a><span class="w">        </span><span class="c1">//     N                     N                     [M]</span>
<a id="__codelineno-9-668" name="__codelineno-9-668"></a><a href="#__codelineno-9-668"><span class="linenos" data-linenos="668 "></span></a><span class="w">        </span><span class="c1">//    / \    l-rotate(L)    / \     r-rotate(N)    / \</span>
<a id="__codelineno-9-669" name="__codelineno-9-669"></a><a href="#__codelineno-9-669"><span class="linenos" data-linenos="669 "></span></a><span class="c1">        //   L  &lt;R&gt;  ==========&gt;  [M] &lt;R&gt;   ==========&gt;   L   N</span>
<a id="__codelineno-9-670" name="__codelineno-9-670"></a><a href="#__codelineno-9-670"><span class="linenos" data-linenos="670 "></span></a><span class="w">        </span><span class="c1">//    \                   /                            \</span>
<a id="__codelineno-9-671" name="__codelineno-9-671"></a><a href="#__codelineno-9-671"><span class="linenos" data-linenos="671 "></span></a><span class="c1">        //    [M]                L                             &lt;R&gt;</span>
<a id="__codelineno-9-672" name="__codelineno-9-672"></a><a href="#__codelineno-9-672"><span class="linenos" data-linenos="672 "></span></a><span class="w">        </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-673" name="__codelineno-9-673"></a><a href="#__codelineno-9-673"><span class="linenos" data-linenos="673 "></span></a><span class="w">        </span><span class="n">rotateLeft</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-9-674" name="__codelineno-9-674"></a><a href="#__codelineno-9-674"><span class="linenos" data-linenos="674 "></span></a><span class="w">        </span><span class="n">rotateRight</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-675" name="__codelineno-9-675"></a><a href="#__codelineno-9-675"><span class="linenos" data-linenos="675 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-9-676" name="__codelineno-9-676"></a><a href="#__codelineno-9-676"><span class="linenos" data-linenos="676 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-9-677" name="__codelineno-9-677"></a><a href="#__codelineno-9-677"><span class="linenos" data-linenos="677 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-678" name="__codelineno-9-678"></a><a href="#__codelineno-9-678"><span class="linenos" data-linenos="678 "></span></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-679" name="__codelineno-9-679"></a><a href="#__codelineno-9-679"><span class="linenos" data-linenos="679 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-680" name="__codelineno-9-680"></a><a href="#__codelineno-9-680"><span class="linenos" data-linenos="680 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-681" name="__codelineno-9-681"></a><a href="#__codelineno-9-681"><span class="linenos" data-linenos="681 "></span></a>
<a id="__codelineno-9-682" name="__codelineno-9-682"></a><a href="#__codelineno-9-682"><span class="linenos" data-linenos="682 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-683" name="__codelineno-9-683"></a><a href="#__codelineno-9-683"><span class="linenos" data-linenos="683 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-684" name="__codelineno-9-684"></a><a href="#__codelineno-9-684"><span class="linenos" data-linenos="684 "></span></a><span class="w">        </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-685" name="__codelineno-9-685"></a><a href="#__codelineno-9-685"><span class="linenos" data-linenos="685 "></span></a><span class="w">        </span><span class="c1">//     |                       |</span>
<a id="__codelineno-9-686" name="__codelineno-9-686"></a><a href="#__codelineno-9-686"><span class="linenos" data-linenos="686 "></span></a><span class="w">        </span><span class="c1">//     N                       R</span>
<a id="__codelineno-9-687" name="__codelineno-9-687"></a><a href="#__codelineno-9-687"><span class="linenos" data-linenos="687 "></span></a><span class="w">        </span><span class="c1">//    / \     l-rotate(N)     / \</span>
<a id="__codelineno-9-688" name="__codelineno-9-688"></a><a href="#__codelineno-9-688"><span class="linenos" data-linenos="688 "></span></a><span class="c1">        //  &lt;L&gt;  R    ==========&gt;    N  [M]</span>
<a id="__codelineno-9-689" name="__codelineno-9-689"></a><a href="#__codelineno-9-689"><span class="linenos" data-linenos="689 "></span></a><span class="w">        </span><span class="c1">//        \                 /</span>
<a id="__codelineno-9-690" name="__codelineno-9-690"></a><a href="#__codelineno-9-690"><span class="linenos" data-linenos="690 "></span></a><span class="w">        </span><span class="c1">//        [M]             &lt;L&gt;</span>
<a id="__codelineno-9-691" name="__codelineno-9-691"></a><a href="#__codelineno-9-691"><span class="linenos" data-linenos="691 "></span></a><span class="w">        </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-692" name="__codelineno-9-692"></a><a href="#__codelineno-9-692"><span class="linenos" data-linenos="692 "></span></a><span class="w">        </span><span class="n">rotateLeft</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-693" name="__codelineno-9-693"></a><a href="#__codelineno-9-693"><span class="linenos" data-linenos="693 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-9-694" name="__codelineno-9-694"></a><a href="#__codelineno-9-694"><span class="linenos" data-linenos="694 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-695" name="__codelineno-9-695"></a><a href="#__codelineno-9-695"><span class="linenos" data-linenos="695 "></span></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-696" name="__codelineno-9-696"></a><a href="#__codelineno-9-696"><span class="linenos" data-linenos="696 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-697" name="__codelineno-9-697"></a><a href="#__codelineno-9-697"><span class="linenos" data-linenos="697 "></span></a><span class="w">        </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-698" name="__codelineno-9-698"></a><a href="#__codelineno-9-698"><span class="linenos" data-linenos="698 "></span></a><span class="w">        </span><span class="c1">//     |                     |                      |</span>
<a id="__codelineno-9-699" name="__codelineno-9-699"></a><a href="#__codelineno-9-699"><span class="linenos" data-linenos="699 "></span></a><span class="w">        </span><span class="c1">//     N                     N                     [M]</span>
<a id="__codelineno-9-700" name="__codelineno-9-700"></a><a href="#__codelineno-9-700"><span class="linenos" data-linenos="700 "></span></a><span class="w">        </span><span class="c1">//    / \    r-rotate(R)    / \     l-rotate(N)    / \</span>
<a id="__codelineno-9-701" name="__codelineno-9-701"></a><a href="#__codelineno-9-701"><span class="linenos" data-linenos="701 "></span></a><span class="c1">        //  &lt;L&gt;  R   ==========&gt;  &lt;L&gt; [M]   ==========&gt;   N   R</span>
<a id="__codelineno-9-702" name="__codelineno-9-702"></a><a href="#__codelineno-9-702"><span class="linenos" data-linenos="702 "></span></a><span class="w">        </span><span class="c1">//      /                       \                /</span>
<a id="__codelineno-9-703" name="__codelineno-9-703"></a><a href="#__codelineno-9-703"><span class="linenos" data-linenos="703 "></span></a><span class="w">        </span><span class="c1">//    [M]                        R             &lt;L&gt;</span>
<a id="__codelineno-9-704" name="__codelineno-9-704"></a><a href="#__codelineno-9-704"><span class="linenos" data-linenos="704 "></span></a><span class="w">        </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-705" name="__codelineno-9-705"></a><a href="#__codelineno-9-705"><span class="linenos" data-linenos="705 "></span></a><span class="w">        </span><span class="n">rotateRight</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-9-706" name="__codelineno-9-706"></a><a href="#__codelineno-9-706"><span class="linenos" data-linenos="706 "></span></a><span class="w">        </span><span class="n">rotateLeft</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-707" name="__codelineno-9-707"></a><a href="#__codelineno-9-707"><span class="linenos" data-linenos="707 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
<a id="__codelineno-9-708" name="__codelineno-9-708"></a><a href="#__codelineno-9-708"><span class="linenos" data-linenos="708 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-9-709" name="__codelineno-9-709"></a><a href="#__codelineno-9-709"><span class="linenos" data-linenos="709 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-710" name="__codelineno-9-710"></a><a href="#__codelineno-9-710"><span class="linenos" data-linenos="710 "></span></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-711" name="__codelineno-9-711"></a><a href="#__codelineno-9-711"><span class="linenos" data-linenos="711 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-712" name="__codelineno-9-712"></a><a href="#__codelineno-9-712"><span class="linenos" data-linenos="712 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-713" name="__codelineno-9-713"></a><a href="#__codelineno-9-713"><span class="linenos" data-linenos="713 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-714" name="__codelineno-9-714"></a><a href="#__codelineno-9-714"><span class="linenos" data-linenos="714 "></span></a>
<a id="__codelineno-9-715" name="__codelineno-9-715"></a><a href="#__codelineno-9-715"><span class="linenos" data-linenos="715 "></span></a><span class="w">  </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">getNodeOrProvide</span><span class="p">(</span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">NodeProvider</span><span class="w"> </span><span class="n">provide</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-716" name="__codelineno-9-716"></a><a href="#__codelineno-9-716"><span class="linenos" data-linenos="716 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-9-717" name="__codelineno-9-717"></a><a href="#__codelineno-9-717"><span class="linenos" data-linenos="717 "></span></a>
<a id="__codelineno-9-718" name="__codelineno-9-718"></a><a href="#__codelineno-9-718"><span class="linenos" data-linenos="718 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-719" name="__codelineno-9-719"></a><a href="#__codelineno-9-719"><span class="linenos" data-linenos="719 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-9-720" name="__codelineno-9-720"></a><a href="#__codelineno-9-720"><span class="linenos" data-linenos="720 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-721" name="__codelineno-9-721"></a><a href="#__codelineno-9-721"><span class="linenos" data-linenos="721 "></span></a>
<a id="__codelineno-9-722" name="__codelineno-9-722"></a><a href="#__codelineno-9-722"><span class="linenos" data-linenos="722 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-723" name="__codelineno-9-723"></a><a href="#__codelineno-9-723"><span class="linenos" data-linenos="723 "></span></a>
<a id="__codelineno-9-724" name="__codelineno-9-724"></a><a href="#__codelineno-9-724"><span class="linenos" data-linenos="724 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<a id="__codelineno-9-725" name="__codelineno-9-725"></a><a href="#__codelineno-9-725"><span class="linenos" data-linenos="725 "></span></a>
<a id="__codelineno-9-726" name="__codelineno-9-726"></a><a href="#__codelineno-9-726"><span class="linenos" data-linenos="726 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-727" name="__codelineno-9-727"></a><a href="#__codelineno-9-727"><span class="linenos" data-linenos="727 "></span></a><span class="w">      </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-9-728" name="__codelineno-9-728"></a><a href="#__codelineno-9-728"><span class="linenos" data-linenos="728 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-729" name="__codelineno-9-729"></a><a href="#__codelineno-9-729"><span class="linenos" data-linenos="729 "></span></a><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">provide</span><span class="p">();</span>
<a id="__codelineno-9-730" name="__codelineno-9-730"></a><a href="#__codelineno-9-730"><span class="linenos" data-linenos="730 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-731" name="__codelineno-9-731"></a><a href="#__codelineno-9-731"><span class="linenos" data-linenos="731 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-732" name="__codelineno-9-732"></a><a href="#__codelineno-9-732"><span class="linenos" data-linenos="732 "></span></a><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getNodeOrProvide</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">provide</span><span class="p">);</span>
<a id="__codelineno-9-733" name="__codelineno-9-733"></a><a href="#__codelineno-9-733"><span class="linenos" data-linenos="733 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-734" name="__codelineno-9-734"></a><a href="#__codelineno-9-734"><span class="linenos" data-linenos="734 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-735" name="__codelineno-9-735"></a><a href="#__codelineno-9-735"><span class="linenos" data-linenos="735 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-736" name="__codelineno-9-736"></a><a href="#__codelineno-9-736"><span class="linenos" data-linenos="736 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-737" name="__codelineno-9-737"></a><a href="#__codelineno-9-737"><span class="linenos" data-linenos="737 "></span></a><span class="w">      </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-9-738" name="__codelineno-9-738"></a><a href="#__codelineno-9-738"><span class="linenos" data-linenos="738 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-739" name="__codelineno-9-739"></a><a href="#__codelineno-9-739"><span class="linenos" data-linenos="739 "></span></a><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">provide</span><span class="p">();</span>
<a id="__codelineno-9-740" name="__codelineno-9-740"></a><a href="#__codelineno-9-740"><span class="linenos" data-linenos="740 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-741" name="__codelineno-9-741"></a><a href="#__codelineno-9-741"><span class="linenos" data-linenos="741 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-742" name="__codelineno-9-742"></a><a href="#__codelineno-9-742"><span class="linenos" data-linenos="742 "></span></a><span class="w">        </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getNodeOrProvide</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">provide</span><span class="p">);</span>
<a id="__codelineno-9-743" name="__codelineno-9-743"></a><a href="#__codelineno-9-743"><span class="linenos" data-linenos="743 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-744" name="__codelineno-9-744"></a><a href="#__codelineno-9-744"><span class="linenos" data-linenos="744 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-745" name="__codelineno-9-745"></a><a href="#__codelineno-9-745"><span class="linenos" data-linenos="745 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-746" name="__codelineno-9-746"></a><a href="#__codelineno-9-746"><span class="linenos" data-linenos="746 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-747" name="__codelineno-9-747"></a><a href="#__codelineno-9-747"><span class="linenos" data-linenos="747 "></span></a>
<a id="__codelineno-9-748" name="__codelineno-9-748"></a><a href="#__codelineno-9-748"><span class="linenos" data-linenos="748 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<a id="__codelineno-9-749" name="__codelineno-9-749"></a><a href="#__codelineno-9-749"><span class="linenos" data-linenos="749 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-750" name="__codelineno-9-750"></a><a href="#__codelineno-9-750"><span class="linenos" data-linenos="750 "></span></a>
<a id="__codelineno-9-751" name="__codelineno-9-751"></a><a href="#__codelineno-9-751"><span class="linenos" data-linenos="751 "></span></a><span class="w">  </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">getNode</span><span class="p">(</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-752" name="__codelineno-9-752"></a><a href="#__codelineno-9-752"><span class="linenos" data-linenos="752 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-9-753" name="__codelineno-9-753"></a><a href="#__codelineno-9-753"><span class="linenos" data-linenos="753 "></span></a>
<a id="__codelineno-9-754" name="__codelineno-9-754"></a><a href="#__codelineno-9-754"><span class="linenos" data-linenos="754 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-755" name="__codelineno-9-755"></a><a href="#__codelineno-9-755"><span class="linenos" data-linenos="755 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-9-756" name="__codelineno-9-756"></a><a href="#__codelineno-9-756"><span class="linenos" data-linenos="756 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-757" name="__codelineno-9-757"></a><a href="#__codelineno-9-757"><span class="linenos" data-linenos="757 "></span></a>
<a id="__codelineno-9-758" name="__codelineno-9-758"></a><a href="#__codelineno-9-758"><span class="linenos" data-linenos="758 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-759" name="__codelineno-9-759"></a><a href="#__codelineno-9-759"><span class="linenos" data-linenos="759 "></span></a><span class="w">      </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-9-760" name="__codelineno-9-760"></a><a href="#__codelineno-9-760"><span class="linenos" data-linenos="760 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">getNode</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-761" name="__codelineno-9-761"></a><a href="#__codelineno-9-761"><span class="linenos" data-linenos="761 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-762" name="__codelineno-9-762"></a><a href="#__codelineno-9-762"><span class="linenos" data-linenos="762 "></span></a><span class="w">      </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-9-763" name="__codelineno-9-763"></a><a href="#__codelineno-9-763"><span class="linenos" data-linenos="763 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">getNode</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-764" name="__codelineno-9-764"></a><a href="#__codelineno-9-764"><span class="linenos" data-linenos="764 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-765" name="__codelineno-9-765"></a><a href="#__codelineno-9-765"><span class="linenos" data-linenos="765 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-766" name="__codelineno-9-766"></a><a href="#__codelineno-9-766"><span class="linenos" data-linenos="766 "></span></a>
<a id="__codelineno-9-767" name="__codelineno-9-767"></a><a href="#__codelineno-9-767"><span class="linenos" data-linenos="767 "></span></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">insert</span><span class="p">(</span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">V</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-768" name="__codelineno-9-768"></a><a href="#__codelineno-9-768"><span class="linenos" data-linenos="768 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-9-769" name="__codelineno-9-769"></a><a href="#__codelineno-9-769"><span class="linenos" data-linenos="769 "></span></a>
<a id="__codelineno-9-770" name="__codelineno-9-770"></a><a href="#__codelineno-9-770"><span class="linenos" data-linenos="770 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-771" name="__codelineno-9-771"></a><a href="#__codelineno-9-771"><span class="linenos" data-linenos="771 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">replace</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-772" name="__codelineno-9-772"></a><a href="#__codelineno-9-772"><span class="linenos" data-linenos="772 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-9-773" name="__codelineno-9-773"></a><a href="#__codelineno-9-773"><span class="linenos" data-linenos="773 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-774" name="__codelineno-9-774"></a><a href="#__codelineno-9-774"><span class="linenos" data-linenos="774 "></span></a><span class="w">      </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-775" name="__codelineno-9-775"></a><a href="#__codelineno-9-775"><span class="linenos" data-linenos="775 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-776" name="__codelineno-9-776"></a><a href="#__codelineno-9-776"><span class="linenos" data-linenos="776 "></span></a>
<a id="__codelineno-9-777" name="__codelineno-9-777"></a><a href="#__codelineno-9-777"><span class="linenos" data-linenos="777 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-778" name="__codelineno-9-778"></a><a href="#__codelineno-9-778"><span class="linenos" data-linenos="778 "></span></a>
<a id="__codelineno-9-779" name="__codelineno-9-779"></a><a href="#__codelineno-9-779"><span class="linenos" data-linenos="779 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-780" name="__codelineno-9-780"></a><a href="#__codelineno-9-780"><span class="linenos" data-linenos="780 "></span></a><span class="w">      </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-9-781" name="__codelineno-9-781"></a><a href="#__codelineno-9-781"><span class="linenos" data-linenos="781 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-782" name="__codelineno-9-782"></a><a href="#__codelineno-9-782"><span class="linenos" data-linenos="782 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-9-783" name="__codelineno-9-783"></a><a href="#__codelineno-9-783"><span class="linenos" data-linenos="783 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-784" name="__codelineno-9-784"></a><a href="#__codelineno-9-784"><span class="linenos" data-linenos="784 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-785" name="__codelineno-9-785"></a><a href="#__codelineno-9-785"><span class="linenos" data-linenos="785 "></span></a><span class="w">        </span><span class="n">insert</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="p">);</span>
<a id="__codelineno-9-786" name="__codelineno-9-786"></a><a href="#__codelineno-9-786"><span class="linenos" data-linenos="786 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-787" name="__codelineno-9-787"></a><a href="#__codelineno-9-787"><span class="linenos" data-linenos="787 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-788" name="__codelineno-9-788"></a><a href="#__codelineno-9-788"><span class="linenos" data-linenos="788 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-789" name="__codelineno-9-789"></a><a href="#__codelineno-9-789"><span class="linenos" data-linenos="789 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-790" name="__codelineno-9-790"></a><a href="#__codelineno-9-790"><span class="linenos" data-linenos="790 "></span></a><span class="w">      </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-9-791" name="__codelineno-9-791"></a><a href="#__codelineno-9-791"><span class="linenos" data-linenos="791 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-792" name="__codelineno-9-792"></a><a href="#__codelineno-9-792"><span class="linenos" data-linenos="792 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Node</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
<a id="__codelineno-9-793" name="__codelineno-9-793"></a><a href="#__codelineno-9-793"><span class="linenos" data-linenos="793 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-794" name="__codelineno-9-794"></a><a href="#__codelineno-9-794"><span class="linenos" data-linenos="794 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-795" name="__codelineno-9-795"></a><a href="#__codelineno-9-795"><span class="linenos" data-linenos="795 "></span></a><span class="w">        </span><span class="n">insert</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="p">);</span>
<a id="__codelineno-9-796" name="__codelineno-9-796"></a><a href="#__codelineno-9-796"><span class="linenos" data-linenos="796 "></span></a><span class="w">        </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-797" name="__codelineno-9-797"></a><a href="#__codelineno-9-797"><span class="linenos" data-linenos="797 "></span></a><span class="w">        </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-798" name="__codelineno-9-798"></a><a href="#__codelineno-9-798"><span class="linenos" data-linenos="798 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-799" name="__codelineno-9-799"></a><a href="#__codelineno-9-799"><span class="linenos" data-linenos="799 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-800" name="__codelineno-9-800"></a><a href="#__codelineno-9-800"><span class="linenos" data-linenos="800 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-801" name="__codelineno-9-801"></a><a href="#__codelineno-9-801"><span class="linenos" data-linenos="801 "></span></a>
<a id="__codelineno-9-802" name="__codelineno-9-802"></a><a href="#__codelineno-9-802"><span class="linenos" data-linenos="802 "></span></a><span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">remove</span><span class="p">(</span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">NodeConsumer</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-803" name="__codelineno-9-803"></a><a href="#__codelineno-9-803"><span class="linenos" data-linenos="803 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">);</span>
<a id="__codelineno-9-804" name="__codelineno-9-804"></a><a href="#__codelineno-9-804"><span class="linenos" data-linenos="804 "></span></a>
<a id="__codelineno-9-805" name="__codelineno-9-805"></a><a href="#__codelineno-9-805"><span class="linenos" data-linenos="805 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-806" name="__codelineno-9-806"></a><a href="#__codelineno-9-806"><span class="linenos" data-linenos="806 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-807" name="__codelineno-9-807"></a><a href="#__codelineno-9-807"><span class="linenos" data-linenos="807 "></span></a><span class="w">        </span><span class="cm">/* key &lt; node-&gt;key */</span>
<a id="__codelineno-9-808" name="__codelineno-9-808"></a><a href="#__codelineno-9-808"><span class="linenos" data-linenos="808 "></span></a><span class="w">        </span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-809" name="__codelineno-9-809"></a><a href="#__codelineno-9-809"><span class="linenos" data-linenos="809 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">remove</span><span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-810" name="__codelineno-9-810"></a><a href="#__codelineno-9-810"><span class="linenos" data-linenos="810 "></span></a><span class="w">          </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-811" name="__codelineno-9-811"></a><a href="#__codelineno-9-811"><span class="linenos" data-linenos="811 "></span></a><span class="w">          </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-812" name="__codelineno-9-812"></a><a href="#__codelineno-9-812"><span class="linenos" data-linenos="812 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="__codelineno-9-813" name="__codelineno-9-813"></a><a href="#__codelineno-9-813"><span class="linenos" data-linenos="813 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-814" name="__codelineno-9-814"></a><a href="#__codelineno-9-814"><span class="linenos" data-linenos="814 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<a id="__codelineno-9-815" name="__codelineno-9-815"></a><a href="#__codelineno-9-815"><span class="linenos" data-linenos="815 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-816" name="__codelineno-9-816"></a><a href="#__codelineno-9-816"><span class="linenos" data-linenos="816 "></span></a><span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-817" name="__codelineno-9-817"></a><a href="#__codelineno-9-817"><span class="linenos" data-linenos="817 "></span></a><span class="w">        </span><span class="cm">/* key &gt; node-&gt;key */</span>
<a id="__codelineno-9-818" name="__codelineno-9-818"></a><a href="#__codelineno-9-818"><span class="linenos" data-linenos="818 "></span></a><span class="w">        </span><span class="n">NodePtr</span><span class="w"> </span><span class="o">&amp;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-819" name="__codelineno-9-819"></a><a href="#__codelineno-9-819"><span class="linenos" data-linenos="819 "></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">right</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">remove</span><span class="p">(</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-820" name="__codelineno-9-820"></a><a href="#__codelineno-9-820"><span class="linenos" data-linenos="820 "></span></a><span class="w">          </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-821" name="__codelineno-9-821"></a><a href="#__codelineno-9-821"><span class="linenos" data-linenos="821 "></span></a><span class="w">          </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-822" name="__codelineno-9-822"></a><a href="#__codelineno-9-822"><span class="linenos" data-linenos="822 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="__codelineno-9-823" name="__codelineno-9-823"></a><a href="#__codelineno-9-823"><span class="linenos" data-linenos="823 "></span></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-824" name="__codelineno-9-824"></a><a href="#__codelineno-9-824"><span class="linenos" data-linenos="824 "></span></a><span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<a id="__codelineno-9-825" name="__codelineno-9-825"></a><a href="#__codelineno-9-825"><span class="linenos" data-linenos="825 "></span></a><span class="w">        </span><span class="p">}</span>
<a id="__codelineno-9-826" name="__codelineno-9-826"></a><a href="#__codelineno-9-826"><span class="linenos" data-linenos="826 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-827" name="__codelineno-9-827"></a><a href="#__codelineno-9-827"><span class="linenos" data-linenos="827 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-828" name="__codelineno-9-828"></a><a href="#__codelineno-9-828"><span class="linenos" data-linenos="828 "></span></a>
<a id="__codelineno-9-829" name="__codelineno-9-829"></a><a href="#__codelineno-9-829"><span class="linenos" data-linenos="829 "></span></a><span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">);</span>
<a id="__codelineno-9-830" name="__codelineno-9-830"></a><a href="#__codelineno-9-830"><span class="linenos" data-linenos="830 "></span></a><span class="w">    </span><span class="n">action</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-831" name="__codelineno-9-831"></a><a href="#__codelineno-9-831"><span class="linenos" data-linenos="831 "></span></a>
<a id="__codelineno-9-832" name="__codelineno-9-832"></a><a href="#__codelineno-9-832"><span class="linenos" data-linenos="832 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">isLeaf</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-833" name="__codelineno-9-833"></a><a href="#__codelineno-9-833"><span class="linenos" data-linenos="833 "></span></a><span class="w">      </span><span class="c1">// Case 1: no child</span>
<a id="__codelineno-9-834" name="__codelineno-9-834"></a><a href="#__codelineno-9-834"><span class="linenos" data-linenos="834 "></span></a><span class="w">      </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<a id="__codelineno-9-835" name="__codelineno-9-835"></a><a href="#__codelineno-9-835"><span class="linenos" data-linenos="835 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-836" name="__codelineno-9-836"></a><a href="#__codelineno-9-836"><span class="linenos" data-linenos="836 "></span></a><span class="w">      </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-837" name="__codelineno-9-837"></a><a href="#__codelineno-9-837"><span class="linenos" data-linenos="837 "></span></a><span class="w">      </span><span class="c1">// Case 2: left child only</span>
<a id="__codelineno-9-838" name="__codelineno-9-838"></a><a href="#__codelineno-9-838"><span class="linenos" data-linenos="838 "></span></a><span class="w">      </span><span class="c1">//     P</span>
<a id="__codelineno-9-839" name="__codelineno-9-839"></a><a href="#__codelineno-9-839"><span class="linenos" data-linenos="839 "></span></a><span class="w">      </span><span class="c1">//     |  remove(N)  P</span>
<a id="__codelineno-9-840" name="__codelineno-9-840"></a><a href="#__codelineno-9-840"><span class="linenos" data-linenos="840 "></span></a><span class="w">      </span><span class="c1">//     N  ========&gt;  |</span>
<a id="__codelineno-9-841" name="__codelineno-9-841"></a><a href="#__codelineno-9-841"><span class="linenos" data-linenos="841 "></span></a><span class="w">      </span><span class="c1">//    /              L</span>
<a id="__codelineno-9-842" name="__codelineno-9-842"></a><a href="#__codelineno-9-842"><span class="linenos" data-linenos="842 "></span></a><span class="w">      </span><span class="c1">//   L</span>
<a id="__codelineno-9-843" name="__codelineno-9-843"></a><a href="#__codelineno-9-843"><span class="linenos" data-linenos="843 "></span></a><span class="w">      </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-844" name="__codelineno-9-844"></a><a href="#__codelineno-9-844"><span class="linenos" data-linenos="844 "></span></a><span class="w">      </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-845" name="__codelineno-9-845"></a><a href="#__codelineno-9-845"><span class="linenos" data-linenos="845 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-846" name="__codelineno-9-846"></a><a href="#__codelineno-9-846"><span class="linenos" data-linenos="846 "></span></a><span class="w">      </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-847" name="__codelineno-9-847"></a><a href="#__codelineno-9-847"><span class="linenos" data-linenos="847 "></span></a><span class="w">      </span><span class="c1">// Case 3: right child only</span>
<a id="__codelineno-9-848" name="__codelineno-9-848"></a><a href="#__codelineno-9-848"><span class="linenos" data-linenos="848 "></span></a><span class="w">      </span><span class="c1">//   P</span>
<a id="__codelineno-9-849" name="__codelineno-9-849"></a><a href="#__codelineno-9-849"><span class="linenos" data-linenos="849 "></span></a><span class="w">      </span><span class="c1">//   |    remove(N)  P</span>
<a id="__codelineno-9-850" name="__codelineno-9-850"></a><a href="#__codelineno-9-850"><span class="linenos" data-linenos="850 "></span></a><span class="w">      </span><span class="c1">//   N    ========&gt;  |</span>
<a id="__codelineno-9-851" name="__codelineno-9-851"></a><a href="#__codelineno-9-851"><span class="linenos" data-linenos="851 "></span></a><span class="w">      </span><span class="c1">//    \              R</span>
<a id="__codelineno-9-852" name="__codelineno-9-852"></a><a href="#__codelineno-9-852"><span class="linenos" data-linenos="852 "></span></a><span class="w">      </span><span class="c1">//     R</span>
<a id="__codelineno-9-853" name="__codelineno-9-853"></a><a href="#__codelineno-9-853"><span class="linenos" data-linenos="853 "></span></a><span class="w">      </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-854" name="__codelineno-9-854"></a><a href="#__codelineno-9-854"><span class="linenos" data-linenos="854 "></span></a><span class="w">      </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-855" name="__codelineno-9-855"></a><a href="#__codelineno-9-855"><span class="linenos" data-linenos="855 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-856" name="__codelineno-9-856"></a><a href="#__codelineno-9-856"><span class="linenos" data-linenos="856 "></span></a><span class="w">      </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-857" name="__codelineno-9-857"></a><a href="#__codelineno-9-857"><span class="linenos" data-linenos="857 "></span></a><span class="w">      </span><span class="c1">// Case 4: both left and right child, right child has no left child</span>
<a id="__codelineno-9-858" name="__codelineno-9-858"></a><a href="#__codelineno-9-858"><span class="linenos" data-linenos="858 "></span></a><span class="w">      </span><span class="c1">//    |                 |</span>
<a id="__codelineno-9-859" name="__codelineno-9-859"></a><a href="#__codelineno-9-859"><span class="linenos" data-linenos="859 "></span></a><span class="w">      </span><span class="c1">//    N    remove(N)    R</span>
<a id="__codelineno-9-860" name="__codelineno-9-860"></a><a href="#__codelineno-9-860"><span class="linenos" data-linenos="860 "></span></a><span class="w">      </span><span class="c1">//   / \   ========&gt;   /</span>
<a id="__codelineno-9-861" name="__codelineno-9-861"></a><a href="#__codelineno-9-861"><span class="linenos" data-linenos="861 "></span></a><span class="w">      </span><span class="c1">//  L   R             L</span>
<a id="__codelineno-9-862" name="__codelineno-9-862"></a><a href="#__codelineno-9-862"><span class="linenos" data-linenos="862 "></span></a><span class="w">      </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-863" name="__codelineno-9-863"></a><a href="#__codelineno-9-863"><span class="linenos" data-linenos="863 "></span></a><span class="w">      </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-864" name="__codelineno-9-864"></a><a href="#__codelineno-9-864"><span class="linenos" data-linenos="864 "></span></a><span class="w">      </span><span class="n">swapNode</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="p">);</span>
<a id="__codelineno-9-865" name="__codelineno-9-865"></a><a href="#__codelineno-9-865"><span class="linenos" data-linenos="865 "></span></a><span class="w">      </span><span class="n">right</span><span class="o">-&gt;</span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-866" name="__codelineno-9-866"></a><a href="#__codelineno-9-866"><span class="linenos" data-linenos="866 "></span></a><span class="w">      </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-867" name="__codelineno-9-867"></a><a href="#__codelineno-9-867"><span class="linenos" data-linenos="867 "></span></a><span class="w">      </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-868" name="__codelineno-9-868"></a><a href="#__codelineno-9-868"><span class="linenos" data-linenos="868 "></span></a><span class="w">      </span><span class="n">fixBalance</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-869" name="__codelineno-9-869"></a><a href="#__codelineno-9-869"><span class="linenos" data-linenos="869 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-870" name="__codelineno-9-870"></a><a href="#__codelineno-9-870"><span class="linenos" data-linenos="870 "></span></a><span class="w">      </span><span class="c1">// clang-format off</span>
<a id="__codelineno-9-871" name="__codelineno-9-871"></a><a href="#__codelineno-9-871"><span class="linenos" data-linenos="871 "></span></a><span class="w">      </span><span class="c1">// Case 5: both left and right child, right child is not a leaf</span>
<a id="__codelineno-9-872" name="__codelineno-9-872"></a><a href="#__codelineno-9-872"><span class="linenos" data-linenos="872 "></span></a><span class="w">      </span><span class="c1">//   Step 1. find the node N with the smallest key</span>
<a id="__codelineno-9-873" name="__codelineno-9-873"></a><a href="#__codelineno-9-873"><span class="linenos" data-linenos="873 "></span></a><span class="w">      </span><span class="c1">//           and its parent P on the right subtree</span>
<a id="__codelineno-9-874" name="__codelineno-9-874"></a><a href="#__codelineno-9-874"><span class="linenos" data-linenos="874 "></span></a><span class="w">      </span><span class="c1">//   Step 2. swap S and N</span>
<a id="__codelineno-9-875" name="__codelineno-9-875"></a><a href="#__codelineno-9-875"><span class="linenos" data-linenos="875 "></span></a><span class="w">      </span><span class="c1">//   Step 3. remove node N like Case 1 or Case 3</span>
<a id="__codelineno-9-876" name="__codelineno-9-876"></a><a href="#__codelineno-9-876"><span class="linenos" data-linenos="876 "></span></a><span class="w">      </span><span class="c1">//   Step 4. update size for all nodes on the path</span>
<a id="__codelineno-9-877" name="__codelineno-9-877"></a><a href="#__codelineno-9-877"><span class="linenos" data-linenos="877 "></span></a><span class="w">      </span><span class="c1">//           from S to P</span>
<a id="__codelineno-9-878" name="__codelineno-9-878"></a><a href="#__codelineno-9-878"><span class="linenos" data-linenos="878 "></span></a><span class="w">      </span><span class="c1">//     |                  |</span>
<a id="__codelineno-9-879" name="__codelineno-9-879"></a><a href="#__codelineno-9-879"><span class="linenos" data-linenos="879 "></span></a><span class="w">      </span><span class="c1">//     N                  S                 |</span>
<a id="__codelineno-9-880" name="__codelineno-9-880"></a><a href="#__codelineno-9-880"><span class="linenos" data-linenos="880 "></span></a><span class="w">      </span><span class="c1">//    / \                / \                S</span>
<a id="__codelineno-9-881" name="__codelineno-9-881"></a><a href="#__codelineno-9-881"><span class="linenos" data-linenos="881 "></span></a><span class="w">      </span><span class="c1">//   L  ..  swap(N, S)  L  ..  remove(N)   / \</span>
<a id="__codelineno-9-882" name="__codelineno-9-882"></a><a href="#__codelineno-9-882"><span class="linenos" data-linenos="882 "></span></a><span class="c1">      //       |  =========&gt;      |  ========&gt;  L  ..</span>
<a id="__codelineno-9-883" name="__codelineno-9-883"></a><a href="#__codelineno-9-883"><span class="linenos" data-linenos="883 "></span></a><span class="w">      </span><span class="c1">//       P                  P                 |</span>
<a id="__codelineno-9-884" name="__codelineno-9-884"></a><a href="#__codelineno-9-884"><span class="linenos" data-linenos="884 "></span></a><span class="w">      </span><span class="c1">//      / \                / \                P</span>
<a id="__codelineno-9-885" name="__codelineno-9-885"></a><a href="#__codelineno-9-885"><span class="linenos" data-linenos="885 "></span></a><span class="w">      </span><span class="c1">//     S  ..              N  ..              / \</span>
<a id="__codelineno-9-886" name="__codelineno-9-886"></a><a href="#__codelineno-9-886"><span class="linenos" data-linenos="886 "></span></a><span class="c1">      //      \                  \                R  ..</span>
<a id="__codelineno-9-887" name="__codelineno-9-887"></a><a href="#__codelineno-9-887"><span class="linenos" data-linenos="887 "></span></a><span class="w">      </span><span class="c1">//       R                  R</span>
<a id="__codelineno-9-888" name="__codelineno-9-888"></a><a href="#__codelineno-9-888"><span class="linenos" data-linenos="888 "></span></a><span class="w">      </span><span class="c1">// clang-format on</span>
<a id="__codelineno-9-889" name="__codelineno-9-889"></a><a href="#__codelineno-9-889"><span class="linenos" data-linenos="889 "></span></a>
<a id="__codelineno-9-890" name="__codelineno-9-890"></a><a href="#__codelineno-9-890"><span class="linenos" data-linenos="890 "></span></a><span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="n">NodePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">path</span><span class="p">;</span>
<a id="__codelineno-9-891" name="__codelineno-9-891"></a><a href="#__codelineno-9-891"><span class="linenos" data-linenos="891 "></span></a>
<a id="__codelineno-9-892" name="__codelineno-9-892"></a><a href="#__codelineno-9-892"><span class="linenos" data-linenos="892 "></span></a><span class="w">      </span><span class="c1">// Step 1</span>
<a id="__codelineno-9-893" name="__codelineno-9-893"></a><a href="#__codelineno-9-893"><span class="linenos" data-linenos="893 "></span></a><span class="w">      </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-894" name="__codelineno-9-894"></a><a href="#__codelineno-9-894"><span class="linenos" data-linenos="894 "></span></a><span class="w">      </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
<a id="__codelineno-9-895" name="__codelineno-9-895"></a><a href="#__codelineno-9-895"><span class="linenos" data-linenos="895 "></span></a><span class="w">      </span><span class="n">path</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-896" name="__codelineno-9-896"></a><a href="#__codelineno-9-896"><span class="linenos" data-linenos="896 "></span></a>
<a id="__codelineno-9-897" name="__codelineno-9-897"></a><a href="#__codelineno-9-897"><span class="linenos" data-linenos="897 "></span></a><span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">successor</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-898" name="__codelineno-9-898"></a><a href="#__codelineno-9-898"><span class="linenos" data-linenos="898 "></span></a><span class="w">        </span><span class="n">path</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">successor</span><span class="p">);</span>
<a id="__codelineno-9-899" name="__codelineno-9-899"></a><a href="#__codelineno-9-899"><span class="linenos" data-linenos="899 "></span></a><span class="w">        </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-9-900" name="__codelineno-9-900"></a><a href="#__codelineno-9-900"><span class="linenos" data-linenos="900 "></span></a><span class="w">        </span><span class="n">successor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-901" name="__codelineno-9-901"></a><a href="#__codelineno-9-901"><span class="linenos" data-linenos="901 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-902" name="__codelineno-9-902"></a><a href="#__codelineno-9-902"><span class="linenos" data-linenos="902 "></span></a>
<a id="__codelineno-9-903" name="__codelineno-9-903"></a><a href="#__codelineno-9-903"><span class="linenos" data-linenos="903 "></span></a><span class="w">      </span><span class="c1">// Step 2</span>
<a id="__codelineno-9-904" name="__codelineno-9-904"></a><a href="#__codelineno-9-904"><span class="linenos" data-linenos="904 "></span></a><span class="w">      </span><span class="n">swapNode</span><span class="p">(</span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">successor</span><span class="p">);</span>
<a id="__codelineno-9-905" name="__codelineno-9-905"></a><a href="#__codelineno-9-905"><span class="linenos" data-linenos="905 "></span></a>
<a id="__codelineno-9-906" name="__codelineno-9-906"></a><a href="#__codelineno-9-906"><span class="linenos" data-linenos="906 "></span></a><span class="w">      </span><span class="c1">// Step 3</span>
<a id="__codelineno-9-907" name="__codelineno-9-907"></a><a href="#__codelineno-9-907"><span class="linenos" data-linenos="907 "></span></a><span class="w">      </span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-908" name="__codelineno-9-908"></a><a href="#__codelineno-9-908"><span class="linenos" data-linenos="908 "></span></a><span class="w">      </span><span class="c1">// Restore node</span>
<a id="__codelineno-9-909" name="__codelineno-9-909"></a><a href="#__codelineno-9-909"><span class="linenos" data-linenos="909 "></span></a><span class="w">      </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successor</span><span class="p">;</span>
<a id="__codelineno-9-910" name="__codelineno-9-910"></a><a href="#__codelineno-9-910"><span class="linenos" data-linenos="910 "></span></a>
<a id="__codelineno-9-911" name="__codelineno-9-911"></a><a href="#__codelineno-9-911"><span class="linenos" data-linenos="911 "></span></a><span class="w">      </span><span class="c1">// Step 4</span>
<a id="__codelineno-9-912" name="__codelineno-9-912"></a><a href="#__codelineno-9-912"><span class="linenos" data-linenos="912 "></span></a><span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">path</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-913" name="__codelineno-9-913"></a><a href="#__codelineno-9-913"><span class="linenos" data-linenos="913 "></span></a><span class="w">        </span><span class="n">path</span><span class="p">.</span><span class="n">top</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">updateSize</span><span class="p">();</span>
<a id="__codelineno-9-914" name="__codelineno-9-914"></a><a href="#__codelineno-9-914"><span class="linenos" data-linenos="914 "></span></a><span class="w">        </span><span class="n">path</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-915" name="__codelineno-9-915"></a><a href="#__codelineno-9-915"><span class="linenos" data-linenos="915 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-916" name="__codelineno-9-916"></a><a href="#__codelineno-9-916"><span class="linenos" data-linenos="916 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-917" name="__codelineno-9-917"></a><a href="#__codelineno-9-917"><span class="linenos" data-linenos="917 "></span></a>
<a id="__codelineno-9-918" name="__codelineno-9-918"></a><a href="#__codelineno-9-918"><span class="linenos" data-linenos="918 "></span></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<a id="__codelineno-9-919" name="__codelineno-9-919"></a><a href="#__codelineno-9-919"><span class="linenos" data-linenos="919 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-920" name="__codelineno-9-920"></a><a href="#__codelineno-9-920"><span class="linenos" data-linenos="920 "></span></a>
<a id="__codelineno-9-921" name="__codelineno-9-921"></a><a href="#__codelineno-9-921"><span class="linenos" data-linenos="921 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">countLess</span><span class="p">(</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">countEqual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-922" name="__codelineno-9-922"></a><a href="#__codelineno-9-922"><span class="linenos" data-linenos="922 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-923" name="__codelineno-9-923"></a><a href="#__codelineno-9-923"><span class="linenos" data-linenos="923 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-9-924" name="__codelineno-9-924"></a><a href="#__codelineno-9-924"><span class="linenos" data-linenos="924 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-925" name="__codelineno-9-925"></a><a href="#__codelineno-9-925"><span class="linenos" data-linenos="925 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">countLess</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-9-926" name="__codelineno-9-926"></a><a href="#__codelineno-9-926"><span class="linenos" data-linenos="926 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-927" name="__codelineno-9-927"></a><a href="#__codelineno-9-927"><span class="linenos" data-linenos="927 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">countLess</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-9-928" name="__codelineno-9-928"></a><a href="#__codelineno-9-928"><span class="linenos" data-linenos="928 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-929" name="__codelineno-9-929"></a><a href="#__codelineno-9-929"><span class="linenos" data-linenos="929 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">countEqual</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-9-930" name="__codelineno-9-930"></a><a href="#__codelineno-9-930"><span class="linenos" data-linenos="930 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-931" name="__codelineno-9-931"></a><a href="#__codelineno-9-931"><span class="linenos" data-linenos="931 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-932" name="__codelineno-9-932"></a><a href="#__codelineno-9-932"><span class="linenos" data-linenos="932 "></span></a>
<a id="__codelineno-9-933" name="__codelineno-9-933"></a><a href="#__codelineno-9-933"><span class="linenos" data-linenos="933 "></span></a><span class="w">  </span><span class="n">USize</span><span class="w"> </span><span class="n">countGreater</span><span class="p">(</span><span class="n">ConstNodePtr</span><span class="w"> </span><span class="n">node</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">countEqual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-934" name="__codelineno-9-934"></a><a href="#__codelineno-9-934"><span class="linenos" data-linenos="934 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-935" name="__codelineno-9-935"></a><a href="#__codelineno-9-935"><span class="linenos" data-linenos="935 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<a id="__codelineno-9-936" name="__codelineno-9-936"></a><a href="#__codelineno-9-936"><span class="linenos" data-linenos="936 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-937" name="__codelineno-9-937"></a><a href="#__codelineno-9-937"><span class="linenos" data-linenos="937 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">countGreater</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-9-938" name="__codelineno-9-938"></a><a href="#__codelineno-9-938"><span class="linenos" data-linenos="938 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-939" name="__codelineno-9-939"></a><a href="#__codelineno-9-939"><span class="linenos" data-linenos="939 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">countGreater</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">countEqual</span><span class="p">);</span>
<a id="__codelineno-9-940" name="__codelineno-9-940"></a><a href="#__codelineno-9-940"><span class="linenos" data-linenos="940 "></span></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-941" name="__codelineno-9-941"></a><a href="#__codelineno-9-941"><span class="linenos" data-linenos="941 "></span></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">countEqual</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<a id="__codelineno-9-942" name="__codelineno-9-942"></a><a href="#__codelineno-9-942"><span class="linenos" data-linenos="942 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-943" name="__codelineno-9-943"></a><a href="#__codelineno-9-943"><span class="linenos" data-linenos="943 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-944" name="__codelineno-9-944"></a><a href="#__codelineno-9-944"><span class="linenos" data-linenos="944 "></span></a>
<a id="__codelineno-9-945" name="__codelineno-9-945"></a><a href="#__codelineno-9-945"><span class="linenos" data-linenos="945 "></span></a><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="n">inorderTraversal</span><span class="p">(</span><span class="n">NodeConsumer</span><span class="w"> </span><span class="n">action</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-946" name="__codelineno-9-946"></a><a href="#__codelineno-9-946"><span class="linenos" data-linenos="946 "></span></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-947" name="__codelineno-9-947"></a><a href="#__codelineno-9-947"><span class="linenos" data-linenos="947 "></span></a><span class="w">      </span><span class="k">return</span><span class="p">;</span>
<a id="__codelineno-9-948" name="__codelineno-9-948"></a><a href="#__codelineno-9-948"><span class="linenos" data-linenos="948 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-949" name="__codelineno-9-949"></a><a href="#__codelineno-9-949"><span class="linenos" data-linenos="949 "></span></a>
<a id="__codelineno-9-950" name="__codelineno-9-950"></a><a href="#__codelineno-9-950"><span class="linenos" data-linenos="950 "></span></a><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stack</span><span class="o">&lt;</span><span class="n">NodePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stack</span><span class="p">;</span>
<a id="__codelineno-9-951" name="__codelineno-9-951"></a><a href="#__codelineno-9-951"><span class="linenos" data-linenos="951 "></span></a><span class="w">    </span><span class="n">NodePtr</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>
<a id="__codelineno-9-952" name="__codelineno-9-952"></a><a href="#__codelineno-9-952"><span class="linenos" data-linenos="952 "></span></a>
<a id="__codelineno-9-953" name="__codelineno-9-953"></a><a href="#__codelineno-9-953"><span class="linenos" data-linenos="953 "></span></a><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">stack</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-954" name="__codelineno-9-954"></a><a href="#__codelineno-9-954"><span class="linenos" data-linenos="954 "></span></a><span class="w">      </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-955" name="__codelineno-9-955"></a><a href="#__codelineno-9-955"><span class="linenos" data-linenos="955 "></span></a><span class="w">        </span><span class="n">stack</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-956" name="__codelineno-9-956"></a><a href="#__codelineno-9-956"><span class="linenos" data-linenos="956 "></span></a><span class="w">        </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
<a id="__codelineno-9-957" name="__codelineno-9-957"></a><a href="#__codelineno-9-957"><span class="linenos" data-linenos="957 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-958" name="__codelineno-9-958"></a><a href="#__codelineno-9-958"><span class="linenos" data-linenos="958 "></span></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">stack</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-9-959" name="__codelineno-9-959"></a><a href="#__codelineno-9-959"><span class="linenos" data-linenos="959 "></span></a><span class="w">        </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
<a id="__codelineno-9-960" name="__codelineno-9-960"></a><a href="#__codelineno-9-960"><span class="linenos" data-linenos="960 "></span></a><span class="w">        </span><span class="n">stack</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<a id="__codelineno-9-961" name="__codelineno-9-961"></a><a href="#__codelineno-9-961"><span class="linenos" data-linenos="961 "></span></a><span class="w">        </span><span class="n">action</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<a id="__codelineno-9-962" name="__codelineno-9-962"></a><a href="#__codelineno-9-962"><span class="linenos" data-linenos="962 "></span></a><span class="w">        </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
<a id="__codelineno-9-963" name="__codelineno-9-963"></a><a href="#__codelineno-9-963"><span class="linenos" data-linenos="963 "></span></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-9-964" name="__codelineno-9-964"></a><a href="#__codelineno-9-964"><span class="linenos" data-linenos="964 "></span></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-9-965" name="__codelineno-9-965"></a><a href="#__codelineno-9-965"><span class="linenos" data-linenos="965 "></span></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-9-966" name="__codelineno-9-966"></a><a href="#__codelineno-9-966"><span class="linenos" data-linenos="966 "></span></a><span class="p">};</span>
<a id="__codelineno-9-967" name="__codelineno-9-967"></a><a href="#__codelineno-9-967"><span class="linenos" data-linenos="967 "></span></a>
<a id="__codelineno-9-968" name="__codelineno-9-968"></a><a href="#__codelineno-9-968"><span class="linenos" data-linenos="968 "></span></a><span class="cp">#endif  </span><span class="c1">// SIZE_BALANCED_TREE_MAP_HPP</span>
</code></pre></div> </details> <hr> <div class="md-source-file"> <small> 最后更新: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2023年5月21日 07:58:56">2023年5月21日</span> <br> 创建日期: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="2018年7月11日 07:03:31">2018年7月11日</span> </small> </div> </article> </div> </div> <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> 回到页面顶部 </a> </main> <footer class="md-footer"> <nav class="md-footer__inner md-grid" aria-label="页脚"> <a href="../wblt/" class="md-footer__link md-footer__link--prev" aria-label="上一页: WBLT" rel="prev"> <div class="md-footer__button md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> 上一页 </span> WBLT </div> </div> </a> <a href="../avl/" class="md-footer__link md-footer__link--next" aria-label="下一页: AVL 树" rel="next"> <div class="md-footer__title"> <div class="md-ellipsis"> <span class="md-footer__direction"> 下一页 </span> AVL 树 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright © 2016 - 2022 OI Wiki Team </div> </div> <div class="md-social"> <a href="https://github.com/Dup4/oi-wiki-mirror" target="_blank" rel="noopener" title="github.com" class="md-social__link"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.tracking", "navigation.tabs", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.integrate", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script> <script src="../../assets/javascripts/bundle.3a4b43e5.min.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="../../assets/javascripts/mathjax.js"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>  </body></html>